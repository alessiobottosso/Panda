// Made with Panda 2 (Engine v2.9.0) - www.panda2.io
var game={audio:null,config:{},debug:null,device:{},input:null,isStarted:!1,json:{},keyboard:null,logo:null,mediaQueue:[],modules:{},paths:{},plugins:{},pool:null,renderer:null,scale:1,storage:null,system:null,version:"2.9.0",_booted:!1,_coreModules:["engine.audio","engine.camera","engine.debug","engine.geometry","engine.input","engine.loader","engine.particle","engine.physics","engine.pool","engine.renderer.core","engine.scene","engine.storage","engine.system","engine.timer","engine.tween"],_current:null,_currentModule:null,_DOMLoaded:!1,_fnTest:/xyz/.test(function(){})?/\bsuper\b/:/[\D|\d]*/,_gameLoopId:1,_gameLoops:{},_gameModuleDefined:!1,_initializing:!1,_loadFinished:!1,_logoSource:null,_moduleQueue:[],_nocache:"",_waitForLoad:0,addAsset:function(e,i){if(!e)throw"addAsset: filename undefined";if(!(i&&this.paths[i]||this.paths[e])){var t=this._getFilePath(e);return i&&(this.paths[i]=t),this.paths[e]=t,-1===this.mediaQueue.indexOf(t)&&this.mediaQueue.push(t),i}},addAttributes:function(e,i){if(!this[e])throw"Class "+e+" not found";for(var t in i)this[e][t]||(this[e][t]=i[t])},body:function(e){if(this._current.body=e,!this._booted&&0!==this._current.name.indexOf("engine."))return this._current=null,this._boot();this._current=null,this._loadFinished&&this._loadModules(),this._gameModuleDefined&&this._DOMLoaded&&!this._loadFinished&&this._loadModules()},copy:function(e){var i,t,s;if(!e||"object"!=typeof e||"undefined"!=typeof document&&e instanceof HTMLElement||e instanceof this.Class||this.Container&&e instanceof this.Container)return e;if(e instanceof Array){for(t=[],s=0,i=e.length;s<i;s++)t[s]=this.copy(e[s]);return t}for(s in t={},e)t[s]=this.copy(e[s]);return t},createClass:function(e,i,t){if(!e)throw"createClass: name undefined";if("object"==typeof e)return this.Class.extend(e);if(this[e])throw"Class "+e+" already created";if("object"==typeof i&&(t=i,i="Class"),!this[i])throw"createClass: Class "+i+" not found for "+e;return this[e]=this[i].extend(t),this[e]._name=e,this[e]._extend=i,this[e]._content=t,this._currentModule.classes.push({name:e,extend:i}),this[e]},createScene:function(e,i,t){return"object"==typeof i&&(t=i,i="Scene"),this.createClass(e,i,t)},defineProperties:function(e,i){if(!this[e])throw"Class "+e+" not found";for(var t in i)Object.defineProperty(this[e].prototype,t,{get:i[t].get,set:i[t].set})},getJSON:function(e){if(!e)throw"getJSON: id undefined";return this.json[this.paths[e]]},injectClass:function(e,i){if(!e)throw"injectClass: name undefined";if(!this[e])throw"Class "+e+" not found";return this[e].inject(i),this[e]},ksort:function(e,i){if(!e||"object"!=typeof e)return!1;var t,s=[],n={};for(t in e)s.push(t);for(s.sort(i),t=0;t<s.length;t++)n[s[t]]=e[s[t]];return n},merge:function(e,i){for(var t in i){var s=i[t];"object"!=typeof s||s instanceof HTMLElement||s instanceof this.Class||s instanceof this.Container?e[t]=s:(e[t]&&"object"==typeof e[t]||(e[t]=s instanceof Array?[]:{}),this.merge(e[t],s))}return e},module:function(e){if(this._current)throw"Module "+this._current.name+" has no body";if(this.modules[e]&&this.modules[e].body)throw"Module "+e+" is already defined";if(this._current={name:e,requires:[],loaded:!1,classes:[]},0===e.indexOf("game.")&&(this._gameModuleDefined=!0,this._current.requires.push("engine.core")),this.modules[e]=this._current,this._moduleQueue.push(this._current),"engine.core"===e){if(this.config.ignoreModules)for(var i=this._coreModules.length-1;i>=0;i--)-1!==this.config.ignoreModules.indexOf(this._coreModules[i])&&this._coreModules.splice(i,1);this._current.requires=this._coreModules,this.body(function(){})}return this},onReady:function(){},onStart:function(){this.system.loadScene(this.System.startScene)},removeAllAssets:function(){this.Audio&&this.Audio.clearCache(),this.BaseTexture.clearCache(),this.Texture.clearCache(),this.TilingSprite.clearCache(),this.Font.clearCache(),this.json={},this.paths={}},removeAsset:function(e){if(this.paths[e]){var i=this.paths[e];if(-1!==i.indexOf(".atlas")&&this.json[i]){var t=this.json[i];for(var s in t.frames)delete game.Texture.cache[s];delete game.BaseTexture.cache[game._getFilePath(t.meta.image)]}game.Audio&&game.Audio.cache[i]&&delete game.Audio.cache[i],game.BaseTexture.cache[i]&&delete game.BaseTexture.cache[i],game.Texture.cache[i]&&delete game.Texture.cache[i],game.TilingSprite.cache[i]&&(game.TilingSprite.cache[i].baseTexture.remove(),game.TilingSprite.cache[i].remove(),delete game.TilingSprite.cache[i]),this.json[i]&&delete this.json[i],delete this.paths[e]}},require:function(e){e=Array.prototype.slice.call(arguments);for(var i=0;i<e.length;i++){var t=e[i];this.config.ignoreModules&&-1!==this.config.ignoreModules.indexOf(t)||t&&-1===this._current.requires.indexOf(t)&&this._current.requires.push(t)}return this},screenshot:function(e,i,t,s,n){if(this.renderer){i="number"==typeof i?i:0,t="number"==typeof t?t:0,s=s||game.width,n=n||game.height;var o=document.createElement("img");o.crossOrigin=game.BaseTexture.crossOrigin,o.onload=function(){var r=document.createElement("canvas"),a=r.getContext("2d");r.width=s,r.height=n,a.drawImage(o,i,t,s,n,0,0,s,n),e(r.toDataURL())},o.src=this.renderer.canvas.toDataURL()}},start:function(){if(!(this._moduleQueue.length>0||this.isStarted)){for(var e in this.system=new this.System,this.renderer&&(this.input=new this.Input(this.renderer.canvas)),this.renderer&&this.Keyboard&&(this.keyboard=new this.Keyboard),this.renderer&&this.Audio&&(this.audio=new this.Audio),this.Pool&&(this.pool=new this.Pool),this.config.id&&!this.Storage.id&&(this.Storage.id=this.config.id),this.Storage&&this.Storage.id&&(this.storage=new this.Storage),this.plugins)this.plugins[e]=new this.plugins[e];if(this.Debug&&this.Debug.enabled&&(this.debug=new this.Debug),"undefined"!=typeof document){var i=document.createElement("canvas");i.width=i.height=120*game.scale;var t=i.getContext("2d");t.drawImage(this._logoSource,0,0,i.width,i.height/2),t.rotate(Math.PI),t.translate(-i.width,-i.height),t.drawImage(this._logoSource,0,0,i.width,i.height/2),this.logo=new game.Texture(new game.BaseTexture(i))}this.isStarted=!0,this.system._rotateScreenVisible||this.onStart()}},_boot:function(){if(this._booted=!0,this._loadNativeExtensions(),this._loadDeviceInformation(),"object"==typeof window&&(this._normalizeVendorAttribute(window,"requestAnimationFrame"),this._normalizeVendorAttribute(navigator,"vibrate")),("object"==typeof document&&document.location.href.match(/\?nocache/)||this.config.disableCache)&&(this._nocache="?"+Date.now()),void 0===this.config.sourceFolder&&(this.config.sourceFolder="src"),void 0===this.config.mediaFolder&&(this.config.mediaFolder="media"),this.device.mobile){var e=!1,t=document.getElementsByTagName("meta");for(i=0;i<t.length;i++)if("viewport"===t[i].name){e=!0;break}if(!e){var s=document.createElement("meta");s.name="viewport";var n="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no";this.device.iOS71&&(n+=",minimal-ui"),s.content=n,document.getElementsByTagName("head")[0].appendChild(s)}}this.module("engine.core"),"undefined"==typeof document||"complete"===document.readyState?this._DOMReady():(document.addEventListener("DOMContentLoaded",this._DOMReady.bind(this)),window.addEventListener("load",this._DOMReady.bind(this)))},_clearGameLoop:function(e){this._gameLoops[e]?delete this._gameLoops[e]:clearInterval(e)},_DOMReady:function(){if(!this._DOMLoaded){if("object"==typeof document&&!document.body)return setTimeout(this._DOMReady.bind(this),13);this._DOMLoaded=!0,this._gameModuleDefined&&this._loadModules()}},_getFilePath:function(e){return-1!==e.indexOf("://")||-1!==e.indexOf("data:")?e:(this.config.mediaFolder&&(e=this.config.mediaFolder+"/"+e),e)},_getId:function(e){for(var i in this.paths)if(this.paths[i]===e)return i},_getVendorAttribute:function(e,i){var t=i.ucfirst();return e[i]||e["ms"+t]||e["moz"+t]||e["webkit"+t]||e["o"+t]},_loadDeviceInformation:function(){if("undefined"!=typeof window){this.device.pixelRatio=window.devicePixelRatio||1,this.device.screen={width:window.screen.availWidth*this.device.pixelRatio,height:window.screen.availHeight*this.device.pixelRatio},this.device.iPod=/iPod/i.test(navigator.userAgent),this.device.iPhone=/iPhone/i.test(navigator.userAgent),this.device.iPhone4=this.device.iPhone&&2===this.device.pixelRatio&&960===this.device.screen.height,this.device.iPhone5=this.device.iPhone&&2===this.device.pixelRatio&&1136===this.device.screen.height,this.device.iPhone6=this.device.iPhone&&2===this.device.pixelRatio&&1334===this.device.screen.height,this.device.iPhone7=this.device.iPhone&&2===this.device.pixelRatio&&1334===this.device.screen.height,this.device.iPhone8=this.device.iPhone&&2===this.device.pixelRatio&&1334===this.device.screen.height,this.device.iPhoneX=this.device.iPhone&&3===this.device.pixelRatio&&2436===this.device.screen.height,this.device.iPhone6Plus=this.device.iPhone&&3===this.device.pixelRatio&&2208===this.device.screen.height,this.device.iPhone7Plus=this.device.iPhone&&3===this.device.pixelRatio&&2208===this.device.screen.height,this.device.iPhone8Plus=this.device.iPhone&&3===this.device.pixelRatio&&2208===this.device.screen.height,this.device.iPad=/iPad/i.test(navigator.userAgent),this.device.iPadRetina=this.device.iPad&&2===this.device.pixelRatio,this.device.iOS=this.device.iPod||this.device.iPhone||this.device.iPad,this.device.iOS5=this.device.iOS&&/OS 5/i.test(navigator.userAgent),this.device.iOS6=this.device.iOS&&/OS 6/i.test(navigator.userAgent),this.device.iOS7=this.device.iOS&&/OS 7/i.test(navigator.userAgent),this.device.iOS71=this.device.iOS&&/OS 7_1/i.test(navigator.userAgent),this.device.iOS8=this.device.iOS&&/OS 8/i.test(navigator.userAgent),this.device.iOS9=this.device.iOS&&/OS 9/i.test(navigator.userAgent),this.device.iOS10=this.device.iOS&&/OS 10/i.test(navigator.userAgent),this.device.iOS11=this.device.iOS&&/OS 11/i.test(navigator.userAgent),this.device.WKWebView=this.device.iOS&&window.webkit&&window.webkit.messageHandlers,this.device.android=/android/i.test(navigator.userAgent),this.device.android2=/android 2/i.test(navigator.userAgent);var e=navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);if(this.device.androidStock=!!(e&&e[1]<537),this.device.androidTV=/Android TV/i.test(navigator.userAgent),this.device.android5=/Android 5/i.test(navigator.userAgent),this.device.android6=/Android 6/i.test(navigator.userAgent),this.device.android7=/Android 7/i.test(navigator.userAgent),this.device.android8=/Android 8/i.test(navigator.userAgent),this.device.ie9=/MSIE 9/i.test(navigator.userAgent),this.device.ie10=/MSIE 10/i.test(navigator.userAgent),this.device.ie11=/rv:11.0/i.test(navigator.userAgent),this.device.ie=this.device.ie10||this.device.ie11||this.device.ie9,this.device.edge=/Edge/i.test(navigator.userAgent),this.device.wp7=/Windows Phone OS 7/i.test(navigator.userAgent),this.device.wp8=/Windows Phone 8/i.test(navigator.userAgent),this.device.wp=this.device.wp7||this.device.wp8,this.device.wt=this.device.ie&&/Tablet/i.test(navigator.userAgent),this.device.wiiu=/Nintendo WiiU/i.test(navigator.userAgent),this.device.xbox=/Xbox/i.test(navigator.userAgent),this.device.xboxOne=/Xbox One/i.test(navigator.userAgent),this.device.safari=/Safari/i.test(navigator.userAgent),this.device.opera=/Opera/i.test(navigator.userAgent)||/OPR/i.test(navigator.userAgent),this.device.crosswalk=/Crosswalk/i.test(navigator.userAgent),this.device.cocoonJS=!!navigator.isCocoonJS,this.device.cocoonCanvasPlus=/CocoonJS/i.test(navigator.browser),this.device.ejecta=/Ejecta/i.test(navigator.userAgent),this.device.facebook=/FB/i.test(navigator.userAgent),this.device.mobile=this.device.iOS||this.device.android||this.device.wp||this.device.wt,this.device.androidTV&&(this.device.mobile=!1),void 0===navigator.plugins||0===navigator.plugins.length)if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),this.device.flash=!0}catch(e){this.device.flash=!1}else this.device.flash=!1;else this.device.flash=!!navigator.plugins["Shockwave Flash"]}else this.device.headless=!0},_loadModules:function(){var e,i,t,s,n,o;for(i=0;i<this._moduleQueue.length;i++){for(s=this._moduleQueue[i],o=!0,t=0;t<s.requires.length;t++)n=s.requires[t],this.modules[n]?this.modules[n].loaded||(o=!1):(o=!1,this._loadScript(n,s.name));o&&s.body&&(this._moduleQueue.splice(i,1),s.loaded=!0,this._currentModule=s,s.body(),e=!0,i--,0===this._moduleQueue.length&&this._ready())}if(e&&this._moduleQueue.length>0)this._loadModules();else{if(0===this._waitForLoad&&0!==this._moduleQueue.length){var r=[];for(i=0;i<this._moduleQueue.length;i++){var a=[],h=this._moduleQueue[i].requires;for(t=0;t<h.length;t++)(s=this.modules[h[t]])&&s.loaded||a.push(h[t]);r.push(this._moduleQueue[i].name+" (requires: "+a.join(", ")+")")}throw"Unresolved modules:\n"+r.join("\n")}this._loadFinished=!0}},_loadNativeExtensions:function(){if(Math.distance=function(e,i,t,s){return e=t-e,i=s-i,Math.sqrt(e*e+i*i)},Math._random=Math.random,Math.random=function(e,i){return"number"==typeof i?Math._random()*(i-e)+e:Math._random(e)},Number.prototype.limit=function(e,i){var t=this;return t<e&&(t=e),t>i&&(t=i),t},Number.prototype.round=function(e){return e=e?Math.pow(10,e):1,Math.round(this*e)/e},Number.prototype.random=function(){return Math.random()*this},Array.prototype.erase=function(e){for(var i=this.length;i>=0;i--)if(this[i]===e)return this.splice(i,1),this;return this},Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]},Array.prototype.shuffle=function(){for(var e=this.length,i=e;i--;){var t=parseInt(Math.random()*e),s=this[i];this[i]=this[t],this[t]=s}return this},Array.prototype.last=function(){return this[this.length-1]},Function.prototype.bind=function(e){var i=this,t=[];return Array.prototype.push.apply(t,arguments),t.shift(),function(){var s=[];return Array.prototype.push.apply(s,t),Array.prototype.push.apply(s,arguments),i.apply(e,s)}},String.prototype.ucfirst=function(){return this.charAt(0).toUpperCase()+this.slice(1)},"object"==typeof Intl){var e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});this.compare=e.compare}},_loadScript:function(e,i){this.modules[e]=!0,this._waitForLoad++;var t=e.replace(/\./g,"/")+".js"+this._nocache;if(this.config.sourceFolder&&(t=this.config.sourceFolder+"/"+t),"undefined"==typeof document)return require("../../"+t),void this._scriptLoaded();var s=document.createElement("script");s.type="text/javascript",s.src=t,s.onload=this._scriptLoaded.bind(this),s.onerror=function(){throw"Error loading module "+e+" at "+t+" required from "+i},document.getElementsByTagName("head")[0].appendChild(s)},_normalizeVendorAttribute:function(e,i){if(!e[i]){var t=this._getVendorAttribute(e,i);e[i]=e[i]||t}},_ready:function(){for(var e in this.device)if(this.device[e]&&this.config[e])for(var i in this.config[e])"object"==typeof this.config[e][i]?(this.config[i]=this.config[i]||{},this.merge(this.config[i],this.config[e][i])):this.config[i]=this.config[e][i];for(var t in this.config){var s=t.ucfirst();if(this[s])for(var i in this.config[t])this[s][i]=this.config[t][i]}"undefined"!=typeof document&&(this._logoSource=document.createElement("img"),this._logoSource.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAA8BAMAAABfg2ObAAAALVBMVEUAAAD4uABHR0f4uABHR0f4uAD4uABHR0dHR0dHR0f4uABHR0f4uABHR0f4uADOcJEWAAAADXRSTlMAqqpV6UQkUMmUdBvjKrIhowAAAH1JREFUSMdjKLmLB7gz4Ae++DRfIaD5Ll4wqnlU8xDQzCqIDKRI05z3DgUsIEmzHapmgVHNo5qpovkGInkS1uykhApmo2cMGTyaFRgIAMZRzaOaRzUPJs2sEM0BZGlmSDYGAjMG0jUjwKjmUc2jmontlE0gUXMJckNgA2l6ASc7KJOPBNRIAAAAAElFTkSuQmCC",this._logoSource.onload=this._readyLogo.bind(this))},_readyLogo:function(){this.onReady()||!1!==this.config.autoStart&&this.start()},_scriptLoaded:function(){this._waitForLoad--,this._loadModules()},_setGameLoop:function(e){if(this.System.frameRate)return setInterval(e,1e3/this.System.frameRate);if("function"==typeof requestAnimationFrame){var i=this._gameLoopId++;this._gameLoops[i]=!0;var t=function(){game._gameLoops[i]&&(window.requestAnimationFrame(t),e())};return window.requestAnimationFrame(t),i}return setInterval(e,1e3/60)},_setVendorAttribute:function(e,i,t){var s=i.ucfirst();e[i]=e["ms"+s]=e["moz"+s]=e["webkit"+s]=e["o"+s]=t},Class:function(){}};game.Class.extend=function(e){var i=this.prototype;game._initializing=!0;var t=new this;game._initializing=!1;var s=function(e,t){return function(){var s=this.super;this.super=i[e];var n=t.apply(this,arguments);return this.super=s,n}};for(var n in e)"function"==typeof e[n]&&"function"==typeof i[n]&&game._fnTest.test(e[n])?t[n]=s(n,e[n]):t[n]=e[n];function o(){if(game._initializing)return this;for(var e in this)"object"==typeof this[e]&&(this[e]=game.copy(this[e]));var i=!1;this.staticInit&&(i=this.staticInit.apply(this,arguments));var t=!1;return this.init&&!i&&(t=this.init.apply(this,arguments)),!t&&game.scene&&"function"==typeof this.update&&this!==game.scene&&game.scene.addObject(this),this}return o.prototype=t,o.prototype.constructor=o,o.extend=game.Class.extend,o.inject=function(e){var i=this.prototype,t={},s=function(e,i){return function(){var s=this.super;this.super=t[e];var n=i.apply(this,arguments);return this.super=s,n}};for(var n in e)"function"==typeof e[n]&&"function"==typeof i[n]&&game._fnTest.test(e[n])?(t[n]=i[n],i[n]=s(n,e[n])):i[n]=e[n]},o},"undefined"!=typeof exports&&(exports=module.exports=game);game.module("engine.tween").body(function(){var t;game.createClass("Tween",{chainedTweens:[],currentTime:0,delayRepeat:!1,delayTime:0,duration:1e3,easingFunction:null,interpolationFunction:null,object:null,onCompleteCallback:null,onRepeatCallback:null,onStartCallback:null,onUpdateCallback:null,paused:!1,playing:!1,repeatCount:0,reversed:!1,yoyoEnabled:!1,_onStartCallbackFired:!1,_originalStartTime:null,_repeats:0,_shouldRemove:!1,_startTime:null,_valuesEnd:null,_valuesStart:{},_valuesStartRepeat:{},staticInit:function(t){if("object"!=typeof t)throw"Tween parameter must be object";for(var e in this.object=t,this.easingFunction=game.Tween.Easing.Linear.None,this.interpolationFunction=game.Tween.Interpolation.Linear,t)"number"==typeof t[e]&&(this._valuesStart[e]=parseFloat(t[e],10))},chain:function(){return this.chainedTweens=arguments,this},delay:function(t,e){return this.delayTime=t,this.delayRepeat=!!e,this},easing:function(t){return"string"==typeof t?(t=t.split("."),this.easingFunction=game.Tween.Easing[t[0]][t[1]]):this.easingFunction=t,this},interpolation:function(t){return this.interpolationFunction=t,this},onComplete:function(t){return this.onCompleteCallback=t,this},onRepeat:function(t){return this.onRepeatCallback=t,this},onStart:function(t){return this.onStartCallback=t,this},onUpdate:function(t){return this.onUpdateCallback=t,this},pause:function(){this.paused=!0},repeat:function(t){return void 0===t&&(t=1/0),this.repeatCount=t,this},resume:function(){this.paused=!1},start:function(){for(var t in game.scene&&game.scene.tweens.push(this),this.currentTime=0,this.playing=!0,this._onStartCallbackFired=!1,this._startTime=this.delayTime,this._originalStartTime=this._startTime,this._valuesEnd){if(this._valuesEnd[t]instanceof Array){if(0===this._valuesEnd[t].length)continue;this._valuesEnd[t]=[this.object[t]].concat(this._valuesEnd[t])}this._valuesStart[t]=this.object[t],this._valuesStart[t]instanceof Array==!1&&(this._valuesStart[t]*=1),this._valuesStartRepeat[t]=this._valuesStart[t]||0}return this},stop:function(){return this.playing?(this.playing=!1,this._shouldRemove=!0,this._stopChainedTweens(),this):this},to:function(t,e){return this.duration=e||this.duration,this._valuesEnd=t,this},yoyo:function(t){return void 0===t&&(t=!0),this.yoyoEnabled=t,this},_stopChainedTweens:function(){for(var t=0,e=this.chainedTweens.length;t<e;t++)this.chainedTweens[t].stop()},_update:function(){if(this._shouldRemove)return!1;if(this.paused)return!0;if(this.currentTime+=1e3*game.delta,this.currentTime<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this.onStartCallback&&this.onStartCallback.call(this.object),this._onStartCallbackFired=!0);var t=(this.currentTime-this._startTime)/this.duration;t=t>1?1:t;var e,n=this.easingFunction(t);for(e in this._valuesEnd){var i=this._valuesStart[e]||0,a=this._valuesEnd[e];a instanceof Array?this.object[e]=this.interpolationFunction(a,n):("string"==typeof a&&(a=i+parseFloat(a,10)),"number"==typeof a&&(this.object[e]=i+(a-i)*n))}if(null!==this.onUpdateCallback&&this.onUpdateCallback.call(this.object,n),1===t){if(this.repeatCount>0){for(e in isFinite(this.repeatCount)&&this.repeatCount--,this._repeats+=1,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e],10)),this.yoyoEnabled){var r=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=r,this.reversed=!this.reversed}this._valuesStart[e]=this._valuesStartRepeat[e]}return this.delayRepeat||(this.delayTime=0),this._startTime=this._originalStartTime+this._repeats*(this.duration+this.delayTime),null!==this.onRepeatCallback&&this.onRepeatCallback.call(this.object),!0}this.playing=!1,"function"==typeof this.onCompleteCallback&&this.onCompleteCallback.call(this.object);for(var s=0,o=this.chainedTweens.length;s<o;s++)this.chainedTweens[s].start();return!1}return!0}}),game.addAttributes("Tween",{add:function(t,e,n,i){var a=new game.Tween(t);for(var r in a.to(e,n),i){if(!a[r])throw"Invalid Tween setting: "+r;a[r](i[r])}return a},Easing:{Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){var e,n=.1;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=.1):e=.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4))},Out:function(t){var e,n=.1;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=.1):e=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/.4)+1)},InOut:function(t){var e,n=.1;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=.1):e=.4*Math.asin(1/n)/(2*Math.PI),(t*=2)<1?n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/.4)*.5+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-game.Tween.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*game.Tween.Easing.Bounce.In(2*t):.5*game.Tween.Easing.Bounce.Out(2*t-1)+.5}}},Interpolation:{Linear:function(t,e){var n=t.length-1,i=n*e,a=Math.floor(i),r=game.Tween.Interpolation.Utils.Linear;return e<0?r(t[0],t[1],i):e>1?r(t[n],t[n-1],n-i):r(t[a],t[a+1>n?n:a+1],i-a)},Bezier:function(t,e){var n,i=0,a=t.length-1,r=Math.pow,s=game.Tween.Interpolation.Utils.Bernstein;for(n=0;n<=a;n++)i+=r(1-e,a-n)*r(e,n)*t[n]*s(a,n);return i},CatmullRom:function(t,e){var n=t.length-1,i=n*e,a=Math.floor(i),r=game.Tween.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(a=Math.floor(i=n*(1+e))),r(t[(a-1+n)%n],t[a],t[(a+1)%n],t[(a+2)%n],i-a)):e<0?t[0]-(r(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(r(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):r(t[a?a-1:0],t[a],t[n<a+1?n:a+1],t[n<a+2?n:a+2],i-a)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=game.Tween.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:(t=[1],function(e){var n,i=1;if(t[e])return t[e];for(n=e;n>1;n--)i*=n;return t[e]=i}),CatmullRom:function(t,e,n,i,a){var r=.5*(n-t),s=.5*(i-e),o=a*a;return(2*e-2*n+r+s)*(a*o)+(-3*e+3*n-2*r-s)*o+r*a+e}}},getTweensForObject:function(t){var e=[];if(!game.scene)return e;for(var n=game.scene.tweens.length-1;n>=0;n--){var i=game.scene.tweens[n];i.object===t&&e.push(i)}return e},stopTweensForObject:function(t){if(game.scene)for(var e=game.scene.tweens.length-1;e>=0;e--){var n=game.scene.tweens[e];n.object===t&&n.stop()}}}),game.createClass("TweenGroup",{onComplete:null,tweens:[],_complete:!1,staticInit:function(t){this.onComplete=t},add:function(t){return t.onComplete(this._tweenComplete.bind(this)),this.tweens.push(t),t},pause:function(){for(var t=0;t<this.tweens.length;t++)this.tweens[t].pause()},remove:function(t){this.tweens.erase(t)},resume:function(){for(var t=0;t<this.tweens.length;t++)this.tweens[t].resume()},start:function(){for(var t=0;t<this.tweens.length;t++)this.tweens[t].start()},stop:function(t,e){if(!this._complete){for(var n=0;n<this.tweens.length;n++)this.tweens[n].stop(e);!this._complete&&t&&this._tweenComplete(),this._complete=!0}},_tweenComplete:function(){if(!this._complete){for(var t=0;t<this.tweens.length;t++)if(this.tweens[t].playing)return;this._complete=!0,"function"==typeof this.onComplete&&this.onComplete()}}})});game.module("engine.timer").body(function(){game.createClass("Timer",{callback:null,repeat:!1,target:0,_base:0,_last:0,_pause:0,init:function(e){this._last=game.Timer.time,this.set(e)},clear:function(){this.callback=null,this.repeat=!1,this.set(0)},delta:function(){var e=game.Timer.time-this._last;return this._last=game.Timer.time,this._pause?0:e},pause:function(){this._pause||(this._pause=game.Timer.time)},reset:function(){this._base=game.Timer.time,this._pause=0},resume:function(){this._pause&&(this._base+=game.Timer.time-this._pause,this._pause=0)},set:function(e){"number"!=typeof e&&(e=0),this.target=e,this.reset()},time:function(){var e=this._base+this.target-(this._pause||game.Timer.time);return e<0?0:e}}),game.addAttributes("Timer",{delta:0,minFPS:20,speed:1,time:0,_last:0,_lastFrameTime:0,_realDelta:0,add:function(e,t,i,a){var s=new game.Timer(e);return s.repeat=!!i,s.callback=t,game.scene.timers.push(s),a&&t(),s},update:function(){var e=Date.now();this._last||(this._last=e),this._realDelta=e-this._last,this.delta=Math.min(this._realDelta,1e3/this.minFPS)*this.speed,this._lastFrameTime=this.time,this.time+=this.delta,this._last=e}})});game.module("engine.system").body(function(){game.createClass("System",{canvasHeight:0,canvasWidth:0,delta:0,height:0,hires:!1,originalHeight:0,originalWidth:0,paused:!1,scene:null,sceneName:null,width:0,_newSceneName:null,_pausedOnHide:!1,_rotateScreenVisible:!1,_runLoopId:0,_running:!1,_windowWidth:0,_windowHeight:0,init:function(){this._updateWindowSize(),game.width=this.width=this.originalWidth=game.System.width,game.height=this.height=this.originalHeight=game.System.height,game.delta=this.delta;var e,i=this.originalWidth,t=this.originalHeight;game.System.hidpi&&(i/=game.device.pixelRatio,t/=game.device.pixelRatio);for(var s=2;s<=game.System.hires;s+=2){var n=game.System.hiresRatio*(s/2),a=game.System.hiresDeviceSize?game.device.screen.width:this._windowWidth,h=game.System.hiresDeviceSize?game.device.screen.height:this._windowHeight;a>=i*n&&h>=t*n&&(this.hires=!0,game.scale=s)}(this.canvasWidth=this.originalWidth*game.scale,this.canvasHeight=this.originalHeight*game.scale,"undefined"!=typeof document)&&(void 0!==document.hidden?e="visibilitychange":void 0!==document.mozHidden?e="mozvisibilitychange":void 0!==document.msHidden?e="msvisibilitychange":void 0!==document.webkitHidden&&(e="webkitvisibilitychange"),document.addEventListener(e,function(){game.System.pauseOnHide&&(!!game._getVendorAttribute(document,"hidden")?game.system.pause(!0):game.system.resume(!0))}),game.System.resize&&(game.System.center=!1),this._initRenderer(),game.System.hidpi&&(this.canvasWidth/=game.device.pixelRatio,this.canvasHeight/=game.device.pixelRatio),game.device.WKWebView?window.addEventListener("orientationchange",this._onWindowResize.bind(this)):window.addEventListener("resize",this._onWindowResize.bind(this)),this._onWindowResize())},fullscreen:function(){game.renderer.canvas.requestFullscreen?game.renderer.canvas.requestFullscreen():game.renderer.canvas.requestFullScreen&&game.renderer.canvas.requestFullScreen()},fullscreenSupport:function(){return!(!game.renderer.canvas.requestFullscreen&&!game.renderer.canvas.requestFullScreen)},loadScene:function(e){game.mediaQueue.length?this.setScene(game.System.loader,e):this.setScene(e)},resize:function(e,i){this.width===e&&this.height===i||(game.width=this.width=e/game.scale,game.height=this.height=i/game.scale,game.renderer._resize(e,i),this.scene&&this.scene.onResize&&this.scene.onResize())},pause:function(e){this.paused||(e?this._pausedOnHide=!0:this.paused=!0,this.scene&&this.scene._pause&&this.scene._pause())},resume:function(e){e&&this.paused||(e||this.paused)&&(e?this._pausedOnHide=!1:this.paused=!1,game.Timer.last=Date.now(),this.scene&&this.scene._resume&&this.scene._resume())},setScene:function(e,i){if(!e&&this.scene&&(e=this.scene.constructor._name),!game[e])throw"Scene "+e+" not found";this._running&&!this.paused?(this._newSceneName=e,this._newSceneParam=i):this._setSceneNow(e,i)},_hideRotateScreen:function(){this._rotateScreenVisible&&(this._rotateScreenVisible=!1,game.renderer._show(),document.body.className="")},_initRenderer:function(){game.renderer=new game.Renderer(this.canvasWidth,this.canvasHeight)},_onWindowResize:function(){if(this._updateWindowSize(),!this._toggleRotateScreen()){var e=game.System.scalePercent/100;this._scale(this._windowWidth*e,this._windowHeight*e),this._resize(this._windowWidth,this._windowHeight),game.System.center&&game.renderer._position((this._windowWidth-this.canvasWidth)/2,(this._windowHeight-this.canvasHeight)/2),(game.System.scale||game.System.resize||game.System.hidpi&&game.device.pixelRatio>1)&&game.renderer._size(this.canvasWidth,this.canvasHeight),game.isStarted&&!game.scene&&game.onStart()}},_resize:function(e,i){if(game.System.resize){if(!game.System.scale)return this.resize(e,i),this.canvasWidth=e,void(this.canvasHeight=i);var t=e-this.canvasWidth,s=i-this.canvasHeight;if(t>0){var n=t/this.canvasWidth,a=~~(this.originalWidth*game.scale+this.originalWidth*n*game.scale);this.resize(a,this.originalHeight*game.scale),this.canvasWidth+=t}else if(s>0){n=s/this.canvasHeight;var h=~~(this.originalHeight*game.scale+this.originalHeight*n*game.scale);this.resize(this.originalWidth*game.scale,h),this.canvasHeight+=s}}},_run:function(){this.paused||this._pausedOnHide||(game.Timer.update(),game.delta=this.delta=game.Timer.delta/1e3,game.input&&game.input._update(),this.scene._update(),this._newSceneName&&this._setSceneNow(this._newSceneName,this._newSceneParam))},_scale:function(e,i){if(game.System.scale&&(e/this.originalWidth<i/this.originalHeight?(this.canvasWidth=e,this.canvasHeight=~~(e*(this.originalHeight/this.originalWidth))):(this.canvasWidth=~~(i*(this.originalWidth/this.originalHeight)),this.canvasHeight=i),game.System.scaleMax>0)){var t=this.originalWidth*(game.System.scaleMax/100),s=this.originalHeight*(game.System.scaleMax/100);this.canvasWidth>t&&(this.canvasWidth=t),this.canvasHeight>s&&(this.canvasHeight=s)}},_setSceneNow:function(e,i){this.sceneName=e,this._newSceneName=null,this.scene&&this.scene._exit(e)||(this.paused&&(this.paused=!1),game.TilingSprite.clearCache(),game.Sprite._clearTintedTextures(),this.scene=new game[e](i),this._startRunLoop())},_showRotateScreen:function(){this._rotateScreenVisible||(this._rotateScreenVisible=!0,game.renderer._hide(),document.body.className=game.System.rotateScreenClass)},_startRunLoop:function(){this.scene&&(this._runLoopId&&this._stopRunLoop(),this._runLoopId=game._setGameLoop(this._run.bind(this)),this._running=!0)},_stopRunLoop:function(){game._clearGameLoop(this._runLoopId),this._running=!1},_toggleRotateScreen:function(){return!(!game.device.mobile||!game.System.rotateScreen)&&(this.originalWidth>this.originalHeight&&this._windowWidth<this._windowHeight||this.originalHeight>this.originalWidth&&this._windowHeight<this._windowWidth?(this._showRotateScreen(),!0):(this._hideRotateScreen(),!1))},_updateWindowSize:function(){"undefined"!=typeof document&&(this._windowWidth=game.device.WKWebView?document.documentElement.clientWidth:window.innerWidth,this._windowHeight=game.device.WKWebView?document.documentElement.clientHeight:window.innerHeight,game.device.crosswalk&&0===this._windowWidth&&(this._windowWidth=window.screen.width,this._windowHeight=window.screen.height),90===Math.abs(window.orientation)&&game.device.iPhone&&game.device.safari&&this._windowHeight++)}}),game.addAttributes("System",{canvasId:"canvas",center:!0,frameRate:null,height:768,hidpi:!0,hires:0,hiresDeviceSize:!1,hiresRatio:2,loader:"Loader",pauseOnHide:!0,resize:!1,rotateScreen:!0,rotateScreenClass:"rotate",scale:!0,scaleMax:0,scalePercent:100,startScene:"Main",width:1024})});game.module("engine.storage").body(function(){game.createClass("Storage",{id:"",supported:!1,init:function(t){this.id=t||game.Storage.id,this.supported=this._isSupported()},clear:function(){for(var t=localStorage.length-1;t>=0;t--){var e=localStorage.key(t);-1!==e.indexOf(this.id+".")&&localStorage.removeItem(e)}},get:function(t,e){var o=localStorage.getItem(this.id+"."+t);if(null===o)return e;try{return this._decode(o)}catch(t){return o}},has:function(t){return null!==localStorage.getItem(this.id+"."+t)},remove:function(t){localStorage.removeItem(this.id+"."+t)},set:function(t,e){return this.supported&&localStorage.setItem(this.id+"."+t,this._encode(e)),e},_decode:function(t){return JSON.parse(t)},_encode:function(t){return JSON.stringify(t)},_isSupported:function(){if("object"!=typeof localStorage)return!1;try{localStorage.setItem("localStorage",1),localStorage.removeItem("localStorage")}catch(t){return!1}return!0}}),game.addAttributes("Storage",{id:""})});game.module("engine.renderer.tilingsprite").require("engine.renderer.sprite").body(function(){game.createClass("TilingSprite","Container",{texture:null,tilePosition:null,_pos:[],_rect:[],_sprite:null,_updateSprites:!1,staticInit:function(t,e,i){this.super(),this.tilePosition=new game.Vector,this._pos=new game.Vector,this._rect=new game.Vector,this.texture=this.texture||t,this.texture=this.texture instanceof game.Texture?this.texture:game.Texture.fromAsset(this.texture),this._width=this._width||e||this.texture.width,this._height=this._height||i||this.texture.height,this._generateSprites()},updateTransform:function(){this.super(),this._updateSprites&&this._generateSprites()},_generateSprites:function(){if(this.texture.baseTexture.loaded){this._sprite&&(delete game.TilingSprite.cache[this._sprite.texture.baseTexture._id],this._sprite.texture.baseTexture.remove(),this._sprite.texture.remove());var t=document.createElement("canvas"),e=t.getContext("2d"),i=Math.ceil(this.width/this.texture.width),h=Math.ceil(this.height/this.texture.height),s=i*this.texture.width,r=h*this.texture.height;t.width=s*game.scale,t.height=r*game.scale,this._pos.set(0);for(var a=new game.Sprite(this.texture),n=0;n<h;n++)for(var o=0;o<i;o++)this._pos.x=o*a.width*game.scale,this._pos.y=n*a.height*game.scale,a._renderCanvas(e,null,null,this._pos);var _=game.Texture.fromCanvas(t);this.tw=_.width,this.th=_.height,game.TilingSprite.cache[this.texture.baseTexture._id]=_,this._sprite=new game.Sprite(_),this._sprite._parent=this,this._updateSprites=!1}},_getBounds:function(){if(this.rotation)var t=this.width,e=this.height,i=this._worldTransform,h=i.a,s=i.b,r=i.c,a=i.d,n=i.tx,o=i.ty,_=h*t+n,u=s*t+o,c=h*t+r*e+n,d=a*e+s*t+o,g=r*e+n,l=a*e+o,x=Math.min(n,_,c,g),w=Math.min(o,u,d,l),p=Math.max(n,_,c,g),m=Math.max(o,u,d,l);else x=this._worldTransform.tx,w=this._worldTransform.ty,p=x+this.width,m=w+this.height;for(var f=0;f<this.children.length;f++){var T=this.children[f]._getBounds(),v=T.x+T.width,y=T.y+T.height;T.x<x&&(x=T.x),T.y<w&&(w=T.y),v>p&&(p=v),y>m&&(m=y)}return this._worldBounds.x=x,this._worldBounds.y=w,this._worldBounds.width=p-x,this._worldBounds.height=m-w,this._worldBounds},_renderCanvas:function(t){if(!this.texture)return!0;if(!this.texture.baseTexture.loaded)return!0;if(!this.texture.width&&this.texture.baseTexture.width&&(this.texture.width=this.texture.baseTexture.width),!this.texture.height&&this.texture.baseTexture.height&&(this.texture.height=this.texture.baseTexture.height),!this.texture.width||!this.texture.height)return!0;var e=this._worldTransform.a/this._cosCache,i=this._worldTransform.d/this._cosCache,h=this.tw*game.scale,s=this.th*game.scale,r=this.width/e*game.scale,a=this.height/i*game.scale,n=this.tilePosition.x*game.scale,o=n%h,_=this.tilePosition.y*game.scale%s;o>0&&(o-=h),_>0&&(_-=s);for(var u=0;u<4&&!(_>=a);u++)this._rect.x=0,this._rect.y=0,this._rect.width=h,this._rect.height=s,this._pos.x=o*e,this._pos.y=_*i,o+h>r&&(this._rect.width=Math.ceil(r-o)),_+s>a&&(this._rect.height=Math.ceil(a-_)),o<0&&(this._rect.x=-o,this._pos.x=0),_<0&&(this._rect.y=-_,this._pos.y=0),this._rect.width>r&&(this._rect.width=r),this._rect.height>a&&(this._rect.height=a),this._rect.x+this._rect.width>h&&(this._rect.width=h-this._rect.x),this._rect.y+this._rect.height>s&&(this._rect.height=s-this._rect.y),this._sprite._worldAlpha=this._worldAlpha,this._sprite._renderCanvas(t,this._worldTransform,this._rect,this._pos),(o+=h)>=r&&((o=n%h)>0&&(o-=h),_+=s)}}),game.addAttributes("TilingSprite",{cache:{},clearCache:function(){for(var t in this.cache)this.cache[t].baseTexture.remove(),this.cache[t].remove(),delete this.cache[t]}}),game.defineProperties("TilingSprite",{width:{get:function(){var t=this._worldTransform.a/this._cosCache;return this._width*t},set:function(t){this._width!==t&&(this._updateSprites=!0),this._width=t}},height:{get:function(){var t=this._worldTransform.d/this._cosCache;return this._height*t},set:function(t){this._height!==t&&(this._updateSprites=!0),this._height=t}}})});game.module("engine.renderer.texture").body(function(){game.createClass("BaseTexture",{height:0,loaded:!1,source:null,width:0,_id:null,_loadCallback:null,staticInit:function(e,t){this.source=e,this._loadCallback=t,e.getContext?this._onload():(e.onload=this._onload.bind(this),e.onerror=this._onerror.bind(this))},remove:function(){for(var e in game.BaseTexture.cache)if(game.BaseTexture.cache[e]===this)return void delete game.BaseTexture.cache[e]},_onerror:function(){if(!this._loadCallback)throw"Error loading image "+this._id;this._loadCallback("Error loading image "+this._id)},_onload:function(){this.loaded=!0,this.width=this.source.width/game.scale,this.height=this.source.height/game.scale,this._loadCallback&&this._loadCallback()}}),game.addAttributes("BaseTexture",{cache:{},crossOrigin:"",clearCache:function(){for(var e in this.cache)delete this.cache[e]},fromAsset:function(e){var t=game.paths[e],a=this.cache[t];return a||(a=this.fromImage(t)),a},fromCanvas:function(e){e._id||(e._id="canvas_"+this._id++);var t=this.cache[e._id];return t||((t=new game.BaseTexture(e))._id=e._id,this.cache[e._id]=t),t},fromImage:function(e,t){var a=this.cache[e];if(a)t&&t();else{var i=document.createElement("img");this.crossOrigin&&(i.crossOrigin=this.crossOrigin),i.src=e+game._nocache,(a=new game.BaseTexture(i,t))._id=e,this.cache[e]=a}return a},_id:1}),game.createClass("Texture",{baseTexture:null,height:0,position:null,width:0,_anchor:null,_offset:null,_trim:null,staticInit:function(e,t,a,i,r){this._anchor=new game.Vector,this._offset=new game.Vector,this._trim=new game.Vector,this.baseTexture=e instanceof game.BaseTexture?e:game.BaseTexture.fromAsset(e),this.position=new game.Vector(t,a),this.width=i||this.baseTexture.width,this.height=r||this.baseTexture.height},remove:function(){for(var e in game.Texture.cache)if(game.Texture.cache[e]===this)return void delete game.Texture.cache[e]}}),game.addAttributes("Texture",{cache:{},clearCache:function(){for(var e in this.cache)delete this.cache[e]},fromAsset:function(e){var t=game.paths[e]||e,a=this.cache[t];return a||(a=game.Texture.fromImage(t)),a},fromCanvas:function(e){var t=this.cache[e._id];if(!t){var a=game.BaseTexture.fromCanvas(e);t=new game.Texture(a),this.cache[e._id]=t}return t},fromImage:function(e){var t=this.cache[e];return t||(t=new game.Texture(game.BaseTexture.fromImage(e)),this.cache[e]=t),t}})});game.module("engine.renderer.text").require("engine.renderer.sprite").body(function(){game.createClass("Font",{baseTexture:null,chars:{},letterSpacing:0,lineHeight:0,spaceWidth:0,staticInit:function(t){if(t.getElementsByTagName)var e=t.getElementsByTagName("page")[0].getAttribute("file"),s=(t.getElementsByTagName("info")[0],t.getElementsByTagName("common")[0]),i=t.getElementsByTagName("char");else e=t.pages[0].file,t.info,s=t.common,i=t.chars;this.baseTexture=game.BaseTexture.fromImage(game._getFilePath(e)),t.getElementsByTagName?this.lineHeight=parseInt(s.getAttribute("lineHeight")):this.lineHeight=parseInt(s.lineHeight);for(var a=0;a<i.length;a++){if(t.getElementsByTagName)var n=parseInt(i[a].getAttribute("xadvance")),h=parseInt(i[a].getAttribute("id"));else n=parseInt(i[a].xadvance),h=parseInt(i[a].id);if(32!==h){if(t.getElementsByTagName)var r=parseInt(i[a].getAttribute("xoffset")),l=parseInt(i[a].getAttribute("yoffset")),o=parseInt(i[a].getAttribute("x"))/game.scale,g=parseInt(i[a].getAttribute("y"))/game.scale,f=parseInt(i[a].getAttribute("width"))/game.scale,m=parseInt(i[a].getAttribute("height"))/game.scale;else r=parseInt(i[a].xoffset),l=parseInt(i[a].yoffset),o=parseInt(i[a].x)/game.scale,g=parseInt(i[a].y)/game.scale,f=parseInt(i[a].width)/game.scale,m=parseInt(i[a].height)/game.scale;var d=new game.Texture(this.baseTexture,o,g,f,m);this.chars[h]={texture:d,xadvance:n,xoffset:r,yoffset:l}}else this.spaceWidth=n}}}),game.addAttributes("Font",{cache:{},fromData:function(t){if(t.getElementsByTagName)var e=t.getElementsByTagName("info")[0].getAttribute("face");else e=t.info.face;var s=game.Font.cache[e];return s||(s=new game.Font(t),game.Font.cache[e]=s,game.Text.defaultFont||(game.Text.defaultFont=e)),s},clearCache:function(){for(var t in this.cache)delete this.cache[t]}}),game.createClass("Text","Container",{align:"left",font:null,fontClass:null,maxHeight:0,maxWidth:0,text:null,wrap:0,_lines:null,staticInit:function(t,e){this.super(),t="string"==typeof t||"number"==typeof t?t:"",this.text=this.text||t.toString(),game.merge(this,e),this.font=this.font||game.Text.defaultFont,this.font&&this.setFont(this.font)},setFont:function(t){if(this.font=t,this.fontClass=game.Font.cache[t],!this.fontClass)throw"Font "+t+" not found";return this.text&&this.setText(this.text),this},setText:function(t){return this.text=t.toString(),this.updateText(),this},updateText:function(){if(this.fontClass){this.removeAll();for(var t=[{words:[],width:0}],e=0,s=0,i="",a=1,n=0;n<this.text.length;n++){var h=this.text.charCodeAt(n);if(32===h||10===h){if(s>0)t[e].width+s>this.wrap&&this.wrap>0&&t[e].words.length>0&&(e++,t.push({words:[],width:0})),t[e].words.push({width:s,type:1,text:i,num:a}),t[e].width+=s,i="",a++}else i+=this.text[n];if(32!==h)if(10!==h){var r=this.fontClass.chars[h];r&&(s+=r.xadvance+this.fontClass.letterSpacing)}else e++,t.push({words:[],width:0}),s=0;else t[e].words.push({width:this.fontClass.spaceWidth,type:0,text:" ",num:a}),t[e].width+=this.fontClass.spaceWidth,s=0,a++}if(s>0)t[e].width+s>this.wrap&&this.wrap>0&&t[e].words.length>0&&(e++,t.push({words:[],width:0})),t[e].words.push({width:s,type:1,text:i,num:a}),t[e].width+=s;var l=0;for(n=0;n<t.length;n++){var o=t[n];o.width>l&&(l=o.width);for(var g=o.words.length-1;g>=0&&0===o.words[g].type;g--)o.width-=this.fontClass.spaceWidth}this._lines=t,this._generateText(l)}},_generateText:function(t){var e=0,s=0,i=0,a=0,n=0;"center"===this.align&&(e=t/2-this._lines[0].width/2),"right"===this.align&&(e=t-this._lines[0].width);for(var h=0;h<this.text.length;h++){this._lines[i].words[a]||(i++,this._lines[i]||i--,a=0,e>0&&(s+=this.fontClass.lineHeight),e=0,"center"===this.align&&(e=t/2-this._lines[i].width/2),"right"===this.align&&(e=t-this._lines[i].width));var r=this.text.charCodeAt(h);32===r&&(e>0&&(e+=this.fontClass.spaceWidth,32!==n&&a++),a++),10===r&&e>0&&(s+=this.fontClass.lineHeight,e=0,a++),n=r;var l=this.fontClass.chars[r];if(l){var o=l.texture;0===h&&(e-=l.xoffset);var g=new game.Sprite(o);g.position.x=(e+l.xoffset)/game.scale,g.position.y=(s+l.yoffset)/game.scale,this.addChild(g),e+=l.xadvance+this.fontClass.letterSpacing}}if(this.updateTransform(),this.maxWidth||this.maxHeight){var f=0;this.maxWidth&&this.width>this.maxWidth&&(f=this.maxWidth/this.width),this.maxHeight&&this.height>this.maxHeight&&(f=this.maxHeight/this.height),f.limit(0,1),this.scale.set(f)}}}),game.addAttributes("Text",{defaultFont:null}),game.createClass("SystemText","Container",{align:"left",color:"#fff",font:"Arial",size:14,text:"",staticInit:function(t,e){this.super(e),this.text=t||this.text},_renderCanvas:function(t){var e=this._worldTransform;t.globalAlpha=this._worldAlpha,t.setTransform(e.a,e.b,e.c,e.d,e.tx*game.scale,(e.ty+this.size)*game.scale),t.fillStyle=this.color,t.font=this.size*game.scale+"px "+this.font,t.textAlign=this.align,t.fillText(this.text,0,0)}})});game.module("engine.renderer.spritesheet").require("engine.renderer.sprite").body(function(){game.createClass("SpriteSheet","Sprite",{frameWidth:0,frameHeight:0,textures:[],staticInit:function(e,t,r){this.frameWidth=this.frameWidth||t,this.frameHeight=this.frameHeight||r,this.frameHeight||(this.frameHeight=this.frameWidth);var i=game.BaseTexture.cache[game.paths[e]];if(!i)throw"No texture found for "+e;var h=Math.floor(i.width/this.frameWidth),s=Math.floor(i.height/this.frameHeight);this.frames=h*s;for(var a=0;a<this.frames;a++){var f=a%h*this.frameWidth,m=Math.floor(a/h)*this.frameHeight,n=new game.Texture(i,f,m,this.frameWidth,this.frameHeight);this.textures.push(n)}this.super(this.textures[0])},frame:function(e){if(this.textures[e])return this.texture=this.textures[e],this}}),game.addAttributes("SpriteSheet",{anim:function(e,t,r,i,h,s){var a=new game.SpriteSheet(e,t,r);h=h||0;var f=[];if((i=i||a.textures.length).length>0)for(var m=0;m<i.length;m++)f.push(a.textures[h+i[m]]);else for(m=0;m<i;m++)f.push(a.textures[h+m]);return s?f:new game.Animation(f)}})});game.module("engine.renderer.graphics").require("engine.renderer.container").body(function(){game.createClass("Graphics","Container",{fillColor:"#fff",fillAlpha:1,lineAlpha:1,lineColor:"#fff",lineWidth:0,blendMode:"source-over",shapes:[],beginFill:function(e,i){return this.fillColor=e||this.fillColor,this.fillAlpha=i||this.fillAlpha,this},clear:function(){return this.shapes.length=0,this},drawArc:function(e,i,a,l,s){a*=game.scale;var t=new game.Arc(a,e,i,l,s);return this._drawShape(t),this},drawCircle:function(e,i,a){a*=game.scale;var l=new game.Circle(a,e,i);return this._drawShape(l),this},drawLine:function(e,i,a,l){a||l||(a=e,l=i,e=0,i=0),this.lineWidth=this.lineWidth||1,a*=game.scale,l*=game.scale;var s=new game.Rectangle(a,l,e,i);return this._drawShape(s,!0),this},drawPolygon:function(e,i){var a=new game.Polygon(e);return i&&a.close(),this._drawShape(a),this},drawRect:function(e,i,a,l){l=l||a,a*=game.scale,l*=game.scale;var s=new game.Rectangle(a,l,e,i);return this._drawShape(s),this},lineStyle:function(e,i,a){return this.lineWidth=e||this.lineWidth,this.lineColor=i||this.lineColor,this.lineAlpha=a||this.lineAlpha,this},_drawShape:function(e,i){var a=new game.GraphicsShape(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,e,i);this.shapes.push(a)},_getBounds:function(){for(var e=this._worldTransform,i=e.a,a=e.b,l=e.c,s=e.d,t=e.tx,h=e.ty,n=0,r=0,o=0;o<this.shapes.length;o++){var d=this.shapes[o],c=d.shape.x,p=d.shape.y;d.shape.radius?(c+=d.shape.radius/game.scale,p+=d.shape.radius/game.scale):(c+=d.shape.width/game.scale,p+=d.shape.height/game.scale),n=Math.max(n,c),r=Math.max(r,p)}var g=i*n+t,f=a*n+h,m=i*n+l*r+t,u=s*r+a*n+h,w=l*r+t,A=s*r+h,v=Math.min(t,g,m,w),C=Math.min(h,f,u,A),_=Math.max(t,g,m,w),y=Math.max(h,f,u,A);return this._worldBounds.x=v,this._worldBounds.y=C,this._worldBounds.width=_-v,this._worldBounds.height=y-C,this._worldBounds},_renderCanvas:function(e){var i=this._worldTransform,a=i.tx*game.scale,l=i.ty*game.scale;e.globalCompositeOperation=this.blendMode,e.setTransform(i.a,i.b,i.c,i.d,a,l);for(var s=0;s<this.shapes.length;s++)this.shapes[s]._render(e,this._worldAlpha)},_renderMask:function(e,i){var a=i,l=a.tx*game.scale,s=a.ty*game.scale;e.save(),e.setTransform(a.a,a.b,a.c,a.d,l,s),e.beginPath();for(var t=0;t<this.shapes.length;t++)this.shapes[t]._renderShape(e);e.closePath(),e.clip()}}),game.createClass("GraphicsShape",{fillAlpha:1,fillColor:"",isLine:!1,lineAlpha:0,lineColor:"",lineWidth:0,shape:null,staticInit:function(e,i,a,l,s,t,h){this.lineWidth=e,this.lineColor=i,this.lineAlpha=a,this.fillColor=l,this.fillAlpha=s,this.shape=t,this.isLine=h||this.isLine},_render:function(e,i){e.globalAlpha=this.fillAlpha*i,e.fillStyle=this.fillColor,e.strokeStyle=this.lineColor,e.lineWidth=this.lineWidth*game.scale,e.beginPath(),this._renderShape(e),this.fillColor&&this.fillAlpha&&e.fill(),this.lineWidth&&(e.globalAlpha=this.lineAlpha*i,e.stroke())},_renderShape:function(e){var i=this.shape,a=i.x*game.scale,l=i.y*game.scale;if(this.isLine)e.moveTo(a,l),e.lineTo(i.width,i.height);else if(i.width)e.rect(a,l,i.width,i.height);else if(i.radius)"number"==typeof i.startAngle&&"number"==typeof i.endAngle?(e.moveTo(a,l),e.arc(a,l,i.radius,i.startAngle,i.endAngle),e.closePath()):e.arc(a,l,i.radius,0,2*Math.PI);else if(i.points){e.moveTo(0,0);for(var s=0;s<i.points.length;s++){var t=i.points[s];a=t.x,l=t.y;void 0===a&&(a=t,l=i.points[s+1],s++),e.lineTo(a*game.scale,l*game.scale)}}}})});game.module("engine.renderer.animation").require("engine.renderer.sprite").body(function(){game.createClass("Animation","Sprite",{anims:{},currentAnim:null,currentFrame:0,loop:!0,onComplete:null,playing:!1,random:!1,reverse:!1,speed:10,textures:null,_frameTime:0,staticInit:function(e){if(this.currentAnim=this,this.textures=this.textures||e,"string"==typeof this.textures&&-1!==this.textures.indexOf("atlas")){var t=game.getJSON(this.textures);for(var r in this.textures=[],t.frames)this.textures.push(r)}for(var i=[],s=0;s<this.textures.length;s++){var n=this.textures[s];!n instanceof game.Texture&&(n=game.Texture.fromAsset(n)),i.push(n)}this.textures=i,this.super(this.textures[0])},addAnim:function(e,t,r,i){if(e&&void 0!==typeof t){"object"==typeof r&&(i=r);var s=[];if(t.length)for(var n=0;n<t.length;n++)s[n]=this.textures[t[n]];else if("number"==typeof t&&"number"==typeof r)for(n=0;n<r;n++)s[n]=this.textures[t+n];var u=new game.Animation(s);return u.loop=this.loop,u.random=this.random,u.reverse=this.reverse,u.speed=this.speed,game.merge(u,i),this.anims[e]=u,this}},gotoFrame:function(e){if(!this.currentAnim.textures)throw"No textures found for animation";if(this.currentAnim.textures[e])return this.currentFrame=e,this._frameTime=0,this.setTexture(this.currentAnim.textures[e]),this},play:function(e,t){return this.playing=!0,this.currentAnim=this.anims[e]||this,"number"==typeof e&&(t=e),"number"!=typeof t&&this.reverse&&(t=this.textures.length-1),this.gotoFrame(t||0),this},stop:function(e){return this.playing=!1,"number"==typeof e&&this.gotoFrame(e),this},updateTransform:function(){this.playing&&this._updateAnimation(),this.super()},_updateAnimation:function(){if(!game.scene.paused||-1===game.scene._pausedAnims.indexOf(this)){var e=this.currentAnim;if(!e.textures)throw"No textures found for animation";if(this._frameTime+=e.speed*game.delta,this._frameTime>=1){if(this._frameTime=this._frameTime%1,e.random&&e.textures.length>1){for(var t=this.currentFrame;t===this.currentFrame;)t=Math.round(Math.random(0,e.textures.length-1));return this.currentFrame=t,void this.setTexture(e.textures[t])}(t=this.currentFrame+(e.reverse?-1:1))>=e.textures.length?e.loop?(this.currentFrame=0,this.setTexture(e.textures[0])):(this.playing=!1,e.onComplete&&e.onComplete()):t<0?e.loop?(this.currentFrame=e.textures.length-1,this.setTexture(e.textures.last())):(this.playing=!1,e.onComplete&&e.onComplete()):(this.currentFrame=t,this.setTexture(e.textures[t]))}}}}),game.addAttributes("Animation",{fromTextures:function(e){var t=[];for(var r in game.Texture.cache)-1!==r.indexOf(e)&&t.push(r);if(0===t.length)for(var r in game.BaseTexture.cache)-1!==r.indexOf(e)&&t.push(r);if(t.length>0)return t.sort(game.compare),new game.Animation(t);throw"No textures found for "+e}})});game.module("engine.renderer.core").require("engine.renderer.animation","engine.renderer.container","engine.renderer.fastcontainer","engine.renderer.graphics","engine.renderer.sprite","engine.renderer.spritesheet","engine.renderer.text","engine.renderer.texture","engine.renderer.tilingsprite").body(function(){game.createClass("Renderer",{canvas:null,context:null,_smoothProperty:null,init:function(e,t){game.device.cocoonCanvasPlus||(this.canvas=document.getElementById(game.System.canvasId)),this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.id=game.System.canvasId,this.canvas.style.display="block",this.canvas.style.outline="none","nearest"===game.Renderer.scaleMode&&(this.canvas.style.imageRendering="pixelated"),this.canvas.tabIndex=1,document.body.appendChild(this.canvas),game.System.center||(document.body.style.margin=0)),game._normalizeVendorAttribute(this.canvas,"requestFullScreen"),this._initContext(),"imageSmoothingEnabled"in this.context?this._smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this._smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this._smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context?this._smoothProperty="oImageSmoothingEnabled":"msImageSmoothingEnabled"in this.context&&(this._smoothProperty="msImageSmoothingEnabled"),this._resize(e,t)},_clear:function(){game.scene.backgroundColor?(this.context.fillStyle=game.scene.backgroundColor,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)):this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},_hide:function(){this.canvas.style.display="none"},_initContext:function(){this.context=this.canvas.getContext("2d")},_position:function(e,t){this.canvas.style.position="absolute",this.canvas.style.left=e+"px",this.canvas.style.top=t+"px"},_render:function(e){this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.context.globalCompositeOperation="source-over",game.Renderer.clearBeforeRender&&this._clear(),e._updateChildTransform(),e._render(this.context)},_resize:function(e,t){this.canvas.width=e,this.canvas.height=t,this._smoothProperty&&(this.context[this._smoothProperty]="linear"===game.Renderer.scaleMode)},_show:function(){this.canvas.style.display="block"},_size:function(e,t){this.canvas.style.width=e+"px",this.canvas.style.height=t+"px"}}),game.addAttributes("Renderer",{clearBeforeRender:!0,roundPixels:!1,scaleMode:"linear"}),game.createClass("Matrix",{a:1,b:0,c:0,d:1,tx:0,ty:0,reset:function(){var e=this.constructor.prototype;return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}}),game.addAttributes("Matrix",{empty:new game.Matrix})});game.module("engine.pool").body(function(){game.createClass("Pool",{pools:{},create:function(o){return!this.pools[o]&&(this.pools[o]=[],!0)},get:function(o){if(this.pools[o]&&this.pools[o].length)return this.pools[o].pop()},put:function(o,t){return!!this.pools[o]&&(this.pools[o].push(t),!0)}})});game.module("engine.physics").require("engine.renderer.sprite").body(function(){game.createClass("Body",{collideAgainst:[],damping:0,force:null,last:null,mass:1,position:null,shape:null,static:!1,velocity:null,velocityLimit:null,world:null,_collides:[],_collisionGroup:0,init:function(i){this.force=new game.Vector,this.position=new game.Vector,this.velocity=new game.Vector,this.velocityLimit=new game.Vector(980,980),this.last=new game.Vector,game.merge(this,i)},addShape:function(i){return this.shape=i,this},addTo:function(i){if(!this.world)return i.addBody(this),this},afterCollide:function(){},applyImpulse:function(i,t){return this.velocity.add(i,t),this},collide:function(){return!0},remove:function(){return this.world&&this.world.removeBody(this),this},removeCollision:function(){return this.world&&this.world._removeBodyCollision(this),this},_update:function(){if(this.last.copy(this.position),!this.static){if(this.velocity.x+=this.world.gravity.x*this.mass*game.delta,this.velocity.y+=this.world.gravity.y*this.mass*game.delta,this.velocity.x+=this.force.x*game.delta,this.velocity.y+=this.force.y*game.delta,this.damping>0&&this.damping<1){var i=Math.pow(1-this.damping,game.delta);this.velocity.x*=i,this.velocity.y*=i}this.velocityLimit.x>0&&(this.velocity.x>this.velocityLimit.x&&(this.velocity.x=this.velocityLimit.x),this.velocity.x<-this.velocityLimit.x&&(this.velocity.x=-this.velocityLimit.x)),this.velocityLimit.y>0&&(this.velocity.y>this.velocityLimit.y&&(this.velocity.y=this.velocityLimit.y),this.velocity.y<-this.velocityLimit.y&&(this.velocity.y=-this.velocityLimit.y)),this.position.x+=this.velocity.x*game.delta,this.position.y+=this.velocity.y*game.delta}}}),game.defineProperties("Body",{collisionGroup:{get:function(){return this._collisionGroup},set:function(i){this._collisionGroup!==i&&(this.world&&"number"==typeof this._collisionGroup&&this.world._removeBodyCollision(this),this._collisionGroup=i,this.world&&this.world._addBodyCollision(this))}}}),game.createClass("Physics",{bodies:[],gravity:null,_collisionGroups:{},staticInit:function(i,t){i="number"==typeof i?i:0,t="number"==typeof t?t:980,this.gravity=new game.Vector(i,t),game.scene&&game.scene.physics.push(this)},addBody:function(i){i.world=this,i._remove=!1,this.bodies.push(i),this._addBodyCollision(i)},hitResponse:function(i,t){if(i.static)return!1;if(i.shape.width&&t.shape.width){if(i.last.y+i.shape.height/2<=t.last.y-t.shape.height/2){if(i.collide(t,"DOWN"))return i.position.y=t.position.y-t.shape.height/2-i.shape.height/2,!0}else if(i.last.y-i.shape.height/2>=t.last.y+t.shape.height/2){if(i.collide(t,"UP"))return i.position.y=t.position.y+t.shape.height/2+i.shape.height/2,!0}else if(i.last.x+i.shape.width/2<=t.last.x-t.shape.width/2){if(i.collide(t,"RIGHT"))return i.position.x=t.position.x-t.shape.width/2-i.shape.width/2,!0}else if(i.last.x-i.shape.width/2>=t.last.x+t.shape.width/2){if(i.collide(t,"LEFT"))return i.position.x=t.position.x+t.shape.width/2+i.shape.width/2,!0}else if(i.collide(t))return!0}else if(i.shape.radius&&t.shape.radius){var o=t.position.angle(i.position);if(i.collide(t,o)){var s=i.shape.radius+t.shape.radius;return i.position.x=t.position.x+Math.cos(o)*s,i.position.y=t.position.y+Math.sin(o)*s,!0}}else if(i.collide(t))return!0;return!1},hitTest:function(i,t){if(i.shape.width&&t.shape.width)return!(i.position.y+i.shape.height/2<=t.position.y-t.shape.height/2||i.position.y-i.shape.height/2>=t.position.y+t.shape.height/2||i.position.x-i.shape.width/2>=t.position.x+t.shape.width/2||i.position.x+i.shape.width/2<=t.position.x-t.shape.width/2);if(i.shape.radius&&t.shape.radius)return i.shape.radius+t.shape.radius>i.position.distance(t.position);if(i.shape.width&&t.shape.radius||i.shape.radius&&t.shape.width){var o=i.shape.width?i:t,s=i.shape.radius?i:t,e=Math.max(o.position.x-o.shape.width/2,Math.min(o.position.x+o.shape.width/2,s.position.x)),h=Math.max(o.position.y-o.shape.height/2,Math.min(o.position.y+o.shape.height/2,s.position.y));return Math.pow(s.position.x-e,2)+Math.pow(s.position.y-h,2)<s.shape.radius*s.shape.radius}return!1},removeBody:function(i){i.world&&(i.world=null,i._remove=!0)},_addBodyCollision:function(i){"number"==typeof i.collisionGroup&&(this._collisionGroups[i.collisionGroup]=this._collisionGroups[i.collisionGroup]||[],-1===this._collisionGroups[i.collisionGroup].indexOf(i)&&this._collisionGroups[i.collisionGroup].push(i))},_collide:function(i){var t,o,s,e;for(t=0;t<i.collideAgainst.length;t++)if(i._collides.length=0,e=this._collisionGroups[i.collideAgainst[t]]){for(o=e.length-1;o>=0&&e;o--)i!==(s=e[o])&&this.hitTest(i,s)&&i._collides.push(s);for(o=i._collides.length-1;o>=0;o--)this.hitResponse(i,i._collides[o])&&i.afterCollide(i._collides[o])}},_removeBodyCollision:function(i){"number"==typeof i.collisionGroup&&this._collisionGroups[i.collisionGroup]&&-1!==this._collisionGroups[i.collisionGroup].indexOf(i)&&this._collisionGroups[i.collisionGroup].erase(i)},_update:function(){var i;for(i=this.bodies.length-1;i>=0;i--)this.bodies[i]._remove?(this._removeBodyCollision(this.bodies[i]),this.bodies.splice(i,1)):this.bodies[i]._update()},_updateCollision:function(){for(i in this._collisionGroups)if(0!==this._collisionGroups[i].length)for(j=0;j<this._collisionGroups[i].length;j++)this._collisionGroups[i][j]&&this._collisionGroups[i][j].collideAgainst.length>0&&this._collide(this._collisionGroups[i][j]);else delete this._collisionGroups[i]}}),game.createClass("PhysicsSprite","Sprite",{body:null,shape:"Rectangle",staticInit:function(i,t,o){this.super(i),this.anchorCenter(),t=t||this.width,o=o||this.height;var s=new game[this.shape](t,o);this.body=new game.Body,this.body.addShape(s),this.body.collide=this.collide.bind(this),this.position=this.body.position},addTo:function(i,t){if(!(t=t||game.scene.world))throw"addTo: Physics world not defined";return this.body.addTo(t),this.super(i)},collide:function(){return!0},remove:function(){return this.body.remove(),this.super()}})});game.module("engine.renderer.fastcontainer").require("engine.renderer.container").body(function(){game.createClass("FastContainer","Container",{_isRotated:!0,_getBounds:function(){return this._worldBounds.x=0,this._worldBounds.y=0,this._worldBounds.width=0,this._worldBounds.height=0,this._worldBounds},_renderBatch:function(e,a){a.globalAlpha=this._worldAlpha*e.alpha;var t=this._worldTransform,r=e.texture;e._cachedSprite&&(r=e._cachedSprite.texture);var i=r.position.x*game.scale,s=r.position.y*game.scale,n=r.width*game.scale,o=r.height*game.scale;if(e.rotation%(2*Math.PI)==0){this._isRotated&&(a.setTransform(t.a,t.b,t.c,t.d,t.tx*game.scale,t.ty*game.scale),this._isRotated=!1);var d=(e.position.x-e.anchor.x*e.scale.x)*game.scale,l=(e.position.y-e.anchor.y*e.scale.y)*game.scale;a.drawImage(r.baseTexture.source,i,s,n,o,d,l,n*e.scale.x,o*e.scale.y)}else{this._isRotated=!0,e.updateTransform();var h=e._worldTransform;d=h.tx*game.scale,l=h.ty*game.scale;game.Renderer.roundPixels&&(d|=0,l|=0),a.setTransform(h.a,h.b,h.c,h.d,d,l),a.drawImage(r.baseTexture.source,i,s,n,o,0,0,n,o)}},_renderChildren:function(e){this._isRotated=!0;for(var a=0;a<this.children.length;a++){var t=this.children[a],r=t.texture||t._cachedSprite;t.visible&&!(t.alpha<=0)&&t.renderable&&r&&this._renderBatch(t,e)}},_updateChildTransform:function(){for(var e=this.children.length-1;e>=0;e--){var a=this.children[e];!a.visible||a.alpha<=0||a.updateAnimation&&a.updateAnimation()}}})});game.module("engine.renderer.container").require("engine.geometry").body(function(){game.createClass("Container",{alpha:1,anchor:null,buttonMode:!1,children:[],hitArea:null,mask:null,position:null,renderable:!0,rotation:0,scale:null,skew:null,stage:null,visible:!0,_cached:!1,_cachedSprite:null,_cosCache:1,_interactive:!1,_lastTransformUpdate:-1,_localTransform:null,_parent:null,_rotationCache:0,_sinCache:0,_worldAlpha:1,_worldBounds:null,_worldTransform:null,staticInit:function(t){this.anchor=new game.Vector,this.position=new game.Vector,this.scale=new game.Vector(1),this.skew=new game.Vector,this._worldBounds=new game.Rectangle,this._worldTransform=new game.Matrix,this._localTransform=new game.Matrix,game.merge(this,t)},addChild:function(t){if(!t)throw"addChild: child undefined";return t.parent=this,this},addChildAt:function(t,e){if(!t)throw"addChildAt: child undefined";return this.addChild(t),e>=0&&e<this.children.length-1&&(console.log("splicing"),this.children.splice(this.children.indexOf(t)),this.children.splice(e,0,t)),this},addTo:function(t,e){if(!t)throw"addTo: child undefined";return t.addChildAt(this,e),this},anchorCenter:function(){var t=this.width/this.scale.x,e=this.height/this.scale.y;return this.anchor.set(t/2,e/2),this},center:function(t,e,i,h){if(t||(t=this.parent),!t)throw"center: target undefined";if(t===game.scene.stage){var r=game.width/2,s=game.height/2;r+=this.anchor.x*this.scale.x,s+=this.anchor.y*this.scale.y}else{t.updateTransform();var n=t._getBounds();if(h)r=n.x+n.width/2,s=n.y+n.height/2;else r=-t.anchor.x+n.width/t.scale.x/2,s=-t.anchor.y+n.height/t.scale.y/2;r+=this.anchor.x*this.scale.x,s+=this.anchor.y*this.scale.y}var a=this._getBounds();return r-=a.width*this.scale.x/2,s-=a.height*this.scale.y/2,e=e||0,i=i||0,this.position.set(r+e,s+i),this},click:function(){},hitTest:function(t){if(!t)throw"hitTest: target undefined";var e=this._getBounds(),i=t._getBounds();return!(e.y+e.height/2<=i.y-i.height/2||e.y-e.height/2>=i.y+i.height/2||e.x-e.width/2>=i.x+i.width/2||e.x+e.width/2<=i.x-i.width/2)},mousedown:function(){},mousemove:function(){},mouseout:function(){},mouseover:function(){},mouseup:function(){},mouseupoutside:function(){},onScreen:function(){var t=this._getBounds();return!(t.x+t.width<0)&&(!(t.x>game.width)&&(!(t.y+t.height<0)&&!(t.y>game.height)))},remove:function(){return this.parent&&this.parent.removeChild(this),this},removeAll:function(){for(var t=this.children.length-1;t>=0;t--)this.children[t].remove();return this},removeChild:function(t){if(!t)throw"removeChild: child undefined";var e=this.children.indexOf(t);if(-1!==e)return this.children.splice(e,1),t._parent=null,this.stage&&t._removeStageReference(),this._cached&&(this._destroyCachedSprite(),this._generateCachedSprite()),this},swap:function(t){if(!t)throw"swap: container undefined";if(this.parent)return this.parent.swapChildren(this,t),this},swapChildren:function(t,e){if(t!==e){var i=this.children.indexOf(t),h=this.children.indexOf(e);i<0||h<0||(this.children[i]=e,this.children[h]=t)}},toBottom:function(){if(this.parent){var t=this.parent;this.remove(),this.addTo(t,0)}},toTop:function(){if(this.parent){var t=this.parent;this.remove(),this.addTo(t)}},toWorldPosition:function(t,e){this._lastTransformUpdate!==game.Timer.time&&this._updateParentTransform();var i=e?-this.parent._worldTransform.tx+this.position.x:this._worldTransform.tx,h=e?-this.parent._worldTransform.ty+this.position.y:this._worldTransform.ty;if(e||(i+=this.anchor.x,h+=this.anchor.y),!t)return new game.Vector(i,h);t.set(i,h)},updateTransform:function(){if(!this.parent)return this._updateChildTransform();var t=this.parent._worldTransform,e=this._localTransform,i=this._worldTransform;this._rotationCache!==this.rotation&&(this._rotationCache=this.rotation,this._sinCache=Math.sin(this.rotation),this._cosCache=Math.cos(this.rotation));var h=this.anchor.x,r=this.anchor.y;if(e.a=this._cosCache*this.scale.x,e.b=this._sinCache*this.scale.x,e.c=-this._sinCache*this.scale.y,e.d=this._cosCache*this.scale.y,e.tx=this.position.x-(h*e.a+r*e.c),e.ty=this.position.y-(h*e.b+r*e.d),this.parent.texture){var s=this.parent.anchor.x,n=this.parent.anchor.y;e.tx+=s,e.ty+=n}i.a=e.a*t.a+e.b*t.c,i.b=e.a*t.b+e.b*t.d,i.c=e.c*t.a+e.d*t.c,i.d=e.c*t.b+e.d*t.d,i.tx=e.tx*t.a+e.ty*t.c+t.tx,i.ty=e.tx*t.b+e.ty*t.d+t.ty,i.c+=this.skew.x*i.a,i.d+=this.skew.x*i.b,i.a+=this.skew.y*i.c,i.b+=this.skew.y*i.d,this._worldAlpha=this.parent._worldAlpha*this.alpha,this._lastTransformUpdate=game.Timer.time,this._cachedSprite?this._cachedSprite._worldAlpha=this._worldAlpha:this._updateChildTransform()},_destroyCachedSprite:function(){this._cachedSprite&&this._cachedSprite.texture.remove(),this._cachedSprite=null},_generateCachedSprite:function(){this.updateTransform();var t=document.createElement("canvas"),e=t.getContext("2d"),i=this._getBounds();t.width=i.width/this.scale.x*game.scale,t.height=i.height/this.scale.y*game.scale,this._worldTransform.reset(),this._updateChildTransform(),this._renderCanvas(e),this._renderChildren(e);var h=game.Texture.fromCanvas(t),r=new game.Sprite(h);r._parent=this,this._cachedSprite=r},_getBounds:function(){if(!this.children.length)return this._worldBounds.x=this._worldTransform.tx,this._worldBounds.y=this._worldTransform.ty,this._worldBounds.width=0,this._worldBounds.height=0,this._worldBounds;if(this._cachedSprite){if(this.rotation){var t=this._cachedSprite.texture.width,e=this._cachedSprite.texture.height,i=this._worldTransform,h=i.a,r=i.b,s=i.c,n=i.d,a=i.tx,o=i.ty,d=h*t+a,c=r*t+o,l=h*t+s*e+a,u=n*e+r*t+o,_=s*e+a,f=n*e+o,m=Math.min(a,d,l,_),p=Math.min(o,c,u,f),g=Math.max(a,d,l,_),w=Math.max(o,c,u,f);return this._worldBounds.x=m,this._worldBounds.y=p,this._worldBounds.width=g-m,this._worldBounds.height=w-p,this._worldBounds}return this._worldBounds.x=this._worldTransform.tx+this._cachedSprite.position.x,this._worldBounds.y=this._worldTransform.ty+this._cachedSprite.position.y,this._worldBounds.width=this._cachedSprite.texture.width*this._worldTransform.a,this._worldBounds.height=this._cachedSprite.texture.height*this._worldTransform.d,this._worldBounds}this._lastTransformUpdate<game.Timer._lastFrameTime&&this.updateTransform();m=this._worldTransform.tx,p=this._worldTransform.ty,g=this._worldTransform.tx,w=this._worldTransform.ty;if(this.mask){var x=this.mask._getBounds();m=x.x,p=x.y,g=m+x.width,w=p+x.height}else for(var v=0;v<this.children.length;v++){var y=this.children[v],T=y._getBounds(y._localTransform),C=this._worldTransform.tx+T.x,B=this._worldTransform.ty+T.y,S=C+T.width,b=B+T.height;C<m&&(m=C),B<p&&(p=B),S>g&&(g=S),b>w&&(w=b)}return this._worldBounds.x=m,this._worldBounds.y=p,this._worldBounds.width=(g-m)*Math.abs(this.scale.x),this._worldBounds.height=(w-p)*Math.abs(this.scale.y),this._worldBounds},_removeStageReference:function(){for(var t=0;t<this.children.length;t++){this.children[t]._removeStageReference()}this._interactive&&(game.input._needUpdate=!0),this.stage=null},_render:function(t){this.mask&&this.mask._renderMask&&this.mask._renderMask(t,this._worldTransform),this._cachedSprite?this._cachedSprite._renderCanvas(t,this._worldTransform):(this._renderCanvas(t),this._renderChildren(t)),this.mask&&this.mask._renderMask&&t.restore()},_renderCanvas:function(t){},_renderChildren:function(t){for(var e=0;e<this.children.length;e++){var i=this.children[e];!i.visible||i.alpha<=0||!i.renderable||i._render(t)}},_setStageReference:function(t){this.stage=t,this._interactive&&(game.input._needUpdate=!0);for(var e=0;e<this.children.length;e++){this.children[e]._setStageReference(t)}},_updateChildTransform:function(){for(var t=this.children.length-1;t>=0;t--){var e=this.children[t];e.visible&&e.updateTransform()}},_updateParentTransform:function(){this.parent?this.parent._updateParentTransform():this.updateTransform()}}),game.defineProperties("Container",{cache:{get:function(){return this._cached},set:function(t){this._cached!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cached=t)}},height:{get:function(){return this._getBounds().height},set:function(t){this.scale.y=t/this.height}},interactive:{get:function(){return this._interactive},set:function(t){this._interactive!==t&&(this._interactive=t,this.stage&&(game.input._needUpdate=!0))}},parent:{get:function(){return this._parent},set:function(t){-1===t.children.indexOf(this)&&(this.parent&&this.remove(),t.children.push(this),this._parent=t,t.stage&&this._setStageReference(t.stage),t._cached&&(t._destroyCachedSprite(),t._generateCachedSprite()))}},width:{get:function(){return this._getBounds().width},set:function(t){this.scale.x=t/this.width}},x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}}})});game.module("engine.renderer.sprite").require("engine.renderer.container").body(function(){game.createClass("Sprite","Container",{blendMode:"source-over",texture:null,tint:null,tintAlpha:1,tintCrop:null,_tintAlpha:1,_tintColor:null,staticInit:function(t,e){this.tintCrop=new game.Rectangle,this.super(e),this.setTexture(this.texture||t)},setTexture:function(t){this.texture=t instanceof game.Texture?t:game.Texture.fromAsset(t)},_destroyTintedTexture:function(){this._tintedTexture&&(this._tintedTexture.baseTexture.remove(),this._tintedTexture.remove()),this._tintedTexture=null,this._tintedTextureGenerated=!1},_generateTintedTexture:function(t,e){var i=document.createElement("canvas"),h=i.getContext("2d");i.width=this.texture.width*game.scale,i.height=this.texture.height*game.scale,this._tintColor=t,this._tintAlpha=e||1,h.fillStyle=this._tintColor.substr(0,7),h.globalAlpha=this._tintAlpha;var r=this.tintCrop.x*game.scale,s=this.tintCrop.y*game.scale,n=i.width-r-this.tintCrop.width*game.scale,a=i.height-s-this.tintCrop.height*game.scale;h.fillRect(r,s,n,a),h.globalAlpha=1;var d=this.blendMode;this.blendMode="destination-atop",e=this._worldAlpha,this._worldAlpha=1,this._renderCanvas(h,game.Matrix.empty),this._worldAlpha=e,this.blendMode=d;var o=game.Texture.fromCanvas(i);return game.Sprite._tintedTextures.push(o),o},_getBounds:function(t){if(this._cachedSprite)return this._worldBounds.x=this._worldTransform.tx+this._cachedSprite.position.x,this._worldBounds.y=this._worldTransform.ty+this._cachedSprite.position.y,this._worldBounds.width=this._cachedSprite.texture.width*this._worldTransform.a,this._worldBounds.height=this._cachedSprite.texture.height*this._worldTransform.d,this._worldBounds;this._lastTransformUpdate<game.Timer._lastFrameTime&&this.updateTransform();for(var e=this.texture.width,i=this.texture.height,h=t||this._worldTransform,r=h.a,s=h.b,n=h.c,a=h.d,d=h.tx,o=h.ty,u=r*e+d,l=s*e+o,x=r*e+n*i+d,_=a*i+s*e+o,g=n*i+d,m=a*i+o,c=Math.min(d,u,x,g),T=Math.min(o,l,_,m),p=Math.max(d,u,x,g),w=Math.max(o,l,_,m),f=0;f<this.children.length;f++)if(this.children[f].visible&&!(this.children[f].alpha<=0)){var b=this.children[f]._getBounds(),y=b.x,A=y+b.width,v=b.y,C=v+b.height;c=Math.min(c,y),T=Math.min(T,v),p=Math.max(p,A),w=Math.max(w,C)}return this._worldBounds.x=c,this._worldBounds.y=T,this._worldBounds.width=p-c,this._worldBounds.height=w-T,this._worldBounds},_renderCanvas:function(t,e,i,h){if(!this.texture)return!0;if(!this.texture.baseTexture.loaded)return!0;if(!this.texture.width&&this.texture.baseTexture.width&&(this.texture.width=this.texture.baseTexture.width),!this.texture.height&&this.texture.baseTexture.height&&(this.texture.height=this.texture.baseTexture.height),!this.texture.width||!this.texture.height)return!0;this.tint&&!this._tintedTexture&&!this._tintedTextureGenerated&&this.tintAlpha>0?(this._tintedTextureGenerated=!0,this._tintedTexture=this._generateTintedTexture(this.tint,this.tintAlpha)):this.tint&&this.tint!==this._tintColor&&this.tintAlpha>0||this.tint&&this.tintAlpha!==this._tintAlpha&&this.tintAlpha>0?(this._destroyTintedTexture(),this._tintedTextureGenerated=!0,this._tintedTexture=this._generateTintedTexture(this.tint,this.tintAlpha)):(!this.tint&&this._tintedTexture||0===this.tintAlpha&&this._tintedTexture)&&this._destroyTintedTexture(),t.globalCompositeOperation=this.blendMode,t.globalAlpha=this._worldAlpha;var r=this._tintedTexture||this.texture,s=e||this._worldTransform,n=s.tx,a=s.ty;game.Renderer.roundPixels&&(n|=0,a|=0),n*=game.scale,a*=game.scale;var d=r.position.x*game.scale,o=r.position.y*game.scale,u=r.width*game.scale,l=r.height*game.scale;i&&(d=i.x,o=i.y,u=i.width,l=i.height),h&&(n+=h.x,a+=h.y),t.setTransform(s.a,s.b,s.c,s.d,n,a),r._trim.x&&(u=r._trim.x),r._trim.y&&(l=r._trim.y);var x=r._offset.x-r._anchor.x,_=r._offset.y-r._anchor.y;t.drawImage(r.baseTexture.source,d,o,u,l,x,_,u,l)}}),game.defineProperties("Sprite",{width:{get:function(){return Math.abs(this.scale.x)*this.texture.width},set:function(t){this.scale.x=t/this.texture.width}},height:{get:function(){return Math.abs(this.scale.y)*this.texture.height},set:function(t){this.scale.y=t/this.texture.height}}}),game.addAttributes("Sprite",{_tintedTextures:[],_clearTintedTextures:function(){for(var t=0;t<this._tintedTextures.length;t++)this._tintedTextures[t].baseTexture.remove(),this._tintedTextures[t].remove();this._tintedTextures.length=0}})});game.module("engine.particle").require("engine.renderer.sprite","engine.renderer.fastcontainer").body(function(){game.createClass("Particles","FastContainer",{accelAngle:Math.PI/2,accelAngleVar:0,accelSpeed:0,accelSpeedVar:0,active:!0,alphaEnd:0,alphaStart:1,angle:0,angleVar:Math.PI,emitCount:1,emitDuration:0,emitRate:100,life:2e3,lifeVar:0,onComplete:null,particles:[],startPos:null,startPosVar:null,startRot:0,startRotVar:0,randomTexture:!0,rotate:0,rotateVar:0,scaleEnd:1,scaleEndVar:0,scaleStart:1,scaleStartVar:0,speed:100,speedVar:0,target:null,targetForce:0,targetUpdate:!0,textures:[],velocityLimit:null,velRotate:0,velRotateVar:0,_currentTexture:0,_durationTimer:0,_onCompleteCalled:!1,_poolName:null,_rateTimer:0,staticInit:function(t,e){this.super(),t&&("string"==typeof t?this.textures.push(t):this.textures=t),this._poolName=game.Particles.poolName,this.startPos=new game.Vector,this.startPosVar=new game.Vector,this.target=new game.Vector,this.velocityLimit=new game.Vector,game.pool.create(this._poolName),game.merge(this,e)},emit:function(t){t=t||this.emitCount;for(var e=0;e<t;e++)this._addParticle()},remove:function(){this.super(),this._remove=!0},reset:function(){this._rateTimer=0,this._durationTimer=0,this.active=!0,this._onCompleteCalled=!1},updateTransform:function(){if(this._remove)for(var t=this.children.length-1;t>=0;t--)this._removeParticle(this.children[t]);else{this._durationTimer+=1e3*game.delta,this.emitDuration>0&&(this.active=this._durationTimer<this.emitDuration,this.active||0!==this.children.length||"function"!=typeof this.onComplete||this._onCompleteCalled||(this.onComplete(),this._onCompleteCalled=!0)),this.emitRate&&this.active&&(this._rateTimer+=1e3*game.delta,this._rateTimer>=0&&(this._rateTimer=-this.emitRate,this.emit()));for(t=this.children.length-1;t>=0;t--)this.children[t]._update();this.super()}},_addParticle:function(){if(this.randomTexture)var t=this.textures.random();else{t=this.textures[this._currentTexture];this._currentTexture++,this._currentTexture>=this.textures.length&&(this._currentTexture=0)}if(t){var e=game.pool.get(this._poolName);e?e.setTexture(t):e=new game.Particle(t),e.emitter=this,e.rotation=this.startRot+this._getVar(this.startRotVar),e.alpha=this.alphaStart,e.position.x=this.startPos.x+this._getVar(this.startPosVar.x),e.position.y=this.startPos.y+this._getVar(this.startPosVar.y);var i=this._getVar(this.angleVar),a=this.angle+i,s=this.speed+this._getVar(this.speedVar);e.velocity.x=Math.cos(a)*s,e.velocity.y=Math.sin(a)*s,this.angleVar!==this.accelAngleVar&&(i=this._getVar(this.accelAngleVar)),a=this.accelAngle+i,s=this.accelSpeed+this._getVar(this.accelSpeedVar),e.accel.x=Math.cos(a)*s,e.accel.y=Math.sin(a)*s,e.life=this.life+this._getVar(this.lifeVar),e.rotateAmount=this.rotate+this._getVar(this.rotateVar),e.velRotate=this.velRotate+this._getVar(this.velRotateVar),this.alphaStart!==this.alphaEnd?(e.deltaAlpha=this.alphaEnd-this.alphaStart,e.deltaAlpha/=e.life/1e3):e.deltaAlpha=0;var r=this.scaleStart+this._getVar(this.scaleStartVar);this.scaleStart!==this.scaleEnd?(e.deltaScale=this.scaleEnd+this._getVar(this.scaleEndVar)-r,e.deltaScale/=e.life/1e3):e.deltaScale=0,e.scale.set(r),e.anchor.x=e.texture.width/2,e.anchor.y=e.texture.height/2,e.target.copy(this.target),this.addChild(e)}},_getVar:function(t){return Math.random()*t*(Math.random()>.5?-1:1)},_removeParticle:function(t){t.remove(),game.pool.put(this._poolName,t)}}),game.addAttributes("Particles",{poolName:"particle"}),game.createClass("Particle","Sprite",{accel:null,deltaScale:0,deltaAlpha:0,emitter:null,life:0,rotateAmount:0,target:null,velocity:null,velRotate:0,staticInit:function(t){this.super(t),this.accel=new game.Vector,this.target=new game.Vector,this.velocity=new game.Vector},_update:function(){if(this.emitter){if(this.life>0&&(this.life-=1e3*game.delta,this.life<=0))return this.emitter._removeParticle(this);if(this.emitter.targetForce>0){var t=this.emitter.targetUpdate?this.emitter.target:this.target;this.accel.set(t.x-this.position.x,t.y-this.position.y);var e=Math.sqrt(this.accel.x*this.accel.x+this.accel.y*this.accel.y);this.accel.x/=e||1,this.accel.y/=e||1,this.accel.x*=this.emitter.targetForce,this.accel.y*=this.emitter.targetForce}if(this.velocity.x+=this.accel.x*game.delta,this.velocity.y+=this.accel.y*game.delta,this.emitter.velocityLimit.x>0&&(this.velocity.x>this.emitter.velocityLimit.x&&(this.velocity.x=this.emitter.velocityLimit.x),this.velocity.x<-this.emitter.velocityLimit.x&&(this.velocity.x=-this.emitter.velocityLimit.x)),this.emitter.velocityLimit.y>0&&(this.velocity.y>this.emitter.velocityLimit.y&&(this.velocity.y=this.emitter.velocityLimit.y),this.velocity.y<-this.emitter.velocityLimit.y&&(this.velocity.y=-this.emitter.velocityLimit.y)),this.velRotate){var i=Math.cos(this.velRotate*game.delta),a=Math.sin(this.velRotate*game.delta),s=this.velocity.x*i-this.velocity.y*a,r=this.velocity.y*i+this.velocity.x*a;this.velocity.x=s,this.velocity.y=r}this.position.x+=this.velocity.x*game.delta,this.position.y+=this.velocity.y*game.delta,this.deltaAlpha&&(this.alpha=Math.max(0,this.alpha+this.deltaAlpha*game.delta)),this.deltaScale&&(this.scale.x+=this.deltaScale*game.delta,this.scale.y+=this.deltaScale*game.delta),this.rotateAmount&&(this.rotation+=this.rotateAmount*game.delta)}}})});game.module("engine.scene").body(function(){game.createClass("Scene",{backgroundColor:null,isMouseDown:!1,objects:[],paused:!1,physics:[],stage:null,timers:[],tweens:[],_backgroundColorRgb:null,_mouseDownTime:null,_mouseDownX:null,_mouseDownY:null,_pausedAnims:[],_pausedObjects:[],_pausedTimers:[],_pausedTweens:[],_updateOrder:[],staticInit:function(){this.backgroundColor=this.backgroundColor||game.Scene.backgroundColor,!this.backgroundColor&&game.device.cocoonCanvasPlus&&(this.backgroundColor="#000"),game.input&&game.input._reset(),game.keyboard&&game.keyboard._reset(),game.scene=this,this.stage=new game.Container,this.stage.stage=this.stage;for(var e=0;e<game.Scene.updateOrder.length;e++)this._updateOrder.push(game.Scene.updateOrder[e].ucfirst())},addObject:function(e){-1===this.objects.indexOf(e)&&(e._remove=!1,this.objects.push(e))},click:function(){},exit:function(){},keydown:function(){},keyup:function(){},mousedown:function(){},mousemove:function(){},mouseout:function(){},mouseup:function(){},onPause:function(){},onResize:function(){},onResume:function(){},pause:function(){if(!this.paused){this._pausedAnims.length=0,this._pausedObjects.length=0,this._pausedTimers.length=0,this._pausedTweens.length=0;for(var e=0;e<this.objects.length;e++)this._pausedObjects.push(this.objects[e]);for(e=0;e<this.timers.length;e++)this._pausedTimers.push(this.timers[e]);for(e=0;e<this.tweens.length;e++)this._pausedTweens.push(this.tweens[e]);this._getPausedAnims(),this.objects.length=0,this.timers.length=0,this.tweens.length=0,this.paused=!0,this.onPause()}},removeObject:function(e){e._remove=!0},removeTimer:function(e,s){e&&(s||(e.callback=null),e.repeat=!1,e.set(0))},removeTimers:function(e){for(var s=this.timers.length-1;s>=0;s--)this.removeTimer(this.timers[s],e)},removeTweens:function(){for(var e=0;e<this.tweens.length;e++)this.tweens[e]._shouldRemove=!0},resume:function(){if(this.paused){for(var e=0;e<this._pausedObjects.length;e++)this.objects.push(this._pausedObjects[e]);for(e=0;e<this._pausedTimers.length;e++)this.timers.push(this._pausedTimers[e]);for(e=0;e<this._pausedTweens.length;e++)this.tweens.push(this._pausedTweens[e]);this._pausedAnims.length=0,this.paused=!1,this.onResume()}},swipe:function(){},update:function(){},_exit:function(e){if(game.audio&&game.Audio.stopOnSceneChange){game.audio.stopMusic();for(var s=0;s<game.audio.sounds.length;s++)game.audio.sounds[s].stop(!0)}return this.exit(e)},_getPausedAnims:function(e){e=e||this.stage;for(var s=0;s<e.children.length;s++){var t=e.children[s];t instanceof game.Animation&&this._pausedAnims.push(t),t.children.length&&this._getPausedAnims(t)}},_mousedown:function(e,s,t,i){this.isMouseDown=!0,this._mouseDownTime=game.Timer.time,this._mouseDownX=e,this._mouseDownY=s,this.mousedown(e,s,t,i)},_mousemove:function(e,s,t,i){this.mousemove(e,s,t,i),this._mouseDownTime&&(e-this._mouseDownX>=game.Scene.swipeDist?this._swipe("RIGHT"):e-this._mouseDownX<=-game.Scene.swipeDist?this._swipe("LEFT"):s-this._mouseDownY>=game.Scene.swipeDist?this._swipe("DOWN"):s-this._mouseDownY<=-game.Scene.swipeDist&&this._swipe("UP"))},_mouseup:function(e,s,t,i){if(this.isMouseDown=!1,this._mouseDownTime){var n=game.Timer.time-this._mouseDownTime;(0===game.Input.clickTimeout||n<game.Input.clickTimeout)&&this.click(e,s,t,i)}this._mouseDownTime=null,this.mouseup(e,s,t,i)},_pause:function(){game.audio&&game.audio._systemPause()},_resume:function(){game.audio&&game.audio._systemResume()},_swipe:function(e){var s=game.Timer.time-this._mouseDownTime;this._mouseDownTime=null,(s<=game.Scene.swipeTime||0===game.Scene.swipeTime)&&this.swipe(e)},_update:function(){for(var e=0;e<this._updateOrder.length;e++)this["_update"+this._updateOrder[e]]()},_updateCollision:function(){if(!this.paused)for(var e=0;e<this.physics.length;e++)this.physics[e]._updateCollision()},_updateObjects:function(){for(var e=this.objects.length-1;e>=0;e--)"function"!=typeof this.objects[e].update||this.objects[e]._remove||this.objects[e].update(),this.objects[e]._remove&&this.objects.splice(e,1)},_updatePhysics:function(){if(!this.paused)for(var e=0;e<this.physics.length;e++)this.physics[e]._update()},_updateRenderer:function(){game.renderer&&game.renderer._render(this.stage)},_updateScene:function(){this.update()},_updateTimers:function(){for(var e=this.timers.length-1;e>=0;e--)0===this.timers[e].time()&&("function"==typeof this.timers[e].callback&&this.timers[e].callback(),this.timers[e].repeat?this.timers[e]._base=game.Timer.time:this.timers.splice(e,1))},_updateTweens:function(){for(var e=this.tweens.length-1;e>=0;e--)this.tweens[e]._update()||this.tweens.splice(e,1)}}),game.addAttributes("Scene",{backgroundColor:"#000",swipeDist:100,swipeTime:500,updateOrder:["physics","tweens","collision","timers","scene","objects","renderer"]})});game.module("engine.loader").require("engine.scene").body(function(){game.createClass("Loader","Scene",{loaded:0,percent:0,scene:null,started:!1,totalFiles:0,_error:null,_loadCount:0,_loadedFiles:[],_queue:[],staticInit:function(e){e&&(this.scene=e,this.super());for(var t=0;t<game.mediaQueue.length;t++)this._queue.push(game.mediaQueue[t]);return game.mediaQueue.length=0,this.totalFiles=this._queue.length,0===this.totalFiles&&(this.percent=100),e&&this.init(),!0},init:function(){if(this.backgroundColor=game.Loader.backgroundColor,game.Loader.showLogo&&(this.logo=new game.Sprite(game.logo),this.logo.anchorCenter(),this.logo.x=game.width/2,this.logo.y=game.height/2,this.logo.addTo(this.stage),this.logoTween=game.Tween.add(this.logo.scale,{x:1.1,y:1.1},500,{easing:"Quadratic.Out",repeat:1/0,yoyo:!0}).start()),game.Loader.showPercent){var e=20;this.percentText=new game.SystemText("",{size:e/game.scale,align:"center",color:game.Loader.textColor}),this.percentText.position.set(game.width/2,game.height/2-e/game.scale+7),this.percentText.addTo(this.stage)}game.Loader.text&&(this.loaderText=new game.SystemText(game.Loader.text,{size:14/game.scale,align:"center",color:game.Loader.textColor}),this.loaderText.position.set(game.width/2,game.height-e/game.scale),this.loaderText.addTo(this.stage)),this.onProgress()},generateFont:function(e,t){game.Font.fromData(e),t()},loadAtlas:function(e,t){this.loadFile(e,this.parseJSON.bind(this,e,t))},loadAudio:function(e,t){game.Audio.enabled?game.audio._load(e,t):t()},loadCSS:function(e,t){this.loadFile(e,this.parseCSS.bind(this,e,t))},loadFile:function(e,t){var a=new XMLHttpRequest;game.device.WKWebView?a.addEventListener("loadend",t.bind(this,a)):(a.onload=t.bind(this,a),a.onerror=this._progress.bind(this,"Error loading file "+e)),a.open("GET",e),a.send()},loadFont:function(e,t){this.loadFile(e,this.parseFont.bind(this,e,t))},loadImage:function(e,t){game.BaseTexture.fromImage(e,function(e){e?t(e):(game.Loader.preRender&&game.renderer.context.drawImage(this.source,0,0),t())})},loadJSON:function(e,t){this.loadFile(e,this.parseJSON.bind(this,e,t))},loadScript:function(e,t){var a=document.createElement("script");a.type="text/javascript",a.src=e,a.onload=function(){t()},a.onerror=function(a){t("Error loading script "+e)},document.getElementsByTagName("head")[0].appendChild(a)},onComplete:function(){this.scene&&game.system.setScene(this.scene)},onError:function(e){throw this.logoTween&&this.logoTween.stop(),this.percentText&&(this.percentText.color=game.Loader.errorColor),this.loaderText&&(this.loaderText.color=game.Loader.errorColor,this.loaderText.text=e),e},onProgress:function(){this.percentText&&(this.percentText.text=this.percent+"%")},onStart:function(){},parseAtlas:function(e,t){var a=game._getFilePath(e.meta.image),s=game.BaseTexture.fromImage(a),i=e.frames;for(var o in i){var r=i[o].frame||i[o],n=r.x/game.scale,l=r.y/game.scale,g=r.w/game.scale,h=r.h/game.scale,d=new game.Texture(s,n,l,g,h);r.sx&&(d._offset.x=r.sx),r.sy&&(d._offset.y=r.sy),r.sw&&(d._trim.x=r.sw),r.sh&&(d._trim.y=r.sh),r.ax&&(d._anchor.x=r.ax),r.ay&&(d._anchor.y=r.ay),game.Texture.cache[o]=d}t()},parseCSS:function(e,t,a){a.responseText&&404!==a.status||t("Error loading CSS "+e);var s=document.createElement("style");s.type="text/css",s.innerHTML=a.responseText,document.getElementsByTagName("head")[0].appendChild(s),t()},parseFont:function(e,t,a){a.responseText&&404!==a.status||t("Error loading font "+e);var s=a.responseText.split("\n");if(-1!==s[0].indexOf("xml")||-1!==s[0].indexOf("<font>")){var i=a.responseXML;if(!i||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)if("function"==typeof window.DOMParser){i=(new DOMParser).parseFromString(a.responseText,"text/xml")}else{var o=document.createElement("div");o.innerHTML=a.responseText,i=o}var r=i.getElementsByTagName("page");if(r.length){var n=this._getFolder(e),l=this._getFilePath(r[0].getAttribute("file"));r[0].setAttribute("file",n+l);var g=game._getFilePath(n+l);this.loadImage(g,this.generateFont.bind(this,i,t))}}else{l={pages:[],chars:[],kernings:[]};for(var h=0;h<s.length;h++)if(0!==s[h].length){var d=s[h].split(" "),m=d.shift();if("char"===m||"kerning"===m||"page"===m){for(var c={},u=0;u<d.length;u++){c[(f=d[u].split("="))[0]]=f[1].replace(/['"]+/g,"")}l[m+"s"].push(c)}else if("chars"!==m&&"kernings"!==m){l[m]={};for(u=0;u<d.length;u++){var f=d[u].split("=");l[m][f[0]]=f[1].replace(/['"]+/g,"")}}}l.pages[0].file=this._getFilePath(l.pages[0].file);n=this._getFolder(e),g=game._getFilePath(n+l.pages[0].file);this.loadImage(g,this.generateFont.bind(this,l,t))}},parseJSON:function(e,t,a){a.responseText&&404!==a.status||t("Error loading JSON "+e);try{var s=JSON.parse(a.responseText)}catch(e){return void t(e)}if(game.json[e]=s,s.frames){s.meta.image=this._getFolder(e)+s.meta.image;var i=game._getFilePath(s.meta.image);this.loadImage(i,this.parseAtlas.bind(this,s,t))}else t()},start:function(){this.started=!0,this._startTime=game.Timer.time,this.onStart(),100===this.percent?this._complete():this._startLoading()},_complete:function(){if(this.totalFiles>0&&game.scale>1){for(var e in game.BaseTexture.cache)e.indexOf("@"+game.scale+"x")>=0&&(game.BaseTexture.cache[e.replace("@"+game.scale+"x","")]=game.BaseTexture.cache[e],delete game.BaseTexture.cache[e]);for(var e in game.Texture.cache)e.indexOf("@"+game.scale+"x")>=0&&(game.Texture.cache[e.replace("@"+game.scale+"x","")]=game.Texture.cache[e],delete game.Texture.cache[e])}var t=game.Loader.minTime-(game.Timer.time-this._startTime);t>0?game.Timer.add(t,this.onComplete.bind(this)):this.onComplete()},_getFilePath:function(e){return e.indexOf("@"+game.scale+"x.")>=0||e.indexOf(".svg")>=0?e:game.scale>1?e.replace(/\.(?=[^.]*$)/,"@"+game.scale+"x."):e},_getFolder:function(e){var t=e.substr((game.config.mediaFolder+"/").length);return t=t.substr(0,t.lastIndexOf("/")+1)},_progress:function(e){if(e)return this._error=e,this.onError(e);this._loadCount--,this.loaded++,this.percent=Math.round(this.loaded/this.totalFiles*100),this.onProgress(),this.loaded===this.totalFiles?this._complete():this._startLoading()},_startLoading:function(){this._queue.reverse();for(var e=this._queue.length-1;e>=0;e--){var t=this._queue[e];if(t){var a=t.split("?").shift().split(".").pop().toLowerCase(),s=game.Loader.formats[a];if(!this[s])for(e=game.Audio.formats.length-1;e>=0;e--)a!==game.Audio.formats[e].ext||(s="loadAudio");if("loadImage"!==s&&"loadAtlas"!==s&&"loadFont"!==s||(t=this._getFilePath(t)),this._loadCount++,this._queue.splice(e,1),this._loadedFiles.push(t),this[s]?this[s](t,this._progress.bind(this)):this.onError("Unsupported file format "+a),this._loadCount===game.Loader.maxFiles)return}}},_update:function(){this.super(),this.scene&&!this.started&&this.start()}}),game.addAttributes("Loader",{backgroundColor:"#000",errorColor:"#ff0000",formats:{atlas:"loadAtlas",css:"loadCSS",png:"loadImage",jpg:"loadImage",jpeg:"loadImage",js:"loadScript",json:"loadJSON",fnt:"loadFont",svg:"loadImage"},maxFiles:4,minTime:500,preRender:!1,showLogo:!0,showPercent:!0,text:"Made with Panda 2 - www.panda2.io",textColor:"#fff"})});game.module("engine.input").body(function(){game.createClass("Input",{items:[],motion:null,mouse:null,touches:[],_currentCursor:null,_mouseDownItem:null,_mouseDownTime:null,_mouseMoveItem:null,_mouseUpItem:null,_needUpdate:!1,init:function(e){this.mouse=new game.Vector;var t=game.device.cocoonCanvasPlus?window:e;t.addEventListener("touchstart",this._touchstart.bind(this)),t.addEventListener("touchmove",this._touchmove.bind(this)),t.addEventListener("touchend",this._touchend.bind(this)),t.addEventListener("touchcancel",this._touchend.bind(this)),t.addEventListener("mousedown",this._mousedown.bind(this)),t.addEventListener("mousemove",this._mousemove.bind(this)),t.addEventListener("mouseout",this._mouseout.bind(this)),window.addEventListener("blur",this._mouseout.bind(this)),window.addEventListener("mouseup",this._mouseup.bind(this)),game.device.mobile&&window.addEventListener("devicemotion",this._devicemotion.bind(this))},_calculateXY:function(e){var t=game.renderer.canvas.getBoundingClientRect(),s=(e.clientX-t.left)*(game.renderer.canvas.width/t.width),n=(e.clientY-t.top)*(game.renderer.canvas.height/t.height);e.canvasX=s/game.scale,e.canvasY=n/game.scale},_devicemotion:function(e){this.motion=e},_hitTest:function(e,t,s){var n=e.hitArea;if(n){var i=e._worldTransform,o=e._getBounds(),a=o.x||i.tx,u=o.y||i.ty,m=Math.abs(i.a/e._cosCache),h=Math.abs(i.d/e._cosCache),c=e.anchor.x/e.width||0,r=e.anchor.y/e.height||0,d=a+n.x*m,v=u+n.y*h;if(d+=o.width*m*c,v+=o.height*h*r,n.radius){var _=n.radius/2,l=t-(d+=_),f=s-(v+=_);return Math.sqrt(l*l+f*f)<_}var g=n.width*m,p=n.height*h}else d=(n=e._getBounds()).x,v=n.y,g=n.width,p=n.height;return t>=d&&s>=v&&t<=d+g&&s<=v+p},_mousedown:function(e){game.Input.focusOnMouseDown&&(window.focus(),game.renderer.canvas.focus()),game.scene&&(this._preventDefault(e),this._calculateXY(e),this.mouse.set(e.canvasX,e.canvasY),this._mouseDownItem=this._processEvent("mousedown",e),this._mouseDownTime=game.Timer.time,game.scene._mousedown(e.canvasX,e.canvasY,e.identifier,e))},_mousemove:function(e){if(game.scene){this._preventDefault(e),this._calculateXY(e),this.mouse.set(e.canvasX,e.canvasY);var t=this._processEvent("mousemove",e);this._updateCursor(t),this._mouseMoveItem&&this._mouseMoveItem!==t&&this._mouseMoveItem.mouseout(e.canvasX,e.canvasY,e.identifier,e),t&&this._mouseMoveItem!==t&&t.mouseover(e.canvasX,e.canvasY,e.identifier,e),this._mouseMoveItem=t,game.scene._mousemove(e.canvasX,e.canvasY,e.identifier,e)}},_mouseout:function(e){game.scene&&(this._mouseMoveItem&&this._mouseMoveItem.mouseout(e.canvasX,e.canvasY,e.identifier,e),this._mouseMoveItem=null,game.scene.mouseout(e))},_mouseup:function(e){if(game.scene){if(this._preventDefault(e),this._calculateXY(e),e.canvasX<0||e.canvasX>game.width||e.canvasY<0||e.canvasY>game.height)return this._mouseDownItem&&this._mouseDownItem.mouseupoutside(e.canvasX,e.canvasY,e.identifier,e),void game.scene._mouseup(e.canvasX,e.canvasY,e.identifier,e);if(this.mouse.set(e.canvasX,e.canvasY),this._mouseUpItem=this._processEvent("mouseup",e),this._mouseDownItem&&this._mouseDownItem===this._mouseUpItem){var t=game.Timer.time-this._mouseDownTime;(0===game.Input.clickTimeout||t<game.Input.clickTimeout)&&this._mouseDownItem.click(e.canvasX,e.canvasY,e.identifier,e)}this._mouseDownItem&&this._mouseDownItem!==this._mouseUpItem&&this._mouseDownItem.mouseupoutside(e.canvasX,e.canvasY,e.identifier,e),game.scene._mouseup(e.canvasX,e.canvasY,e.identifier,e)}},_preventDefault:function(e){e.preventDefault&&game.Input.preventDefault&&e.preventDefault()},_processEvent:function(e,t){for(var s=this.items.length-1;s>=0;s--){var n=this.items[s];if(n._interactive&&n.visible&&(this._hitTest(n,t.canvasX,t.canvasY)&&!n[e](t.canvasX,t.canvasY,t.identifier,t)))return n}},_reset:function(){this.items.length=0,this._mouseDownItem=null,this._mouseMoveItem=null,this._mouseUpItem=null},_touchend:function(e){this._preventDefault(e);for(var t=0;t<e.changedTouches.length;t++){var s=e.changedTouches[t];-1!==this.touches.indexOf(s.identifier)&&(this._mouseup(s),this.touches.erase(s.identifier))}},_touchmove:function(e){this._preventDefault(e);for(var t=0;t<e.changedTouches.length;t++){var s=e.changedTouches[t];-1!==this.touches.indexOf(s.identifier)&&this._mousemove(s)}},_touchstart:function(e){this._preventDefault(e);for(var t=0;t<e.changedTouches.length;t++){if(1===this.touches.length&&!game.Input.multitouch)return;var s=e.changedTouches[t];this.touches.push(s.identifier),this._mousedown(s)}},_update:function(){this._needUpdate&&(this.items.length=0,this._updateItems(game.scene.stage),this._needUpdate=!1)},_updateCursor:function(e){if(!game.device.mobile){var t="inherit";e&&e.buttonMode&&(t=game.Input.buttonModeCursor),this._currentCursor!==t&&(this._currentCursor=t,game.renderer.canvas.style.cursor=this._currentCursor)}},_updateItems:function(e){for(var t=0;t<e.children.length;t++){var s=e.children[t];s._interactive&&this.items.push(s),s.children.length&&this._updateItems(s)}}}),game.addAttributes("Input",{buttonModeCursor:"pointer",clickTimeout:500,focusOnMouseDown:!0,multitouch:!0,preventDefault:!0}),game.createClass("Keyboard",{_keysDown:[],init:function(){window.addEventListener("keydown",this._keydown.bind(this)),window.addEventListener("keyup",this._keyup.bind(this)),window.addEventListener("blur",this._reset.bind(this))},down:function(e){return!!this._keysDown[e.toUpperCase()]},_keydown:function(e){if((document.activeElement===document.body||document.activeElement===game.renderer.canvas)&&game.system._running){game.Keyboard.preventDefault&&e.preventDefault();var t=game.Keyboard.keys[e.keyCode];if(t||(t=e.keyCode),this._keysDown[t])e.preventDefault();else if(this._keysDown[t]=!0,game.scene&&game.scene.keydown)game.scene.keydown(t,this.down("SHIFT"),this.down("CTRL"),this.down("ALT"))&&e.preventDefault()}},_keyup:function(e){if(game.system._running){var t=game.Keyboard.keys[e.keyCode];t||(t=e.keyCode),this._keysDown[t]=!1,game.scene&&game.scene.keyup&&game.scene.keyup(t)}},_reset:function(){for(var e in this._keysDown)this._keysDown[e]=!1}}),game.addAttributes("Keyboard",{keys:{8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",17:"CTRL",18:"ALT",19:"PAUSE",20:"CAPS_LOCK",27:"ESC",32:"SPACE",33:"PAGE_UP",34:"PAGE_DOWN",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",44:"PRINT_SCREEN",45:"INSERT",46:"DELETE",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"NUM_ZERO",97:"NUM_ONE",98:"NUM_TWO",99:"NUM_THREE",100:"NUM_FOUR",101:"NUM_FIVE",102:"NUM_SIX",103:"NUM_SEVEN",104:"NUM_EIGHT",105:"NUM_NINE",106:"NUM_MULTIPLY",107:"NUM_PLUS",109:"NUM_MINUS",110:"NUM_PERIOD",111:"NUM_DIVISION",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",186:"SEMICOLON",187:"PLUS",189:"MINUS",192:"GRAVE_ACCENT",222:"SINGLE_QUOTE"},preventDefault:!1})});game.module("engine.geometry").body(function(){game.createClass("Arc",{endAngle:0,radius:0,startAngle:0,x:0,y:0,staticInit:function(t,i,s,n,e){this.startAngle=n||this.startAngle,this.endAngle=e||this.endAngle,this.radius=t||this.radius,this.x=i||this.x,this.y=s||this.y}}),game.createClass("Circle",{radius:0,x:0,y:0,staticInit:function(t,i,s){this.radius=t||this.radius,this.x=i||this.x,this.y=s||this.y}}),game.createClass("Polygon",{points:[],staticInit:function(t){if(t)for(var i=0;i<t.length;i++)t[i]instanceof game.Vector?this.points.push(t[i]):(this.points.push(new game.Vector(t[i],t[i+1])),i++)},close:function(){this.points[0]!==this.points[this.points.length-1]&&this.points.push(this.points[0])}}),game.createClass("Rectangle",{height:0,width:0,x:0,y:0,staticInit:function(t,i,s,n){this.set(t,i,s,n)},set:function(t,i,s,n){this.width="number"==typeof t?t:this.width,this.height="number"==typeof i?i:this.width,this.x="number"==typeof s?s:this.x,this.y="number"==typeof n?n:this.y},swap:function(){var t=this.height;this.height=this.width,this.width=t}}),game.createClass("Vector",{x:0,y:0,staticInit:function(t,i){this.set(t,i)},add:function(t,i){return this.x+=t instanceof game.Vector?t.x:t,this.y+=t instanceof game.Vector?t.y:i||(0!==i?t:0),this},angle:function(t){return t instanceof game.Vector?Math.atan2(t.y-this.y,t.x-this.x):Math.atan2(this.y,this.x)},angleFromOrigin:function(t){return Math.atan2(t.y,t.x)-Math.atan2(this.y,this.x)},clone:function(){return new this.constructor(this.x,this.y)},compare:function(t){return this.x===t.x&&this.y===t.y},copy:function(t){return this.x=t.x,this.y=t.y,this},distance:function(t,i){var s=t instanceof game.Vector?t.x:t,n=t instanceof game.Vector?t.y:i||(0!==i?t:0);return s-=this.x,n-=this.y,Math.sqrt(s*s+n*n)},divide:function(t,i){return this.x/=t instanceof game.Vector?t.x:t,this.y/=t instanceof game.Vector?t.y:i||(0!==i?t:0),this},dot:function(t){return t instanceof game.Vector?this.x*t.x+this.y*t.y:this.x*this.x+this.y*this.y},dotNormalized:function(t){var i=this.length(),s=this.x/i,n=this.y/i;if(t instanceof game.Vector){var e=t.length();return s*(t.x/e)+n*(t.y/e)}return s*s+n*n},length:function(){return Math.sqrt(this.dot())},limit:function(t){return this.x=this.x.limit(-t.x,t.x),this.y=this.y.limit(-t.y,t.y),this},move:function(t,i){i instanceof game.Vector&&(i=this.angle(i)),this.x+=t*Math.cos(i),this.y+=t*Math.sin(i)},multiply:function(t,i){return this.x*=t instanceof game.Vector?t.x:t,this.y*=t instanceof game.Vector?t.y:i||(0!==i?t:0),this},multiplyAdd:function(t,i){return this.x+=t instanceof game.Vector?t.x*i:t*i,this.y+=t instanceof game.Vector?t.y*i:t*i,this},normalize:function(){var t=this.length();return this.x/=t||1,this.y/=t||1,this},rotate:function(t){var i=Math.cos(t),s=Math.sin(t),n=this.x*i-this.y*s,e=this.y*i+this.x*s;return this.x=n,this.y=e,this},round:function(t){return this.x=this.x.round(t),this.y=this.y.round(t),this},set:function(t,i){return this.x="number"==typeof t?t:this.x,this.y="number"==typeof i?i:this.x,this},subtract:function(t,i){return this.x-=t instanceof game.Vector?t.x:t,this.y-=t instanceof game.Vector?t.y:i||(0!==i?t:0),this},swap:function(t){var i=this.x,s=this.y;this.copy(t),t.set(i,s)}})});game.module("engine.camera").body(function(){game.createClass("Camera",{acceleration:3,limit:null,maxSpeed:200,offset:null,position:null,rounding:!0,sensorPosition:null,sensorSize:null,speed:null,threshold:1,_container:null,_target:null,staticInit:function(t){this.limit=new game.Rectangle(1/0,1/0,-1/0,-1/0),this.position=new game.Vector,this.speed=new game.Vector,this.offset=new game.Vector(game.width/2,game.height/2),this.sensorPosition=new game.Vector(this.offset.x,this.offset.y),this.sensorSize=new game.Vector(200),t&&this.setTarget(t)},addTo:function(t){return this._container=t,this._container.position.set(-this.position.x,-this.position.y),this._setSensorPosition(),this},setTarget:function(t){this._target=t,this._setSensorPosition()},setPosition:function(t,i){(t instanceof game.Vector||t instanceof game.Container)&&(i=t.y,t=t.x),this._container&&(t*=this._container.scale.x,i*=this._container.scale.y),this._setPosition(t,i)},update:function(){this._moveSensor(),this._moveCamera()},_moveCamera:function(){this.speed.x=(this.position.x-this.sensorPosition.x+this.offset.x).limit(-this.maxSpeed,this.maxSpeed),this.speed.y=(this.position.y-this.sensorPosition.y+this.offset.y).limit(-this.maxSpeed,this.maxSpeed),this.speed.x>this.threshold||this.speed.x<-this.threshold||this.speed.y>this.threshold||this.speed.y<-this.threshold?this._setPosition(this.position.x+this.offset.x-this.speed.x*this.acceleration*game.delta,this.position.y+this.offset.y-this.speed.y*this.acceleration*game.delta):this.speed.set(0,0)},_moveSensor:function(){if(this._target&&this._container){var t=this._target.width*this._container.scale.x,i=this._target.height*this._container.scale.y,s=(this._target.position.x-this._target.anchor.x+this._target.width/2*this._target.scale.x)*this._container.scale.x,e=(this._target.position.y-this._target.anchor.y+this._target.height/2*this._target.scale.y)*this._container.scale.y;(this.sensorSize.x<t||this.sensorSize.y<i)&&this.sensorSize.set(t,i),s<this.sensorPosition.x-this.sensorSize.x/2+t/2?this.sensorPosition.x=s+this.sensorSize.x/2-t/2:s+(this.sensorSize.x/2+t/2)>this.sensorPosition.x+this.sensorSize.x&&(this.sensorPosition.x=s+(this.sensorSize.x/2+t/2)-this.sensorSize.x),e<this.sensorPosition.y-this.sensorSize.y/2+i/2?this.sensorPosition.y=e+this.sensorSize.y/2-i/2:e+(this.sensorSize.y/2+i/2)>this.sensorPosition.y+this.sensorSize.y&&(this.sensorPosition.y=e+(this.sensorSize.y/2+i/2)-this.sensorSize.y)}},_setPosition:function(t,i){this.position.set(t-this.offset.x,i-this.offset.y),this.position.x<this.limit.x?(this.position.x=this.limit.x,this.speed.x=0):this.position.x>this.limit.width&&(this.position.x=this.limit.width,this.speed.x=0),this.position.y<this.limit.y?(this.position.y=this.limit.y,this.speed.y=0):this.position.y>this.limit.height&&(this.position.y=this.limit.height,this.speed.y=0),this._container&&(this._container.position.x=-(this.rounding?this.position.x+.5|0:this.position.x),this._container.position.y=-(this.rounding?this.position.y+.5|0:this.position.y))},_setSensorPosition:function(){if(this._target&&this._container){var t=(this._target.position.x-this._target.anchor.x+this._target.width/2*this._target.scale.x)*this._container.scale.x,i=(this._target.position.y-this._target.anchor.y+this._target.height/2*this._target.scale.y)*this._container.scale.y;this.sensorPosition.set(t,i)}}})});game.module("engine.audio").body(function(){game.createClass("Audio",{formats:[],music:null,muted:!1,sounds:[],_context:null,_mainGain:null,_musicGain:null,_pauseMusic:null,_pauseSounds:[],_soundGain:null,staticInit:function(){if(game.Audio.enabled){game._normalizeVendorAttribute(window,"AudioContext");for(var t=new Audio,e=0;e<game.Audio.formats.length;e++)t.canPlayType(game.Audio.formats[e].type)&&this.formats.push(game.Audio.formats[e].ext);this.formats.length?window.AudioContext&&(this._context=new AudioContext({latencyHint:"interactive"}),this._mainGain=this._context.createGain(),this._mainGain.connect(this._context.destination),this._musicGain=this._context.createGain(),this._musicGain.gain.setValueAtTime(game.Audio.musicVolume,this._context.currentTime),this._musicGain.connect(this._mainGain),this._soundGain=this._context.createGain(),this._soundGain.gain.setValueAtTime(game.Audio.soundVolume,this._context.currentTime),this._soundGain.connect(this._mainGain)):game.Audio.enabled=!1}},mute:function(){this._mainGain&&(this._mainGain.gain.setValueAtTime(0,this._context.currentTime),this.muted=!0)},playMusic:function(t){return new game.Music(t).play()},playSound:function(t,e,i){var s=new game.Sound(t);return s.volume=e||s.volume,s.rate=i||s._rate,s.play(),s},stopAll:function(){this.stopMusic();for(var t=0;t<this.sounds.length;t++)this.sounds[t].stop()},stopMusic:function(){this.music&&this.music.stop(),this.music=null},toggle:function(){return this.muted?this.unmute():this.mute(),this.muted},unmute:function(){this._mainGain&&(this._mainGain.gain.setValueAtTime(1,this._context.currentTime),this.muted=!1)},_decode:function(t,e,i){this._context.decodeAudioData(t.response,this._loaded.bind(this,e,i),this._error.bind(this,e,i))},_error:function(t,e){e("Error loading audio "+t)},_load:function(t,e){if(game.Audio.enabled){var i=t.split("?").shift().split(".").pop();-1===this.formats.indexOf(i)&&(i=this.formats[0]);var s=t.replace(/[^\.]+$/,i+game._nocache);if(window.AudioContext){var n=new XMLHttpRequest;n.open("GET",s,!0),n.responseType="arraybuffer",n.onload=this._decode.bind(this,n,t,e),n.send()}else{var o=new Audio;o.src=s,this._loaded(t,e,o)}}else e()},_loaded:function(t,e,i){var s=game._getId(t);game.Audio.cache[s]=i,e()},_systemPause:function(){this.music&&this.music.playing&&(this.music.pause(),this._pauseMusic=this.music);for(var t=0;t<this.sounds.length;t++)this.sounds[t].playing&&(this.sounds[t].pause(),this._pauseSounds.push(this.sounds[t]))},_systemResume:function(){this._pauseMusic&&this._pauseMusic.resume();for(var t=0;t<this._pauseSounds.length;t++)this._pauseSounds[t].resume();this._pauseMusic=null,this._pauseSounds.length=0}}),game.addAttributes("Audio",{cache:{},clearCache:function(){for(var t in this.cache)delete this.cache[t]},enabled:!0,formats:[{ext:"ogg",type:'audio/ogg; codecs="vorbis"'},{ext:"m4a",type:'audio/mp4; codecs="mp4a.40.5"'},{ext:"wav",type:"audio/wav"}],loopEnd:0,loopStart:0,musicVolume:1,soundVolume:1,stopOnSceneChange:!0}),game.createClass("Sound",{loop:!1,muted:!1,onComplete:null,paused:!1,playing:!1,_buffer:null,_context:null,_gainNode:null,_rate:1,_source:null,_volume:1,staticInit:function(t){if(!game.Audio.enabled)return!0;if(this._buffer=game.Audio.cache[t],!this._buffer)throw"Audio "+t+" not found";window.AudioContext&&(this._context=game.audio._context,this._gainNode=this._context.createGain())},init:function(){this._gainNode&&this._gainNode.connect(game.audio._soundGain),this.volume=game.Audio.soundVolume},fadeIn:function(t){this._fade(t,this.volume)},fadeOut:function(t){this._fade(t,0)},mute:function(){this._gainNode?this._gainNode.gain.setValueAtTime(0,this._context.currentTime):this._source.volume=0,this.muted=!0},pause:function(){this._source&&(this.paused||this.playing&&(this.stop(),this.paused=!0,this._source.pauseTime=(this._context.currentTime-this._source.startTime)%this._buffer.duration))},play:function(t,e,i){if(this._buffer)return this._onStart(),this.playing=!0,t=t||0,e=e||0,i=i||this._buffer.duration-e,this._context?this._source=this._context.createBufferSource():this._source=this._buffer,this._source.buffer=this._buffer,this._source.loop=this.loop,this._source.playbackRate&&this._source.playbackRate.setValueAtTime(this.rate,this._context.currentTime),this._source.onended=this._onComplete.bind(this),this._source.connect&&(this._source.connect(this._gainNode),this._source.startTime=this._context.currentTime-e),this._context?this.loop?(this._source.loopStart=game.Audio.loopStart,this._source.loopEnd=this._source.buffer.duration-game.Audio.loopEnd,this._source.start(this._context.currentTime+t,e)):this._source.start(this._context.currentTime+t,e,i):(this._source.volume=this.volume,this._source.currentTime=0,this._source.play()),this},resume:function(){this._source&&this.paused&&(this.paused=!1,this._source.pauseTime&&this.play(0,this._source.pauseTime))},stop:function(t){this._source&&(this.paused||(this.playing=!1,t&&(this.onComplete=null),this._context?"number"==typeof this._source.playbackState&&2!==this._source.playbackState||this._source.stop():this._source.pause()))},unmute:function(){this._gainNode?this._gainNode.gain.setValueAtTime(this._volume,this._context.currentTime):this._source.volume=this._volume,this.muted=!1},_fade:function(t,e){if(this._buffer){t=(t||1e3)/1e3;var i=this._context.currentTime;e===this.volume&&this._gainNode.gain.setValueAtTime(0,this._context.currentTime);var s=this._gainNode.gain.value;this._gainNode.gain.linearRampToValueAtTime(s,i),this._gainNode.gain.linearRampToValueAtTime(e,i+t)}},_onComplete:function(){game.audio.sounds.erase(this),this.paused||"function"==typeof this.onComplete&&this.onComplete()},_onStart:function(){this.stop(),game.audio.sounds.push(this)}}),game.defineProperties("Sound",{rate:{get:function(){return this._rate},set:function(t){this._rate=t,this._source&&(this._source.playbackRate.value=t)}},volume:{get:function(){return this._volume},set:function(t){this._volume=t,this._gainNode&&this._gainNode.gain.setValueAtTime(t,this._context.currentTime)}}}),game.createClass("Music","Sound",{loop:!0,init:function(){this._gainNode&&this._gainNode.connect(game.audio._musicGain),this.volume=game.Audio.musicVolume},_onStart:function(){game.audio.music&&game.audio.music.stop(),game.audio.music=this}})});game.config={"audio":{"stopOnSceneChange":false},"system":{"width":768,"height":1024,"scale":true,"center":true,"rotateScreen":false,"resize":false,"startScene":"Preloading","loader":"myLoader"},"renderer":{"roundPixels":true,"scaleMode":"linear"},"ignoreModules":["engine.debug"]};game.module("game.player").require("game.common").body(function(){game.createClass("Player",{jumpPower:1e3,init:function(i,t){this.runSpeed=FR_SPEED;var s=1;game.selectIdx&&(s=game.selectIdx);var e="player"+s+".png",o=new game.SpriteSheet(e,128,128);this.sprite=new game.Animation(o.textures),this.sprite.addAnim("stand",[0,0,11,0,12,12],{speed:5,loop:!0}),this.sprite.addAnim("run",[0,1,2,3,0,4,5,6],{speed:12,loop:!0}),this.sprite.addAnim("jump",[7,8],{speed:6,loop:!1}),this.sprite.addAnim("jump1",[9,10],{speed:6,loop:!1}),this.sprite.addAnim("feedback",[0,13,14,15,16,15,16],{speed:6,loop:!1}),this.sprite.addAnim("victory",[17,18,19,17],{speed:6,loop:!0}),this.sprite.anchorCenter(),this.sprite.position.set(i,t),this.sprite.speed=10,this.sprite.play("jump"),this.body=new game.Body,this.body.position.set(i,t),this.body.collideAgainst.push(0),this.body.collideAgainst.push(1),this.body.collideAgainst.push(99);var h=new game.Rectangle(.5*o.width,.9*o.height-10);this.body.addShape(h),FR_PASSTROUGH&&(this.body.mass=0),this.body.addTo(game.scene.world),this.body.collide=this.collide.bind(this),this.onGround=!1,this.alive=!0,this.jumps=0,this.prevPosX=this.sprite.x,this.won=!1},collide:function(i,t){if(99==i.collisionGroup){if(this.alive=!1,!this.onGround&&("UP"===t||"DOWN"===t)){var s=this.body.last.x+this.body.shape.width/2,e=this.body.last.x-this.body.shape.width/2,o=i.last.x+i.shape.width/2;if(s<=i.last.x-i.shape.width/2)return this.body.position.x=i.position.x-i.shape.width/2-this.body.shape.width/2,!1;if(e>=o)return this.body.position.x=i.position.x+i.shape.width/2+this.body.shape.width/2,!1}return"DOWN"!==t&&"UP"!==t||(this.body.velocity.y=0),"DOWN"===t&&(this.onGround||this.play("stand"),this.onGround=!0,this.jumps=0),!0}if(0==i.collisionGroup){if(!this.onGround&&("UP"===t||"DOWN"===t)){s=this.body.last.x+this.body.shape.width/2,e=this.body.last.x-this.body.shape.width/2,o=i.last.x+i.shape.width/2;if(s<=i.last.x-i.shape.width/2)return this.body.position.x=i.position.x-i.shape.width/2-this.body.shape.width/2,!1;if(e>=o)return this.body.position.x=i.position.x+i.shape.width/2+this.body.shape.width/2,!1}return"DOWN"!==t&&"UP"!==t||(this.body.velocity.y=0),"DOWN"===t&&(this.onGround||this.play("stand"),this.onGround=!0,this.jumps=0),!0}this.collideWithObj(i)},addValidation:function(i){var t={};t.t=GetTimestamp(),t.id=i.gid-2,t.b=i.bidd,t.x=i.objx,t.y=i.objy,FR_VALIDATION_TOKEN.push(t)},collideWithObj:function(i){2==i.gid&&(game.scene.starVfx(i.position.x,i.position.y),game.scene.maxTime+=FR_TIMEBONUS,FR_TIMESSTARS++,PlaySound(SOUND_STAR),this.addValidation(i)),3==i.gid&&(game.scene.packVfx(i.position.x,i.position.y,0),game.scene.points++,PlaySound(SOUND_PACK),this.addValidation(i)),4==i.gid&&(game.scene.packVfx(i.position.x,i.position.y,1),game.scene.points+=5,PlaySound(SOUND_PACK),this.addValidation(i)),5==i.gid&&(game.scene.packVfx(i.position.x,i.position.y,2),game.scene.points+=10,PlaySound(SOUND_PACK),this.addValidation(i)),99==i.gid&&(this.alive=!1);var t=i.sprite;game.scene.removeFromLists(i),t.remove(),i.remove()},jump:function(){this.alive&&(this.jumps>1||(this.jumps++,this.body.velocity.y=-this.jumpPower,this.onGround=!1,1==this.jumps?(this.play("jump"),PlaySound(SOUND_JUMP1),game.scene.jumpVfx&&game.scene.jumpVfx(this.sprite.position.x,this.sprite.position.y)):(this.play("jump1"),PlaySound(SOUND_JUMP2),game.scene.jumpVfx1&&game.scene.jumpVfx1(this.sprite.position.x+32,this.sprite.position.y+64))))},play:function(i){this.sprite.currentAnim!==this.sprite.anims[i]&&this.sprite.play(i)},die:function(){if(null!=game.scene.block){var i=game.scene.block;i.isInside(this.sprite.x)||(i=game.scene.previousBlock);var t=i.tilemap.tileWidth,s=i.tilemap.tileHeight,e=~~((this.sprite.x-i.startingx)/t),o=i.blockSafe[e]*s-64;this.body.position.y=o,this.sprite.y=o,this.jumps=0,this.respawn=10,game.scene.maxTime-=FR_TIMEMALUS}},update:function(){if(!this.won&&this.onGround?0===this.body.velocity.x?this.play("stand"):this.play("run"):1==this.won&&this.play("victory"),game.scene.loading)return this.body.velocity.y=0,void(this.body.velocity.x=0);this.respawn>0&&this.respawn--,this.prevPosX=this.sprite.x,this.body.velocity.y>0&&this.onGround&&(this.onGround=!1,this.play("jump")),game.scene.player.sprite.y>FR_DIELEVEL&&(this.die(),FR_TIMESFALLEN+=1),this.alive?this.body.velocity.x=.95*this.runSpeed+Math.random()*this.runSpeed*.05:this.body.velocity.x=0,this.sprite.position.x=this.body.position.x,this.sprite.position.y=this.body.position.y}})});game.module("game.preloading").require("game.common").body(function(){game.createScene("Preloading",{backgroundColor:BACKGROUND_COLOR,init:function(){game.gnames=[],game.gnames.push("Szczesny"),game.gnames.push("Pinsolgio"),game.gnames.push("Perin"),game.gnames.push("De Sciglio"),game.gnames.push("Chiellini"),game.gnames.push("Benatia"),game.gnames.push("Alex sandro"),game.gnames.push("Barzagli"),game.gnames.push("Bonucci"),game.gnames.push("Cancelo"),game.gnames.push("Rugani"),game.gnames.push("Spiazzola"),game.gnames.push("Pjanic"),game.gnames.push("Khedira"),game.gnames.push("Matuidi"),game.gnames.push("Emre Can"),game.gnames.push("Betancur"),game.gnames.push("Ronaldo"),game.gnames.push("Dybala"),game.gnames.push("D.Costa"),game.gnames.push("Cuadrado"),game.gnames.push("Mandzukic"),game.gnames.push("Kean"),game.gnames.push("Bernardeschi"),Date.now||(Date.now=function(){return(new Date).getTime()});var e=game.getJSON("localization.json");game.localizedTexts=e.localizedTexts,game.locale="it_IT",game.name="CRISTIAN.S0001",game.gname="",FR_PLAYERID="00000000000000.00000000",this.loggedin=!1;try{app_juve&&("en"==app_juve.lang&&(game.locale="en_US"),app_juve.user&&(app_juve.user.userID&&(FR_PLAYERID=app_juve.user.userID,loggedin=!0),app_juve.user.nickname&&(game.name=app_juve.user.nickname)))}catch(e){console.log(e),this.loggedin=!1}HALF_WIDTH=game.width/2,game.Input.clickTimeout=6e4,LoadMute();var a=new game.Music(MUSIC_MAIN);game.mute?a.volume=0:a.volume=MUSIC_VOLUME,game.mainMusic=a;a=new game.Music(MUSIC_INTRO);game.mute?a.volume=0:a.volume=MUSIC_VOLUME,game.introMusic=a;a=new game.Music(MUSIC_INTRO2);game.mute?a.volume=0:a.volume=MUSIC_VOLUME,game.intro2Music=a;a=new game.Music(MUSIC_OUTRO);game.mute?a.volume=0:a.volume=MUSIC_VOLUME,game.outroMusic=a,this.postLoad()},postLoad:function(){""!=LEVEL_DESIGN?(TestLevel=!0,GoToScene("Main")):(this.loggedin||FR_ALLOW_UNKNOW)&&GoToScene("Intro")},update:function(){CommonUpdate()}})});game.module("game.outro").require("game.common","plugin.essentials").body(function(){game.createScene("Outro",{gravity:2e3,backgroundColor:BACKGROUND_COLOR,init:function(){this.playerSpawned=!1,this.spawnDelay=.7,this.spawntimer=0,this.scoreDelay=.5,this.scoreTimer=0,this.shownScore=0,this.hasFinished=!1,game.outroMusic.play(),this.world=new game.Physics,this.world.gravity.y=this.gravity,(s=new game.Body).collisionGroup=0;var e=1100,t=.778*game.height;s.position.set(e,t),s.static=!0;var s,i=new game.Rectangle(2e3,.1*game.height);s.addShape(i),s.collide=this.collide.bind(s),s.addTo(game.scene.world),(s=new game.Body).collisionGroup=99;e=1275,t=.65*game.height;s.position.set(e,t),s.static=!0;i=new game.Rectangle(2200,.1*game.height);s.addShape(i),s.collide=this.collide.bind(s),s.addTo(game.scene.world),this.timer=0,this.page=1,this.score=0,FR_SCORE&&(this.score=FR_SCORE),PlayCinematic(INTRO_OUTRO_JSON,OUTRO,HALF_WIDTH,.5*game.height);var a=GetLocalizedString("RESTART");this.button=CreateDefaultButton(1*HALF_WIDTH,.95*game.height,a,30,function(){game.scene.start()});a=GetLocalizedString("SHARE");this.button1=CreateDefaultButton(1*HALF_WIDTH,.05*game.height,a,30,function(){try{app_juve&&app_juve.shareCard(FR_SCORE,game.selectIdx,"playerSelectedName")}catch(e){app_juve.shareCard(FR_SCORE,game.selectIdx,game.gname,FR_SESSIONID)}}),this.scoreStep=0,this.score<10?(this.scoreDelay=.5,this.scoreStep=1):this.score<50?(this.scoreDelay=.1,this.scoreStep=1):this.score<100?(this.scoreDelay=.05,this.scoreStep=2):this.score<500?(this.scoreDelay=.05,this.scoreStep=5):(this.scoreDelay=.005,this.scoreStep=10),this.scoreVisible=!1,AddForegroundUI(),this.writePage()},displayScore:function(){this.scoreText=CreateText(this.shownScore,HALF_WIDTH,.295*game.height,0,95),SetColor(this.scoreText,COLOR_BLACK),this.scoreText.addTo(game.scene.stage),this.scoreVisible=!0},jumpVfx:function(e,t){},collide:function(e,t){this.player.alive=!1},writePage:function(){},nextPage:function(){this.page++,this.page>game.cinematicSequence.length?game.scene.start():(NextCinematic(),this.writePage())},start:function(){game.outroMusic.stop(),GoToScene("Select")},update:function(){CommonUpdate(),this.spawntimer+=game.system.delta,0==this.playerSpawned&&this.spawntimer>=this.spawnDelay&&(this.playerSpawned=!0,this.player=new game.Player(-300,.75*game.height),this.player.sprite.addTo(this.stage),this.player.jump()),1==this.scoreVisible&&(this.scoreTimer+=game.system.delta,this.shownScore<this.score&&this.scoreTimer>=this.scoreDelay?(this.shownScore=Math.min(this.shownScore+this.scoreStep,this.score),this.scoreStep,this.scoreTimer=0,this.scoreText.setText(""),this.scoreText=CreateText(this.shownScore,HALF_WIDTH,.295*game.height,0,95),SetColor(this.scoreText,COLOR_BLACK),this.scoreText.addTo(game.scene.stage)):this.shownScore>=this.score&&(1==game.playingScoreSound&&(game.playingScoreSound=!1,null!=game.scoreSound&&game.scoreSound.stop()),this.hasFinished||(this.hasFinished=!0,NextCinematic())))},doPress:function(){var e=Date.now()-this.timer;this.timer=Date.now(),e>300?this.nextPage():game.scene.start()},keydown:function(e){"SPACE"===e&&this.doPress()}})});game.module("game.select").require("game.common","plugin.essentials").body(function(){game.createScene("Select",{backgroundColor:BACKGROUND_COLOR,init:function(){1==game.playingIntro1&&(game.introMusic.stop(),game.playingIntro1=!1),0==game.playingIntro2&&(game.playingIntro2=!0,game.intro2Music.play()),AddForegroundUI(),this.rowLocked=4,this.text=CreateText(game.name,HALF_WIDTH,.025*game.height,0,25),this.text.addTo(game.scene.stage);var e=GetLocalizedString("SELECTPLAYER");this.text=CreateText(e,HALF_WIDTH,.076*game.height,0,39),this.text.addTo(game.scene.stage),this.x=0,this.y=0,this.scalex=107,this.scaley=107,this.yy=.45*game.height,this.xx=HALF_WIDTH-3*this.scalex,(t=new game.Sprite(GREEK_UP)).x=HALF_WIDTH,t.y=.14*game.height,t.anchorCenter(),t.addTo(game.scene.stage),(t=new game.Sprite("block.png")).x=HALF_WIDTH,t.y=.282*game.height,t.scale.y=2.95,t.scale.x=8,t.anchorCenter(),t.addTo(game.scene.stage),(t=new game.Sprite(GREEK_DOWN)).x=HALF_WIDTH,t.y=.424*game.height,t.anchorCenter(),t.addTo(game.scene.stage),this.text=CreateText("Bernardeschi",HALF_WIDTH,.38*game.height,0,35),this.text.addTo(game.scene.stage),(t=new game.Sprite(PORTRAIT+"Bg1.png")).x=0+HALF_WIDTH,t.y=12+.25*game.height,t.anchorCenter(),t.scale.x=1,t.scale.y=1,t.addTo(game.scene.stage),this.plotSelectedImg(),this.buildGrid();var t,s=GetLocalizedString("CONFIRM");this.button=new CreateDefaultButton(HALF_WIDTH,.95*game.height,s,30,function(){game.scene.start()}),this.button.addTo(game.scene.stage),(t=new game.Sprite(PORTRAIT+"Fg.png")).x=this.x*this.scalex,t.y=this.y*this.scaley,t.scale.x=.5,t.scale.y=.5,this.xx1=-8+this.xx,this.yy1=-8+this.yy,t.x+=this.xx1,t.y+=this.yy1,t.addTo(game.scene.stage),this.frame=t,this.prevX=this.x,this.prevY=this.y},plotSelectedImg:function(){this.selectedImg&&this.selectedImg.remove(),this.selectIdx=1+this.x+6*this.y;var e=new game.Sprite(PORTRAIT+this.selectIdx+".png");e.x=HALF_WIDTH,e.y=10+.25*game.height,e.anchorCenter(),e.scale.x=1,e.scale.y=1,e.addTo(game.scene.stage),this.selectedImg=e,this.text.setText(game.gnames[this.selectIdx-1]),this.text.x=150+HALF_WIDTH-this.text.width/2},buildGrid:function(){for(var e=0;e<24;++e){var t=e+1,s=~~(e/6),i=e%6;this.plot(i,s,PORTRAIT+"Bg.png",0),this.plot(i,s,PORTRAIT+t+".png",4,4),s>=this.rowLocked&&this.plot(i,s,PORTRAIT+"Lock.png",4,4)}},plot:function(e,t,s,i,a){var h=new game.Sprite(s);return h.x=e*this.scalex,h.y=t*this.scaley,h.scale.x=.5,h.scale.y=.5,h.x+=this.xx+i,h.y+=this.yy+i,h.addTo(game.scene.stage),h},keydown:function(e){"SPACE"===e&&this.start(),"LEFT"===e&&(PlaySound(SOUND_SELECT),this.x--,this.x<0&&(this.x=0)),"RIGHT"===e&&(PlaySound(SOUND_SELECT),this.x++,this.x>5&&(this.x=5)),"UP"===e&&(PlaySound(SOUND_SELECT),this.y--,this.y<0&&(this.y=0)),"DOWN"===e&&(PlaySound(SOUND_SELECT),this.y+1<this.rowLocked&&this.y++,this.y>3&&(this.y=3))},rndSelect:function(){var e=6*this.rowLocked-1;this.selectIdx=1+Math.floor(Math.random()*e),0==this.selectIdx&&this.rndSelect(),this.x=this.selectIdx%6,this.y=~~(this.selectIdx/6),this.plotSelectedImg()},start:function(){game.selectIdx=this.selectIdx,game.gname=game.gnames[this.selectIdx-1],GoToScene("Tutorial")},select:function(e,t){if(!(t<.4*game.height||t>.9*game.height)){PlaySound(SOUND_SELECT);for(var s=0,i=0;i<5;++i)if(t<i*this.scaley+this.yy){s=i;break}if(s-1<this.rowLocked){s>0&&(this.y=s-1);var a=-1;for(i=0;i<7;++i)if(e<i*this.scalex+this.xx){a=i;break}a>0&&(this.x=a-1)}}},mousedown:function(e,t){this.super(e,t),this.select(e,t)},mouseup:function(e,t){this.super(e,t)},update:function(){CommonUpdate(),this.prevX!=this.x&&(this.frame.x=this.x*this.scalex+this.xx1,this.plotSelectedImg()),this.prevY!=this.y&&(this.frame.y=this.y*this.scaley+this.yy1,this.plotSelectedImg()),this.prevX=this.x,this.prevY=this.y}})});game.module("game.tutorial").require("game.common","plugin.essentials").body(function(){game.createScene("Tutorial",{backgroundColor:BACKGROUND_COLOR,init:function(){AddForegroundUI(),game.startSent=!1,game.startReceived=!1,this.page=1,this.text=CreateText("TUTORIAL",HALF_WIDTH,.025*game.height,0,35),this.text.addTo(game.scene.stage),(e=new game.Sprite(TEXTBOX)).x=HALF_WIDTH,e.y=.18*game.height,e.anchorCenter(),e.addTo(game.scene.stage),(e=new game.Sprite(GREEK_UP)).x=HALF_WIDTH,e.y=.335*game.height,e.anchorCenter(),e.addTo(game.scene.stage),(e=new game.Sprite("block.png")).x=HALF_WIDTH,e.y=.62*game.height,e.scale.y=5.9,e.scale.x=8,e.anchorCenter(),e.addTo(game.scene.stage),(e=new game.Sprite(GREEK_DOWN)).x=HALF_WIDTH,e.y=.891*game.height,e.anchorCenter(),e.addTo(game.scene.stage);var e,a=GetLocalizedPath(TUTORIAL1)+".png",t=GetLocalizedPath(TUTORIAL2)+".png",g=GetLocalizedPath(TUTORIAL3)+".png";(e=new game.Sprite(a)).x=HALF_WIDTH,e.y=.622*game.height,e.scale.y=1,e.scale.x=1,e.alpha=0,e.anchorCenter(),e.addTo(game.scene.stage),this.tutorial1=e,(e=new game.Sprite(t)).x=HALF_WIDTH,e.y=.622*game.height,e.scale.y=1,e.scale.x=1,e.alpha=0,e.anchorCenter(),e.addTo(game.scene.stage),this.tutorial2=e,(e=new game.Sprite(g)).x=HALF_WIDTH,e.y=.622*game.height,e.scale.y=1,e.scale.x=1,e.alpha=0,e.anchorCenter(),e.addTo(game.scene.stage),this.tutorial3=e,this.writePage(),this.button=CreateDefault1Button(1.9*HALF_WIDTH,.95*game.height,"x",1,function(){game.scene.doPress()}),this.button=new CreateDefaultButton(HALF_WIDTH,.95*game.height,GetLocalizedString("SKIP"),30,function(){game.scene.start()}),this.timer=0,this.tutorial1.alpha=1},writePage:function(){var e=GetLocalizedString("TUTORIAL1"),a=GetLocalizedString("TUTORIAL2"),t=GetLocalizedString("TUTORIAL3");game.scene.message&&game.scene.message.remove();var g="";1==game.scene.page&&(g=e,game.scene.tutorial3.alpha=0,game.scene.tutorial2.alpha=0,game.scene.tutorial1.alpha=1),2==game.scene.page&&(g=a,game.scene.tutorial1.alpha=0,game.scene.tutorial2.alpha=1,game.scene.tutorial3.alpha=0),3==game.scene.page&&(g=t,game.scene.tutorial1.alpha=0,game.scene.tutorial2.alpha=0,game.scene.tutorial3.alpha=1),game.scene.message=CreateText(g,.2*HALF_WIDTH,.111*game.height,0,22),game.scene.message.anchor.set(0,0),game.scene.message.align="left",game.scene.message.updateText(),game.scene.message.addTo(game.scene.stage)},nextPage:function(){this.page++,4==this.page?game.scene.start():this.writePage()},start:function(){StartGame()},update:function(){CommonUpdate()},doPress:function(){var e=Date.now()-this.timer;this.timer=Date.now(),e>300?this.nextPage():game.scene.start()},mousedown:function(e,a){a<.9*game.height&&game.scene.doPress()},keydown:function(e){"SPACE"===e&&this.doPress()}})});game.module("game.myloader").body(function(){game.createClass("myLoader","Loader",{init:function(e){this.bar=new game.Graphics,this.bar.beginFill("#222222"),this.bar.drawRect(0,0,81.86,6),this.bar.scale.set(5,5),this.bar.position.set(game.system.width/2-242,game.system.height/2-12),this.bar.addTo(this.stage);for(var i=game.Texture.fromImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAAHCAYAAAAie5yXAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gsJChou/OwccAAAABdJREFUCNdj+P///38GBob/TAxQQBIDACmfBQiabBwGAAAAAElFTkSuQmCC"),a=0;40>a;a++){var s=new game.Sprite(i);s.position.x=1+2*a,s.position.y=1,s.scale.y=.5,s.visible=!1,s.addTo(this.bar)}100===this.percent&&this.onProgress(100)},onProgress:function(){for(var e=Math.ceil(this.bar.children.length/100*this.percent),i=0;e-1>=i;i++)this.bar.children[i].visible=!0},onComplete:function(){game.Timer.add(200,this.changeScene.bind(this))},changeScene:function(){game.system.setScene(this.scene)}})});game.module("game.main").require("game.common","game.myloader","game.tutorial","game.select","game.intro","game.error","game.outro","game.preloading","game.player","game.poisson","plugin.spine","plugin.essentials","plugin.tiled").body(function(){game.createScene("Main",{gravity:2e3,init:function(){FR_VALIDATION_TOKEN=[],FR_TIMESFALLEN=0,FR_TIMESSTARS=0,game.playingIntro2&&(game.intro2Music.stop(),game.playingIntro2=!1),game.mainMusic.play();this.blockConstruction=0,this.displacementX=0,this.scoreBouncingTimer=0,this.scoreBouncingDone=!1,Lambda=1,this.points=0,this.time=0,this.initialCorrectionX=50,this.startingTime=Date.now(),this.layers=[],this.layers.push("layer_08.png"),this.layers.push("layer_06.png"),this.layers.push("layer_05.png"),this.layers.push("layer_04.png"),this.bgLayer=[],this.layers.forEach(function(e){var t=new game.TilingSprite(e);t.addTo(game.scene.stage),game.scene.bgLayer.push(t)}),this.world=new game.Physics,this.world.gravity.y=this.gravity,this.container=new game.Container,this.container.addTo(this.stage),this.container0=new game.Container,this.container0.addTo(this.container),this.container1=new game.Container,this.container1.addTo(this.container),this.container2=new game.Container,this.container2.addTo(this.container),game.disp=0,game.built=0,game.blockIdx=0,this.createBlock(game.built),this.updateContructionLogic(),this.updateContructionLogic(),this.updateContructionLogic(),this.updateContructionLogic(),this.player=new game.Player(500,1460),game.imgDisplacementY=0,this.player.sprite.addTo(this.container1),this.camera=new game.Camera(this.player.sprite),this.camera.addTo(this.container),this.camera.setPosition(this.player.sprite.x,this.player.sprite.y),this.camera.offset.x=game.width/10,this.camera.offset.y=5*game.height/10,this.camera.sensorSize.x=100,this.camera.sensorSize.y=200,this.camera.limit=new game.Rectangle(1/0,LowLimit,-1/0,-1/0),this.camera.maxSpeed=FR_SPEED+100,this.camera.threshold=2,this.displacement=0,this.maxTime=120,this.text1=CreateText(this.format1(this.maxTime),0,0,0,60,{align:"center"}),this.text1.anchorCenter(),this.text1.x+=HALF_WIDTH,this.text1.y+=.052*game.height+this.text1.height/2,this.text1.y+=2,SetColor(this.text1,"#000000",.7),this.text1.addTo(game.scene.stage),this.text=CreateText(this.format1(this.maxTime),0,0,0,60,{align:"center"}),this.text.anchorCenter(),this.text.x+=HALF_WIDTH,this.text.y+=.052*game.height+this.text.height/2,this.text.addTo(game.scene.stage),this.score1=CreateText1(game.name,0,0,0,16.5,{}),this.score1.x+=25,this.score1.y+=2+.136*game.height+this.score1.height/2,SetColor(this.score1,"#000000",.7),this.score1.addTo(game.scene.stage),this.score1=CreateText1(game.name,0,0,0,16.5,{}),this.score1.x+=25,this.score1.y+=.136*game.height+this.score1.height/2,this.score1.cache=!0,this.score1.addTo(game.scene.stage),this.scoreb=CreateText1("00000000",0,0,0,30,{}),this.scoreb.x+=25,this.scoreb.y+=2+.16*game.height+this.scoreb.height/2,SetColor(this.scoreb,"#000000",.7),this.scoreb.addTo(game.scene.stage),this.score=CreateText1("00000000",0,0,0,30,{}),this.score.x+=25,this.score.y+=.16*game.height+this.score.height/2,this.score.addTo(game.scene.stage),this.border=new game.Sprite(BORDER),this.border.anchorCenter(),this.border.x+=.85*game.width,this.border.y+=.08*game.height,this.border.addTo(game.scene.stage);var e,t=this.fill(FR_PLAYERMAXSCORE.toString());this.maxscore=CreateText(t,0,0,0,22),this.maxscore.cache=!0,SetColor(this.maxscore,COLOR_DOVEGRAY),this.maxscore.anchor.set(0,0),this.maxscore.x=.94*game.width-this.maxscore.width*this.maxscore.scale.x,this.maxscore.y+=.04*game.height+this.maxscore.height/2,this.maxscore.addTo(game.scene.stage),this.score1=CreateText1("HIGH SCORE",0,0,0,28,{}),this.score1.x+=.9*game.width-this.maxscore.width*this.maxscore.scale.x,this.score1.y+=.008*game.height+this.score1.height/2,SetColor(this.score1,COLOR_DOVEGRAY,.7),this.score1.addTo(game.scene.stage),this.initialCorrectionX=0,this.timeComputated=0,this.scoreComputated=0,AddForegroundUI(),this.containerConnect=new game.Container,this.containerConnect.addTo(game.scene.stage),this.blackLayer=new game.Sprite("block.png"),this.blackLayer.tint="#000000",this.blackLayer.alpha=.8,this.blackLayer.width=game.width,this.blackLayer.height=game.height,this.blackLayer.addTo(this.containerConnect),(e=new game.Sprite(LOADING_STAR)).x=.3*game.width,e.y=.5*game.height,e.alpha=0,e.anchorCenter(),e.addTo(this.containerConnect),this.star1=e,(e=new game.Sprite(LOADING_STAR)).x=.5*game.width,e.y=.5*game.height,e.alpha=0,e.anchorCenter(),e.addTo(this.containerConnect),this.star2=e,(e=new game.Sprite(LOADING_STAR)).x=.7*game.width,e.y=.5*game.height,e.alpha=0,e.anchorCenter(),e.addTo(this.containerConnect),this.star3=e,this.containerConnect.visible=0,this.timer=0,this.stepb=0,this.steps=[],this.loading=!1,this.loadingStars=0,this.createVFX(),(i=new game.Sprite("portraitBg2.png")).x=.1*game.width,i.y=.075*game.height,i.anchorCenter(),i.addTo(game.scene.stage);var i,s=0;game.selectIdx&&(s=game.selectIdx),(i=new game.Sprite("portrait"+s+".png")).x=.1*game.width,i.y=.075*game.height,i.scale.x=.5,i.scale.y=.5,i.anchorCenter(),i.addTo(game.scene.stage),this.vfxindex=0;var a=new game.Sprite("Stadium_quinta.png");a.x+=2e3,a.y+=796,a.addTo(game.scene.container2),this.stadiumBlock=a},format1:function(e){var t=~~(e/60),i=e%60,s=this.fillVariant(t.toString(),2);return s+=":"+this.fillVariant(i.toString(),2)},createVFX:function(){var e=new game.SpriteSheet(VFX,104,104);this.vfx1=new game.Animation(e.textures),this.vfx1.addAnim("jump",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0],{speed:20,loop:!1}),this.vfx1.anims.jump.loop=!1,this.vfx1.anchorCenter(),this.vfx1.addTo(game.scene.container2);e=new game.SpriteSheet(VFX2,104,104);this.vfx2=new game.Animation(e.textures),this.vfx2.addAnim("run",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0],{speed:30,loop:!1}),this.vfx2.anchorCenter(),this.vfx2.addTo(game.scene.container2);e=new game.SpriteSheet(VFX2,104,104);this.vfx2b=new game.Animation(e.textures),this.vfx2b.addAnim("run",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0],{speed:30,loop:!1}),this.vfx2b.anchorCenter(),this.vfx2b.addTo(game.scene.container2);e=new game.SpriteSheet(VFX3,104,104);this.vfx3=new game.Animation(e.textures),this.vfx3.addAnim("idle",[0,1,2,3,4,5,6,7,8],{speed:10,loop:!1}),this.vfx3.addAnim("fade",[9,10,11,12,13,14,15,16,17,18,19,20],{speed:20,loop:!1}),this.vfx3.anchorCenter(),this.vfx3.addTo(game.scene.container2);e=new game.SpriteSheet(VFX4,104,104);this.vfx4=new game.Animation(e.textures),this.vfx4.addAnim("idle",[0,1,2,3,4,5],{speed:30,loop:!1}),this.vfx4.addAnim("fade",[6,7,8,9,10,11,12,13,14,15,16,17,18],{speed:20,loop:!1}),this.vfx4.anchorCenter(),this.vfx4.addTo(game.scene.container2);e=new game.SpriteSheet(VFX5,160,64);this.vfx5=new game.Animation(e.textures),this.vfx5.addAnim("jump",[0,1,2,3,4,5,6],{speed:20,loop:!1}),this.vfx5.anchorCenter(),this.vfx5.addTo(game.scene.container2);e=new game.SpriteSheet(VFX6,100,84);this.vfx6=new game.Animation(e.textures),this.vfx6.addAnim("one",[1,2,3,4,5,0],{speed:10,loop:!1}),this.vfx6.addAnim("two",[6,7,8,9,10,0],{speed:10,loop:!1}),this.vfx6.addAnim("three",[11,12,13,14,15,0],{speed:10,loop:!1}),this.vfx6.addAnim("time",[16,17,18,19,20,0],{speed:10,loop:!1}),this.vfx6.anchorCenter(),this.vfx6.addTo(game.scene.container2)},starVfx:function(e,t){this.vfx4.position.set(e,t),this.vfx4.play("fade"),this.vfx6.position.set(e,t-64),this.vfx6.play("time")},packVfx:function(e,t,i){this.vfx3.position.set(e,t),this.vfx3.play("fade"),0==i&&(this.vfx6.position.set(e,t-64),this.vfx6.play("one")),1==i&&(this.vfx6.position.set(e,t-64),this.vfx6.play("two")),2==i&&(this.vfx6.position.set(e,t-64),this.vfx6.play("three"))},runVfx:function(e,t){0==this.vfxindex?(this.vfx2.position.set(e,t),this.vfx2.play("run"),++game.scene.vfxindex):(this.vfx2b.position.set(e,t),this.vfx2b.play("run"),game.scene.vfxindex=0)},jumpVfx:function(e,t){this.vfx1.position.set(e,t),this.vfx1.play("jump")},jumpVfx1:function(e,t){this.vfx5.position.set(e,t),this.vfx5.play("jump")},mousedown:function(e,t){this.super(e,t),this.player.jump()},loadingUpdate:function(){var e;this.loading&&(this.loadingStars++,(e=this.loadingStars+0)>128&&(e-=128),this.star1.alpha=e>64?(128-e)/64:e/64,(e=this.loadingStars+16)>128&&(e-=128),this.star2.alpha=e>64?(128-e)/64:e/64,(e=this.loadingStars+32)>128&&(e-=128),this.star3.alpha=e>64?(128-e)/64:e/64,this.loadingStars>128&&(this.loadingStars=0))},changeTime:function(e){var t=this.format1(e);this.text.setText(t),this.text1&&(this.text1.setText(t),e>10?SetColor(this.text1,"#000000",.7):(SetColor(this.text1,"#FF0000",.7),e>0&&PlaySound(SOUND_TIME)))},updateContructionLogic:function(){1==game.scene.blockConstruction?(this.dressBlock(),game.scene.blockConstruction=2):2==game.scene.blockConstruction?(this.calculateBlockSafe(),game.scene.blockConstruction=3):3==game.scene.blockConstruction?(this.createColliders(),game.scene.blockConstruction=4):4==game.scene.blockConstruction?(this.createObjColliders(),game.scene.blockConstruction=5):5==game.scene.blockConstruction&&(this.finalizeBlock(),game.scene.blockConstruction=0)},update:function(){if(0!=this.scoreBouncingTimer&&0==this.scoreBouncingDone){var e=5*(157-this.scoreBouncingTimer)/157;this.scoreb.y+=e*Math.sin(this.scoreBouncingTimer/2),this.score.y+=e*Math.sin(this.scoreBouncingTimer/2),this.scoreBouncingTimer++,157==this.scoreBouncingTimer&&(this.scoreBouncingTimer=0)}if(this.loadingUpdate(),CommonUpdate(),!game.scene.loading){if(game.scene.timeComputated<0&&(FR_SCORE=game.scene.points,game.scene.loading=!0,this.changeTime(0),this.containerConnect.visible=!0,SendEndGame(),game.mainMusic.stop()),this.updateContructionLogic(),this.steps.length>10)(g=this.steps.shift()).body.remove(),g.remove();if(this.steps.length>0){var t=this.steps[this.steps.length-1];if(0==t.body.alive)(g=this.steps.pop()).body.remove(),g.remove();else if(!t.sounded){t.sounded=!0;var i=game.scene.player.sprite.position;this.runVfx(i.x,i.y),0==this.stepb?(PlaySound(SOUND_STEP1),this.stepb=1):(PlaySound(SOUND_STEP2),this.stepb=0)}}var s=Date.now()-this.startingTime,a=1e3*this.maxTime;if(this.timeComputated!=~~((a-s)/1e3)&&(1,this.timeComputated=~~((a-s)/1e3),this.timeComputated>=0&&this.changeTime(this.timeComputated)),this.scoreComputated!=this.points){this.scoreComputated=this.points;var o=this.fill(this.points.toString());this.score.setText(o),this.scoreb.setText(o),SetColor(this.scoreb,"#000000",.7),this.points>FR_PLAYERMAXSCORE&&(this.scoreBouncingTimer=1,this.scoreBouncingDone=!0)}var n=LowLimit-game.scene.camera.position.y,r=this.displacement-n;game.disp=r,this.displacement=n;var h=!1,c=1e4;this.block&&(c+=this.block.size);var l=game.built-game.scene.block.tilemap.pixelWidth;if(0==game.scene.blockConstruction&&game.scene.player.sprite.position.x>c){game.scene.player.sprite.position.x-=l,game.scene.player.body.position.x-=l,game.scene.camera._setPosition(game.scene.camera.offset.x+game.scene.camera.position.x-l,game.scene.camera.offset.y+game.scene.camera.position.y),game.built=game.scene.block.size,game.scene.block.moveX(l);for(var m=0;m<this.steps.length;++m)this.steps[m].x-=l;h=!0}0==game.scene.blockConstruction&&game.scene.player.sprite.position.x>game.built-game.width&&this.createBlock(game.built,game.blockIdx),h||this.updateBackground(),0==game.scene.blockConstruction&&this.block&&this.block.update(),this.previousBlock&&this.previousBlock.update();if(game.scene.player.alive&&game.scene.player.onGround&&this.timer>=12){var g;this.timer=0,(g=new game.Sprite("t1.png")).x=game.scene.player.body.position.x-16,g.y=game.scene.player.body.position.y+35,g.scale.x=4,g.scale.y=4,g.addTo(game.scene.container1),this.steps.push(g);var d=new game.Body,p=game.scene.player.body.position.x+40,f=g.y;d.position.set(p,f),d.static=!1,d.mass=0;var x=new game.Rectangle(60,50);d.collisionGroup=3,d.addShape(x),d.collideAgainst.push(0),d.alive=!1,d.collide=this.collide.bind(d),d.addTo(game.scene.world),g.body=d}this.timer++}},fillVariant:function(e,t){return e.length<t?this.fillVariant("0"+e):e},fill:function(e){return e.length<PointSize?this.fill("0"+e):e},collide:function(e,t){0==e.collisionGroup&&e!=game.scene.player.body&&IsWalkable(e.tileid)&&(this.alive=!0)},removePrevPrev:function(){game.scene.prevPrevBlock&&(0==game.scene.prevPrevBlock.idx&&game.scene.stadiumBlock.remove(),game.scene.prevPrevBlock.remove())},createBlock:function(e){var t=game.blockIdx;game.blockIdx++;var i=PRnd(Lambda);this.prevPrevBlock=this.previousBlock,this.previousBlock=this.block,this.removePrevPrev(),0==t?i=0:i++,i>MaxLevel&&(i=MaxLevel),(1+t)%3==0&&Lambda++,Lambda>MaxLambda&&(Lambda=MaxLambda);var s="level"+i+".json";1==TestLevel&&(s=LEVEL_DESIGN),LEVEL_DESIGN_SEQUENTIAL&&(s="level"+(i=t%(MaxLevel+1))+".json"),this.blockConstruction=1,this.block=new game.Block(s,e,t,i)},dressBlock:function(){game.scene.block.dressBlock()},calculateBlockSafe:function(){game.scene.block.calculateBlockSafe()},createColliders:function(){game.scene.block.createColliders()},createObjColliders:function(){game.scene.block.createObjColliders()},finalizeBlock:function(){game.scene.block.imgLayers.forEach(function(e){e.addTo(game.scene.container0)}),game.scene.block.tilemap.addTo(game.scene.container0),game.scene.block.objs.forEach(function(e){e.addTo(game.scene.container0)}),game.scene.blockConstruction=0,game.built+=this.block.tilemap.pixelWidth},updateSkewdLayer:function(e){e.updateSkewdLayer()},updateBackground:function(e){var t=game.scene.player,i=t.prevPosX-t.sprite.x,s=game.disp,a=0;this.bgLayer.forEach(function(e){e.tilePosition.x-=a*(2*-i)*game.delta,e.tilePosition.y+=(game.scene.bgLayer.length-a)*(s/40)*60*game.delta,++a})},updateLayerImg:function(e,t,i){if(e)for(var s=0;s<e.imgLayers.length;++s)img=e.imgLayers[s],img.position.x+=XSpeed*-t*game.delta,game.imgDisplacementY=img.position.y-img.offsety},removeFromLists:function(e){var t=!1;return this.block&&(t=this.block.removeFromLists(e)),!t&&this.previousBlock&&(t=this.previousBlock.removeFromLists(e)),t},keydown:function(e){var t=game.scene.player;"SPACE"===e&&this.player.jump(),FR_DEBUG&&"LEFT"===e&&(t.alive=!1),FR_DEBUG&&"RIGHT"===e&&(t.alive=!0),FR_DEBUG&&"UP"===e&&(game.scene.player.body.velocity.y=-1e3),FR_DEBUG&&"Down"===e&&(game.scene.player.body.velocity.x=-1e3)}}),game.createClass("Block",{init:function(e,t,i,s){t||(t=0),this.id=s,this.idx=i,this.name=e,this.tilemap=new game.Tilemap(e),this.size=this.tilemap.pixelWidth,this.imgLayers=[],this.objs=[],this.displacementX=t,this.deltapack=0},dressBlock:function(){for(var e in this.tilemap.layers){if(this.tilemap.layers.hasOwnProperty(e))if((c=this.tilemap.layers[e]).image&&c.visible){var t=new game.Sprite(c.image),i=c.offsetx?c.offsetx:0,s=c.offsety?c.offsety:0;t.position.y=s,t.offsety=c.offsety,t.position.x=i+this.displacementX,t.scale.x=XScale,this.imgLayers.push(t)}else if(c.objects){var a=this.tilemap,o=this.objs,n=this.idx,r=this.id,h=this.displacementX;c.objects.forEach(function(e){var t=a.spriteFromTile(e.gid);t.anchor.set(0,0),t.objx=e.x,t.objy=e.y,t.position.y=e.y-e.height,t.position.x=e.x+h,t.originalPosx=t.position.x,t.originalPosy=t.position.y,t.gid=e.gid,t.id=e.id,t.bidx=n,t.bidd=r,o.push(t)})}else if(c.data){a=this.tilemap;if(e==layerSx)for(var c=this.tilemap.layers[e],l=0;l<c.tiles.length;++l){(m=c.tiles[l]).anchor.set(m.width,0),m.x+=m.width+1,Fake3d||(m.scale.x=.3)}if(e==layerDx)for(c=this.tilemap.layers[e],l=0;l<c.tiles.length;++l){var m;(m=c.tiles[l]).anchor.set(0,0),Fake3d||(m.scale.x=.3)}for(l=0;l<c.tiles.length;++l)c.tiles[l].x+=this.displacementX}}},calculateBlockSafe:function(){var e=this.tilemap.layers.main;this.blockSafe=[];for(var t=this.tilemap.layers.main.width,i=t,s=0;s<t;s++)this.blockSafe.push(0);var a=e.tiles.length;for(s=0;s<a;s++){var o=e.tiles[-1+a-s];if(!IsCloud(o.tileid)&&void 0!==o.tilex){o.tilex<i&&(i=o.tilex,this.startingx=o.position.x);var n=this.blockSafe[o.tilex];o.tiley!=n&&0!=n||(this.blockSafe[o.tilex]=o.tiley-1)}}var r=0;for(s=0;s<t;s++){var h=-1+t-s;0==this.blockSafe[h]?this.blockSafe[h]=r:r=this.blockSafe[h]}r=this.blockSafe[0];for(s=0;s<t;s++){h=s;0==this.blockSafe[h]?this.blockSafe[h]=r:r=this.blockSafe[h]}},createObjColliders:function(){this.objsBodies=[];for(var e=0;e<this.objs.length;e++){var t=this.objs[e],i=this.addBodyForObj(t);i.id=t.id,i.gid=t.gid,i.bidd=t.bidd,i.objx=t.objx,i.objy=t.objy,i.sprite=t,this.objsBodies.push(i)}},createColliders:function(){var e=this.tilemap.layers.main;if(this.blockBodies=[],!FR_PASSTROUGH)for(var t=0;t<this.tilemap.layers.main.tiles.length;t++){var i=e.tiles[t],s=this.addBodyForTile(i,t);this.blockBodies.push(s)}},update:function(){for(var e=0;e<this.objs.length;e++){var t=this.objs[e];t.position.y=t.originalPosy+3*Math.sin(t.position.x+this.deltapack/20)}this.deltapack+=1},isInside:function(e){return!(e<this.startingx)},moveX:function(e){this.startingx-=e,this.displacementX-=e;for(var t=0;t<this.objs.length;t++){this.objs[t].position.x-=e}for(t=0;t<this.objsBodies.length;t++){this.objsBodies[t].position.x-=e}for(t=0;t<this.blockBodies.length;t++){this.blockBodies[t].position.x-=e}for(t=0;t<this.imgLayers.length;t++){this.imgLayers[t].position.x-=e}for(var i in this.tilemap.layers)if(this.tilemap.layers.hasOwnProperty(i)){var s=this.tilemap.layers[i];for(t=0;t<s.tiles.length;t++){s.tiles[t].position.x-=e}}},indexOfId:function(e,t){for(var i=0;i<e.length;++i)if(e[i].id==t.id)return i;return-1},removeFromLists:function(e){var t,i=!1;e.sprite.bidx==this.idx&&((t=this.indexOfId(this.objsBodies,e))>-1&&this.objsBodies.splice(t,1),(t=this.indexOfId(this.objs,e))>-1&&this.objs.splice(t,1),i=!0);return i},remove:function(){for(var e=0;e<this.blockBodies.length;e++)this.blockBodies[e].remove();this.tilemap.remove();for(e=0;e<this.imgLayers.length;e++)this.imgLayers[e].remove();this.imgLayers=[];for(e=0;e<this.objs.length;e++)this.objs[e].remove();this.objs=[];for(e=0;e<this.objsBodies.length;e++)this.objsBodies[e].remove();this.objsBodies=[]},addBodyForTile:function(e){var t=new game.Body;t.tileid=e.tileid;var i=e.x+this.tilemap.tileWidth/2,s=e.y+this.tilemap.tileHeight/2;t.position.set(i,s),t.static=!0;var a=new game.Rectangle(this.tilemap.tileWidth,this.tilemap.tileHeight);return t.addShape(a),t.addTo(game.scene.world),t},addBodyForObj:function(e){var t=new game.Body,i=e.x+e.width/2,s=e.y+e.height/2;t.position.set(i,s),t.collisionGroup=1,t.static=!0;var a=new game.Rectangle(.9*e.width,.9*e.height);return t.addShape(a),t.addTo(game.scene.world),t}})});game.module("game.intro").require("game.common","plugin.essentials").body(function(){game.createScene("Intro",{backgroundColor:BACKGROUND_COLOR,init:function(){game.playingIntro1=!1,game.playingIntro2=!1,game.introMusic.play(),game.playingIntro1=!0,this.timer=0,this.page=1,PlayCinematic(INTRO_OUTRO_JSON,INTRO,HALF_WIDTH,.5*game.height),this.button=CreateDefault1Button(1.8*HALF_WIDTH,.95*game.height,"x",1,function(){game.scene.doPress()});var t=GetLocalizedString("SKIP"),e=new game.ForgeButton(BUTTON_ACTIVE,BUTTON_PRESSED,BUTTON_DISABLED,HALF_WIDTH,.95*game.height,t,{},30,COLOR_BLACK,COLOR_YELLOW,COLOR_DARKDARKGRAY,function(){game.scene.start()});SetDefaultButtonBehavior(e,100),this.container=new game.Container,this.container.addTo(game.scene.stage),this.container.alpha=0,e.addTo(this.container),this.button1=e,this.button1.sprite2.buttonMode=!1,this.button1.setEnable(!1),AddForegroundUI(),this.writePage()},writePage:function(){},nextPage:function(){this.page++,this.page>game.cinematicSequence.length?game.scene.start():(NextCinematic(),this.writePage())},start:function(){1==game.playingIntro1&&(game.introMusic.stop(),game.playingIntro1=!1),0==game.playingIntro2&&(game.playingIntro2=!0,game.intro2Music.play()),GoToScene("Select")},update:function(){CommonUpdate()},mousedown:function(t,e){e<.9*game.height&&game.scene.doPress()},doPress:function(){this.button1&&(this.container.alpha=1,this.button1.sprite2.buttonMode=!0,this.button1.setEnable(!0));var t=Date.now()-this.timer;this.timer=Date.now(),t>300?this.nextPage():game.scene.start()},keydown:function(t){"SPACE"===t&&this.doPress()}})});game.module("game.error").require("game.common","plugin.essentials").body(function(){game.createScene("Error",{backgroundColor:BACKGROUND_COLOR,init:function(){var e=new game.Sprite(WINDOW_ERROR);e.x=HALF_WIDTH,e.y=.5*game.height,e.anchorCenter(),e.addTo(game.scene.stage);var a=GetLocalizedString("ERROR1");1==game.errorType&&(a=GetLocalizedString("ERROR2")),game.scene.message=CreateText(a,.39*HALF_WIDTH,.42*game.height,0,29),game.scene.message.anchor.set(0,0),game.scene.message.align="left",game.scene.message.updateText(),SetColor(game.scene.message,COLOR_BLACK,1),game.scene.message.addTo(game.scene.stage),this.button=CreateDefaultButton(1*HALF_WIDTH,.95*game.height,"RESTART",30,function(){game.scene.start()}),AddForegroundUI()},start:function(){GoToScene("Select")},update:function(){CommonUpdate()},keydown:function(e){"SPACE"===e&&game.scene.start()}})});game.module("plugin.tiled").require("engine.loader").body(function(){game.Tilemap=game.Class.extend({container:null,layers:{},tiles:[],tilesets:[],tileWidth:0,tileHeight:0,staticInit:function(t,e){if(this.myName=t,this.json=game.getJSON(t),!this.json)throw"Tilemap "+t+" not found";this.json.properties=this.json.properties||{},this.tileWidth=this.json.tilewidth,this.tileHeight=this.json.tileheight,this.width=this.json.width,this.height=this.json.height,this.pixelWidth=this.tileWidth*this.width,this.pixelHeight=this.tileHeight*this.height,this.container=new game.Container,e||(this.initTilesets(),this.initLayers(),this.initTiles())},addingLayer:function(t){return!0},initLayers:function(){for(var t=0;t<this.json.layers.length;t++){var e=new game.TileLayer(this.json.layers[t]);if(this.addingLayer(e)){this.layers[e.name]&&console.log(this.myName+"/"+e.name),this.layers[e.name]=e;var i=new game.Container;i.alpha=e.opacity,i.visible=e.visible,i.addTo(this.container),this.layers[e.name].container=i}}},initTiles:function(){for(var t in this.layers){var e=this.layers[t].container;if(e){this.layers[t].tiles=[];var i=this.layers[t];if(i.data){e.x=i.x,e.y=i.y;for(var s=0,a=0,r=0,n=0;n<i.data.length;n++)if(0!==i.data[n]){if("isometric"===this.json.orientation){var h=this.tileWidth*i.width/2;h-=r*(this.tileWidth/2),h+=s*(this.tileWidth/2);var o=r*(this.tileHeight/2)+a*(this.tileHeight/2);a++,++s>=i.width&&(s=0,a=0,r++)}else h=this.tileWidth*(n%i.width),o=this.tileHeight*Math.floor(n/i.width);if(this.addingTile(this.layers[t],n,h,o)){var l=this.spriteFromTile(i.data[n]);l.position.x=h,l.position.y=o,l.tilex=n%i.width,l.tiley=~~(n/i.width),l.tileid=i.data[n],this.layers[t].tiles.push(l),this.tileAdded(i,l,i.data[n],h,o,n)&&l.addTo(e)}}}}}},initTilesets:function(){for(var t=0;t<this.json.tilesets.length;t++){for(var e=this.json.tilesets[t],i=e.image,s=Math.floor(e.imagewidth/e.tilewidth),a=s*Math.floor(e.imageheight/e.tileheight),r=0;r<a;r++){var n=Math.floor(r/s),h=Math.floor(r%s),o=e.tilewidth*Math.floor(r%s);o+=e.margin,o+=e.spacing*h;var l=e.tileheight*Math.floor(r/s);l+=e.margin,l+=e.spacing*n;var g=new game.Texture(game.BaseTexture.fromAsset(i),o,l,e.tilewidth,e.tileheight),d=new game.Tile(g,e);this.tiles.push(d)}this.tilesets.push(e)}},addingTile:function(t,e,i,s){return!0},tileAdded:function(t,e,i,s,a){return!0},spriteFromTile:function(t){var e=this.tiles[t-1];if(!e)throw"No tile found for index "+t;var i=e.texture;if(!i)throw"No texture found for tile index "+t;return new game.Sprite(i)},addTo:function(t){this.container.addTo(t)},getLayerNames:function(){return Object.keys(this.json.layers)},getTileIdAt:function(t,e,i){var s=this.getLayer(t),a=i*s.width+e;return void 0!==s.data[a]&&s.data[a]},getLayerMatrix:function(t){for(var e=this.getLayer(t),i=e.width,s=Math.ceil(e.data.length/i),a=[],r=0,n=0;n<s;n++){for(var h=[],o=0;o<i;o++)h.push(e.data[r]),r++;a.push(h)}return a},getTileProperties:function(t){var e=this.tilesets[t];return!e&&e.tileproperties},getLayer:function(t){for(var e=0;e<this.json.layers.length;e++){var i=this.json.layers[e];if(i.name===t)return i}return!1},remove:function(){this.container.remove()}}),game.Tile=game.Class.extend({staticInit:function(t,e){this.texture=t,this.tileset=e}}),game.TileLayer=game.Class.extend({tiles:[],staticInit:function(t){game.merge(this,t)},getObject:function(t){if(this.objects)for(var e=0;e<this.objects.length;e++)if(this.objects[e].name===t)return this.objects[e]}}),game.Loader.inject({loadTilesets:function(t,e){for(var i=game.json[t].tilesets,s=0;s<i.length;s++){var a=i[s];if(!a.loaded&&(a.loaded=!0,a.image||a.source)){if(a.image){var r=game._getFilePath(a.image);game.paths[a.image]=r,this.loadImage(r,this.loadTilesets.bind(this,t,e))}else if(a.source){var n=game._getFilePath(a.source);this.loadFile(n,this.parseTSX.bind(this,n,e,s,t))}return}}e()},parseTSX:function(t,e,i,s,a){a.responseText&&404!==a.status||e("Error loading TSX "+t);var r=a.responseXML;if(!r||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)if("function"==typeof window.DOMParser){r=(new DOMParser).parseFromString(a.responseText,"text/xml")}else{var n=document.createElement("div");n.innerHTML=a.responseText,r=n}var h=r.getElementsByTagName("tileset");if(h.length){var o=h[0].getElementsByTagName("image"),l=game.json[s];if(o.length){var g=o[0].getAttribute("source");l.tilesets[i].image=g,l.tilesets[i].imagewidth=parseInt(o[0].getAttribute("width")),l.tilesets[i].imageheight=parseInt(o[0].getAttribute("height")),l.tilesets[i].tilewidth=parseInt(h[0].getAttribute("tilewidth")),l.tilesets[i].tileheight=parseInt(h[0].getAttribute("tileheight")),l.tilesets[i].spacing=parseInt(h[0].getAttribute("spacing")),l.tilesets[i].margin=parseInt(h[0].getAttribute("margin"));var d=game._getFilePath(g);return game.paths[g]=d,void this.loadImage(d,this.loadTilesets.bind(this,s,e))}}e("Error parsing TSX "+t)},parseJSON:function(t,e,i){var s=e,a=this;e=function(e){if(e)return s(e);JSON.parse(i.responseText).tilesets?a.loadTilesets(t,s):s()},this.super(t,e,i)}}),this.version="1.1.0"});game.module("plugin.essentials").require("engine.renderer.container","engine.renderer.sprite","engine.renderer.text").body(function(){this.version="1.3.0",game.isStarted||(game.createClass("Button",{callback:null,clickSound:null,disableAlpha:.5,fadeSpeed:500,rotateAmount:.1,rotateEasing:"Quadratic.InOut",rotateSpeed:1e3,scaleAmount:.1,scaleEasing:"Back.Out",scaleSound:null,scaleSpeed:250,staticInit:function(t,e,i,s){this.sprite=new game.Sprite(t),this.sprite.anchorCenter(),this.sprite.position.set(e,i),this.sprite.interactive=!0,this.sprite.mousedown=this._mousedown.bind(this),this.sprite.mouseup=this.sprite.mouseupoutside=this._mouseup.bind(this),this.sprite.click=this._click.bind(this),this.sprite.buttonMode=!0,this.callback=s,this.clickSound=game.Button.clickSound,this.scaleSound=game.Button.scaleSound},addTo:function(t){t.addChild(this.sprite)},disable:function(){this.sprite.alpha=this.disableAlpha,this.sprite.interactive=!1},enable:function(){this.sprite.alpha=1,this.sprite.interactive=!0},fadeIn:function(t){t=t||0,this.sprite.alpha=0,this.sprite.visible=!0,game.Tween.add(this.sprite,{alpha:1},this.fadeSpeed,{delay:t,onComplete:this._fadeInComplete.bind(this)}).start()},fadeOut:function(t,e){t=t||0,this.sprite.alpha=1,this.sprite.interactive=!1,game.Tween.add(this.sprite,{alpha:0},this.fadeSpeed,{delay:t,onComplete:this._fadeOutComplete.bind(this,e)}).start()},remove:function(){this.sprite.remove(),this.rotateTween&&this.rotateTween.stop()},rotate:function(t){this.sprite.rotation=-this.rotateAmount,this.rotateTween=game.Tween.add(this.sprite,{rotation:this.rotateAmount},this.rotateSpeed,{repeat:1/0,yoyo:!0,easing:this.rotateEasing}).start(),t&&(this.rotateTween.currentTime=this.rotateTween.duration.random())},scaleIn:function(t){this.sprite.interactive=!1,t=t||0,this.sprite.scale.set(0),game.Tween.add(this.sprite.scale,{x:1,y:1},this.scaleSpeed,{easing:this.scaleEasing,delay:t,onStart:this._onScaleInStart.bind(this),onComplete:this._scaleInEnd.bind(this)}).start()},_click:function(){this.sprite.alpha<1||(this.clickSound&&game.audio.playSound(this.clickSound),"function"==typeof this.callback&&this.callback())},_fadeOutComplete:function(t){t&&(this.sprite.visible=!1)},_fadeInComplete:function(){this.sprite.interactive=!0},_mousedown:function(){this.sprite.alpha<1||this.sprite.scale.set(1-this.scaleAmount)},_mouseup:function(){this.sprite.scale.set(1)},_onScaleInStart:function(){this.scaleSound&&game.audio.playSound(this.scaleSound)},_scaleInEnd:function(){this.sprite.interactive=!0}}),game.addAttributes("Button",{clickSound:null,scaleSound:null}),game.createClass("Fader",{color:"#000",delay:0,speed:500,sprite:null,target:null,staticInit:function(t){game.merge(this,t),this.sprite=new game.Graphics,this.sprite.drawRect(0,0,game.width,game.height)},fadeIn:function(t){this.sprite.shapes[0].fillColor=this.color,this.sprite.addTo(this.target||game.scene.stage),this.sprite.alpha=1,game.Tween.add(this.sprite,{alpha:0},this.speed,{delay:this.delay,onComplete:this._fadeInComplete.bind(this,t)}).start()},fadeOut:function(t){this.sprite.shapes[0].fillColor=this.color,this.sprite.addTo(this.target||game.scene.stage),this.sprite.alpha=0,game.Tween.add(this.sprite,{alpha:1},this.speed,{delay:this.delay,onComplete:this._fadeOutComplete.bind(this,t)}).start()},_fadeInComplete:function(t){this.sprite.remove(),"function"==typeof t&&t()},_fadeOutComplete:function(t){"function"==typeof t&&t()}}),game.createClass("IconButton","Button",{staticInit:function(t,e,i,s,a){this.super(t,i,s,a),this.icon=new game.Sprite(e),this.icon.anchorCenter(),this.icon.addTo(this.sprite)},setIcon:function(t){this.icon.setTexture(t),this.icon.anchorCenter()}}),game.createClass("TextButton","Button",{staticInit:function(t,e,i,s,a,h){this.super(t,i,s,a),this.text=new game.Text(e,h),this.text.anchorCenter(),this.text.addTo(this.sprite)}}),game.createClass("CircleText","Text",{radius:100,speed:1,_count:0,update:function(){this._count+=this.speed*game.delta;for(var t=2*Math.PI/this.children.length,e=0,i=0;i<this.children.length;i++){var s=this.children[i];s.x=this.radius*Math.cos(e+this._count),s.y=this.radius*Math.sin(e+this._count),e+=t}}}),game.createClass("WaveText","Text",{advance:3,amount:10,speed:10,_count:0,_pos:[],_generateText:function(t){this.super(t),this._pos.length=0;for(var e=0;e<this.children.length;e++){var i=this.children[e];this._pos.push(i.y)}},update:function(){this._count+=50*game.delta;for(var t=0;t<this.children.length;t++){var e=this.children[t],i=(this._count+t*this.advance)/this.speed;e.y=this._pos[t]+Math.sin(i)*this.amount}}}),game.Container.inject({shake:function(t,e,i,s){this._shakePos&&this.position.copy(this._shakePos),this._shakePos=this.position.clone(),this._shakeAmount=t||10,this._shakeSpeed=e||100,this._shakeSpeedTimer=this._shakeSpeed,this._shakeDuration=i||1e3,this._shakeDurationTimer=0,this._shakeCallback=s},updateTransform:function(){this._shakeDurationTimer<this._shakeDuration&&(this._shakeDurationTimer+=1e3*game.delta,this._shakeDurationTimer>=this._shakeDuration?(this.position.copy(this._shakePos),this._shakePos=null,"function"==typeof this._shakeCallback&&this._shakeCallback()):(this.x=this._shakePos.x+Math.random(-this._shakeAmount,this._shakeAmount),this.y=this._shakePos.y+Math.random(-this._shakeAmount,this._shakeAmount))),this.super()}}),game.Sprite.inject({_flashTextures:{},blink:function(t,e,i){this._blinkCounter=0,this._blinkCount=e||1,this._blinkCallback=i,this._blinkSpeed=t||100,this._blinkTimer=0},flash:function(t,e,i,s,a,h,n){this._flashTextures[e]?this._flashTexture=this._flashTextures[e]:(this._flashDuration=0,this._flashTexture=this._generateTintedTexture(e||"#ffffff"),this._flashTextures[e]=this._flashTexture),this._flashTexture.position.x=s||0,this._flashTexture.position.y=a||0,this._flashTexture.width=h?this._flashTexture.baseTexture.width-h-s:this._flashTexture.baseTexture.width,this._flashTexture.height=n?this._flashTexture.baseTexture.height-n-a:this._flashTexture.baseTexture.height,this._flashDuration=t||100,this._flashDurationTimer=0,this._flashCallback=i},_renderCanvas:function(t,e,i,s){if(this._blinkCount&&this._blinkCounter<this._blinkCount){if(this._blinkTimer+=1e3*game.delta,this._blinkTimer<this._blinkSpeed)return;this._blinkTimer>=this._blinkSpeed&&this._blinkCounter===this._blinkCount-1&&(this._blinkCount=0,"function"==typeof this._blinkCallback&&this._blinkCallback()),this._blinkTimer>=2*this._blinkSpeed&&(this._blinkTimer=0,this._blinkCounter++)}if(!this.super(t,e,i,s)&&this._flashDurationTimer<this._flashDuration){if(this._flashDurationTimer+=1e3*game.delta,this._flashDurationTimer>=this._flashDuration)return void("function"==typeof this._flashCallback&&this._flashCallback());var a=1-this._flashDurationTimer/this._flashDuration,h=this._flashTexture;t.globalAlpha=a,t.drawImage(h.baseTexture.source,h.position.x,h.position.y,h.width,h.height,h.position.x,h.position.y,h.width,h.height)}}}))});game.module("plugin.spine").require("engine.renderer.core","engine.loader").body(function(){if(this.version="1.3.1",!game.isStarted){var t,e,n,r=this&&this.__extends||(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});!function(t){var e,n,a,i=function(){function t(t,e,n){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.duration=n}return t.prototype.apply=function(t,e,n,r,a,i,o,s){if(null==t)throw new Error("skeleton cannot be null.");r&&0!=this.duration&&(n%=this.duration,e>0&&(e%=this.duration));for(var h=this.timelines,l=0,u=h.length;l<u;l++)h[l].apply(t,e,n,a,i,o,s)},t.binarySearch=function(t,e,n){void 0===n&&(n=1);var r=0,a=t.length/n-2;if(0==a)return n;for(var i=a>>>1;;){if(t[(i+1)*n]<=e?r=i+1:a=i,r==a)return(r+1)*n;i=r+a>>>1}},t.linearSearch=function(t,e,n){for(var r=0,a=t.length-n;r<=a;r+=n)if(t[r]>e)return r;return-1},t}();t.Animation=i,function(t){t[t.setup=0]="setup",t[t.current=1]="current",t[t.currentLayered=2]="currentLayered"}(e=t.MixPose||(t.MixPose={})),function(t){t[t.in=0]="in",t[t.out=1]="out"}(n=t.MixDirection||(t.MixDirection={})),function(t){t[t.rotate=0]="rotate",t[t.translate=1]="translate",t[t.scale=2]="scale",t[t.shear=3]="shear",t[t.attachment=4]="attachment",t[t.color=5]="color",t[t.deform=6]="deform",t[t.event=7]="event",t[t.drawOrder=8]="drawOrder",t[t.ikConstraint=9]="ikConstraint",t[t.transformConstraint=10]="transformConstraint",t[t.pathConstraintPosition=11]="pathConstraintPosition",t[t.pathConstraintSpacing=12]="pathConstraintSpacing",t[t.pathConstraintMix=13]="pathConstraintMix",t[t.twoColor=14]="twoColor"}(a=t.TimelineType||(t.TimelineType={}));var o=function(){function e(n){if(n<=0)throw new Error("frameCount must be > 0: "+n);this.curves=t.Utils.newFloatArray((n-1)*e.BEZIER_SIZE)}return e.prototype.getFrameCount=function(){return this.curves.length/e.BEZIER_SIZE+1},e.prototype.setLinear=function(t){this.curves[t*e.BEZIER_SIZE]=e.LINEAR},e.prototype.setStepped=function(t){this.curves[t*e.BEZIER_SIZE]=e.STEPPED},e.prototype.getCurveType=function(t){var n=t*e.BEZIER_SIZE;if(n==this.curves.length)return e.LINEAR;var r=this.curves[n];return r==e.LINEAR?e.LINEAR:r==e.STEPPED?e.STEPPED:e.BEZIER},e.prototype.setCurve=function(t,n,r,a,i){var o=.03*(2*-n+a),s=.03*(2*-r+i),h=.006*(3*(n-a)+1),l=.006*(3*(r-i)+1),u=2*o+h,c=2*s+l,f=.3*n+o+.16666667*h,p=.3*r+s+.16666667*l,d=t*e.BEZIER_SIZE,m=this.curves;m[d++]=e.BEZIER;for(var g=f,v=p,y=d+e.BEZIER_SIZE-1;d<y;d+=2)m[d]=g,m[d+1]=v,f+=u,p+=c,u+=h,c+=l,g+=f,v+=p},e.prototype.getCurvePercent=function(n,r){r=t.MathUtils.clamp(r,0,1);var a=this.curves,i=n*e.BEZIER_SIZE,o=a[i];if(o==e.LINEAR)return r;if(o==e.STEPPED)return 0;for(var s=0,h=++i,l=i+e.BEZIER_SIZE-1;i<l;i+=2)if((s=a[i])>=r){var u=void 0,c=void 0;return i==h?(u=0,c=0):(u=a[i-2],c=a[i-1]),c+(a[i+1]-c)*(r-u)/(s-u)}var f=a[i-1];return f+(1-f)*(r-s)/(1-s)},e}();o.LINEAR=0,o.STEPPED=1,o.BEZIER=2,o.BEZIER_SIZE=19,t.CurveTimeline=o;var s=function(n){function o(e){var r=n.call(this,e)||this;return r.frames=t.Utils.newFloatArray(e<<1),r}return r(o,n),o.prototype.getPropertyId=function(){return(a.rotate<<24)+this.boneIndex},o.prototype.setFrame=function(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+o.ROTATION]=n},o.prototype.apply=function(t,n,r,a,s,h,l){var u=this.frames,c=t.bones[this.boneIndex];if(r<u[0])switch(h){case e.setup:return void(c.rotation=c.data.rotation);case e.current:var f=c.data.rotation-c.rotation;f-=360*(16384-(16384.499999999996-f/360|0)),c.rotation+=f*s}else if(r>=u[u.length-o.ENTRIES])if(h==e.setup)c.rotation=c.data.rotation+u[u.length+o.PREV_ROTATION]*s;else{var p=c.data.rotation+u[u.length+o.PREV_ROTATION]-c.rotation;p-=360*(16384-(16384.499999999996-p/360|0)),c.rotation+=p*s}else{var d=i.binarySearch(u,r,o.ENTRIES),m=u[d+o.PREV_ROTATION],g=u[d],v=this.getCurvePercent((d>>1)-1,1-(r-g)/(u[d+o.PREV_TIME]-g)),y=u[d+o.ROTATION]-m;y=m+(y-=360*(16384-(16384.499999999996-y/360|0)))*v,h==e.setup?(y-=360*(16384-(16384.499999999996-y/360|0)),c.rotation=c.data.rotation+y*s):(y=c.data.rotation+y-c.rotation,y-=360*(16384-(16384.499999999996-y/360|0)),c.rotation+=y*s)}},o}(o);s.ENTRIES=2,s.PREV_TIME=-2,s.PREV_ROTATION=-1,s.ROTATION=1,t.RotateTimeline=s;var h=function(n){function o(e){var r=n.call(this,e)||this;return r.frames=t.Utils.newFloatArray(e*o.ENTRIES),r}return r(o,n),o.prototype.getPropertyId=function(){return(a.translate<<24)+this.boneIndex},o.prototype.setFrame=function(t,e,n,r){t*=o.ENTRIES,this.frames[t]=e,this.frames[t+o.X]=n,this.frames[t+o.Y]=r},o.prototype.apply=function(t,n,r,a,s,h,l){var u=this.frames,c=t.bones[this.boneIndex];if(r<u[0])switch(h){case e.setup:return c.x=c.data.x,void(c.y=c.data.y);case e.current:c.x+=(c.data.x-c.x)*s,c.y+=(c.data.y-c.y)*s}else{var f=0,p=0;if(r>=u[u.length-o.ENTRIES])f=u[u.length+o.PREV_X],p=u[u.length+o.PREV_Y];else{var d=i.binarySearch(u,r,o.ENTRIES);f=u[d+o.PREV_X],p=u[d+o.PREV_Y];var m=u[d],g=this.getCurvePercent(d/o.ENTRIES-1,1-(r-m)/(u[d+o.PREV_TIME]-m));f+=(u[d+o.X]-f)*g,p+=(u[d+o.Y]-p)*g}h==e.setup?(c.x=c.data.x+f*s,c.y=c.data.y+p*s):(c.x+=(c.data.x+f-c.x)*s,c.y+=(c.data.y+p-c.y)*s)}},o}(o);h.ENTRIES=3,h.PREV_TIME=-3,h.PREV_X=-2,h.PREV_Y=-1,h.X=1,h.Y=2,t.TranslateTimeline=h;var l=function(o){function s(t){return o.call(this,t)||this}return r(s,o),s.prototype.getPropertyId=function(){return(a.scale<<24)+this.boneIndex},s.prototype.apply=function(r,a,o,h,l,u,c){var f=this.frames,p=r.bones[this.boneIndex];if(o<f[0])switch(u){case e.setup:return p.scaleX=p.data.scaleX,void(p.scaleY=p.data.scaleY);case e.current:p.scaleX+=(p.data.scaleX-p.scaleX)*l,p.scaleY+=(p.data.scaleY-p.scaleY)*l}else{var d=0,m=0;if(o>=f[f.length-s.ENTRIES])d=f[f.length+s.PREV_X]*p.data.scaleX,m=f[f.length+s.PREV_Y]*p.data.scaleY;else{var g=i.binarySearch(f,o,s.ENTRIES);d=f[g+s.PREV_X],m=f[g+s.PREV_Y];var v=f[g],y=this.getCurvePercent(g/s.ENTRIES-1,1-(o-v)/(f[g+s.PREV_TIME]-v));d=(d+(f[g+s.X]-d)*y)*p.data.scaleX,m=(m+(f[g+s.Y]-m)*y)*p.data.scaleY}if(1==l)p.scaleX=d,p.scaleY=m;else{var w=0,x=0;u==e.setup?(w=p.data.scaleX,x=p.data.scaleY):(w=p.scaleX,x=p.scaleY),c==n.out?(d=Math.abs(d)*t.MathUtils.signum(w),m=Math.abs(m)*t.MathUtils.signum(x)):(w=Math.abs(w)*t.MathUtils.signum(d),x=Math.abs(x)*t.MathUtils.signum(m)),p.scaleX=w+(d-w)*l,p.scaleY=x+(m-x)*l}}},s}(h);t.ScaleTimeline=l;var u=function(t){function n(e){return t.call(this,e)||this}return r(n,t),n.prototype.getPropertyId=function(){return(a.shear<<24)+this.boneIndex},n.prototype.apply=function(t,r,a,o,s,h,l){var u=this.frames,c=t.bones[this.boneIndex];if(a<u[0])switch(h){case e.setup:return c.shearX=c.data.shearX,void(c.shearY=c.data.shearY);case e.current:c.shearX+=(c.data.shearX-c.shearX)*s,c.shearY+=(c.data.shearY-c.shearY)*s}else{var f=0,p=0;if(a>=u[u.length-n.ENTRIES])f=u[u.length+n.PREV_X],p=u[u.length+n.PREV_Y];else{var d=i.binarySearch(u,a,n.ENTRIES);f=u[d+n.PREV_X],p=u[d+n.PREV_Y];var m=u[d],g=this.getCurvePercent(d/n.ENTRIES-1,1-(a-m)/(u[d+n.PREV_TIME]-m));f+=(u[d+n.X]-f)*g,p+=(u[d+n.Y]-p)*g}h==e.setup?(c.shearX=c.data.shearX+f*s,c.shearY=c.data.shearY+p*s):(c.shearX+=(c.data.shearX+f-c.shearX)*s,c.shearY+=(c.data.shearY+p-c.shearY)*s)}},n}(h);t.ShearTimeline=u;var c=function(n){function o(e){var r=n.call(this,e)||this;return r.frames=t.Utils.newFloatArray(e*o.ENTRIES),r}return r(o,n),o.prototype.getPropertyId=function(){return(a.color<<24)+this.slotIndex},o.prototype.setFrame=function(t,e,n,r,a,i){t*=o.ENTRIES,this.frames[t]=e,this.frames[t+o.R]=n,this.frames[t+o.G]=r,this.frames[t+o.B]=a,this.frames[t+o.A]=i},o.prototype.apply=function(t,n,r,a,s,h,l){var u=t.slots[this.slotIndex],c=this.frames;if(r<c[0])switch(h){case e.setup:return void u.color.setFromColor(u.data.color);case e.current:var f=u.color,p=u.data.color;f.add((p.r-f.r)*s,(p.g-f.g)*s,(p.b-f.b)*s,(p.a-f.a)*s)}else{var d=0,m=0,g=0,v=0;if(r>=c[c.length-o.ENTRIES]){var y=c.length;d=c[y+o.PREV_R],m=c[y+o.PREV_G],g=c[y+o.PREV_B],v=c[y+o.PREV_A]}else{var w=i.binarySearch(c,r,o.ENTRIES);d=c[w+o.PREV_R],m=c[w+o.PREV_G],g=c[w+o.PREV_B],v=c[w+o.PREV_A];var x=c[w],M=this.getCurvePercent(w/o.ENTRIES-1,1-(r-x)/(c[w+o.PREV_TIME]-x));d+=(c[w+o.R]-d)*M,m+=(c[w+o.G]-m)*M,g+=(c[w+o.B]-g)*M,v+=(c[w+o.A]-v)*M}if(1==s)u.color.set(d,m,g,v);else{f=u.color;h==e.setup&&f.setFromColor(u.data.color),f.add((d-f.r)*s,(m-f.g)*s,(g-f.b)*s,(v-f.a)*s)}}},o}(o);c.ENTRIES=5,c.PREV_TIME=-5,c.PREV_R=-4,c.PREV_G=-3,c.PREV_B=-2,c.PREV_A=-1,c.R=1,c.G=2,c.B=3,c.A=4,t.ColorTimeline=c;var f=function(n){function o(e){var r=n.call(this,e)||this;return r.frames=t.Utils.newFloatArray(e*o.ENTRIES),r}return r(o,n),o.prototype.getPropertyId=function(){return(a.twoColor<<24)+this.slotIndex},o.prototype.setFrame=function(t,e,n,r,a,i,s,h,l){t*=o.ENTRIES,this.frames[t]=e,this.frames[t+o.R]=n,this.frames[t+o.G]=r,this.frames[t+o.B]=a,this.frames[t+o.A]=i,this.frames[t+o.R2]=s,this.frames[t+o.G2]=h,this.frames[t+o.B2]=l},o.prototype.apply=function(t,n,r,a,s,h,l){var u=t.slots[this.slotIndex],c=this.frames;if(r<c[0])switch(h){case e.setup:return u.color.setFromColor(u.data.color),void u.darkColor.setFromColor(u.data.darkColor);case e.current:var f=u.color,p=u.darkColor,d=u.data.color,m=u.data.darkColor;f.add((d.r-f.r)*s,(d.g-f.g)*s,(d.b-f.b)*s,(d.a-f.a)*s),p.add((m.r-p.r)*s,(m.g-p.g)*s,(m.b-p.b)*s,0)}else{var g=0,v=0,y=0,w=0,x=0,M=0,E=0;if(r>=c[c.length-o.ENTRIES]){var T=c.length;g=c[T+o.PREV_R],v=c[T+o.PREV_G],y=c[T+o.PREV_B],w=c[T+o.PREV_A],x=c[T+o.PREV_R2],M=c[T+o.PREV_G2],E=c[T+o.PREV_B2]}else{var A=i.binarySearch(c,r,o.ENTRIES);g=c[A+o.PREV_R],v=c[A+o.PREV_G],y=c[A+o.PREV_B],w=c[A+o.PREV_A],x=c[A+o.PREV_R2],M=c[A+o.PREV_G2],E=c[A+o.PREV_B2];var b=c[A],R=this.getCurvePercent(A/o.ENTRIES-1,1-(r-b)/(c[A+o.PREV_TIME]-b));g+=(c[A+o.R]-g)*R,v+=(c[A+o.G]-v)*R,y+=(c[A+o.B]-y)*R,w+=(c[A+o.A]-w)*R,x+=(c[A+o.R2]-x)*R,M+=(c[A+o.G2]-M)*R,E+=(c[A+o.B2]-E)*R}if(1==s)u.color.set(g,v,y,w),u.darkColor.set(x,M,E,1);else{f=u.color,p=u.darkColor;h==e.setup&&(f.setFromColor(u.data.color),p.setFromColor(u.data.darkColor)),f.add((g-f.r)*s,(v-f.g)*s,(y-f.b)*s,(w-f.a)*s),p.add((x-p.r)*s,(M-p.g)*s,(E-p.b)*s,0)}}},o}(o);f.ENTRIES=8,f.PREV_TIME=-8,f.PREV_R=-7,f.PREV_G=-6,f.PREV_B=-5,f.PREV_A=-4,f.PREV_R2=-3,f.PREV_G2=-2,f.PREV_B2=-1,f.R=1,f.G=2,f.B=3,f.A=4,f.R2=5,f.G2=6,f.B2=7,t.TwoColorTimeline=f;var p=function(){function r(e){this.frames=t.Utils.newFloatArray(e),this.attachmentNames=new Array(e)}return r.prototype.getPropertyId=function(){return(a.attachment<<24)+this.slotIndex},r.prototype.getFrameCount=function(){return this.frames.length},r.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n},r.prototype.apply=function(t,r,a,o,s,h,l){var u=t.slots[this.slotIndex];if(l!=n.out||h!=e.setup){var c=this.frames;if(a<c[0]){if(h==e.setup){var f=u.data.attachmentName;u.setAttachment(null==f?null:t.getAttachment(this.slotIndex,f))}}else{var p=0;p=a>=c[c.length-1]?c.length-1:i.binarySearch(c,a,1)-1;var d=this.attachmentNames[p];t.slots[this.slotIndex].setAttachment(null==d?null:t.getAttachment(this.slotIndex,d))}}else{var m=u.data.attachmentName;u.setAttachment(null==m?null:t.getAttachment(this.slotIndex,m))}},r}();t.AttachmentTimeline=p;var d=null,m=function(n){function o(e){var r=n.call(this,e)||this;return r.frames=t.Utils.newFloatArray(e),r.frameVertices=new Array(e),null==d&&(d=t.Utils.newFloatArray(64)),r}return r(o,n),o.prototype.getPropertyId=function(){return(a.deform<<27)+ +this.attachment.id+this.slotIndex},o.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.frameVertices[t]=n},o.prototype.apply=function(n,r,a,o,s,h,l){var u=n.slots[this.slotIndex],c=u.getAttachment();if(c instanceof t.VertexAttachment&&c.applyDeform(this.attachment)){var f=u.attachmentVertices;0==f.length&&(s=1);var p=this.frameVertices,d=p[0].length,m=this.frames;if(a<m[0]){var g=c;switch(h){case e.setup:return void(f.length=0);case e.current:if(1==s){f.length=0;break}var v=t.Utils.setArraySize(f,d);if(null==g.bones)for(var y=g.vertices,w=0;w<d;w++)v[w]+=(y[w]-v[w])*s;else{s=1-s;for(w=0;w<d;w++)v[w]*=s}}}else{var x=t.Utils.setArraySize(f,d);if(a>=m[m.length-1]){var M=p[m.length-1];if(1==s)t.Utils.arrayCopy(M,0,x,0,d);else if(h==e.setup){if(null==(g=c).bones)for(var E=g.vertices,T=0;T<d;T++){var A=E[T];x[T]=A+(M[T]-A)*s}else for(var b=0;b<d;b++)x[b]=M[b]*s}else for(var R=0;R<d;R++)x[R]+=(M[R]-x[R])*s}else{var S=i.binarySearch(m,a),I=p[S-1],P=p[S],C=m[S],V=this.getCurvePercent(S-1,1-(a-C)/(m[S-1]-C));if(1==s)for(var k=0;k<d;k++){var N=I[k];x[k]=N+(P[k]-N)*V}else if(h==e.setup){if(null==(g=c).bones)for(var Y=g.vertices,_=0;_<d;_++){N=I[_],A=Y[_];x[_]=A+(N+(P[_]-N)*V-A)*s}else for(var D=0;D<d;D++){N=I[D];x[D]=(N+(P[D]-N)*V)*s}}else for(var X=0;X<d;X++){N=I[X];x[X]+=(N+(P[X]-N)*V-x[X])*s}}}}},o}(o);t.DeformTimeline=m;var g=function(){function e(e){this.frames=t.Utils.newFloatArray(e),this.events=new Array(e)}return e.prototype.getPropertyId=function(){return a.event<<24},e.prototype.getFrameCount=function(){return this.frames.length},e.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},e.prototype.apply=function(t,e,n,r,a,o,s){if(null!=r){var h=this.frames,l=this.frames.length;if(e>n)this.apply(t,e,Number.MAX_VALUE,r,a,o,s),e=-1;else if(e>=h[l-1])return;if(!(n<h[0])){var u=0;if(e<h[0])u=0;else for(var c=h[u=i.binarySearch(h,e)];u>0&&h[u-1]==c;)u--;for(;u<l&&n>=h[u];u++)r.push(this.events[u])}}},e}();t.EventTimeline=g;var v=function(){function r(e){this.frames=t.Utils.newFloatArray(e),this.drawOrders=new Array(e)}return r.prototype.getPropertyId=function(){return a.drawOrder<<24},r.prototype.getFrameCount=function(){return this.frames.length},r.prototype.setFrame=function(t,e,n){this.frames[t]=e,this.drawOrders[t]=n},r.prototype.apply=function(r,a,o,s,h,l,u){var c=r.drawOrder,f=r.slots;if(u!=n.out||l!=e.setup){var p=this.frames;if(o<p[0])l==e.setup&&t.Utils.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length);else{var d=0;d=o>=p[p.length-1]?p.length-1:i.binarySearch(p,o)-1;var m=this.drawOrders[d];if(null==m)t.Utils.arrayCopy(f,0,c,0,f.length);else for(var g=0,v=m.length;g<v;g++)c[g]=f[m[g]]}}else t.Utils.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length)},r}();t.DrawOrderTimeline=v;var y=function(o){function s(e){var n=o.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*s.ENTRIES),n}return r(s,o),s.prototype.getPropertyId=function(){return(a.ikConstraint<<24)+this.ikConstraintIndex},s.prototype.setFrame=function(t,e,n,r){t*=s.ENTRIES,this.frames[t]=e,this.frames[t+s.MIX]=n,this.frames[t+s.BEND_DIRECTION]=r},s.prototype.apply=function(t,r,a,o,h,l,u){var c=this.frames,f=t.ikConstraints[this.ikConstraintIndex];if(a<c[0])switch(l){case e.setup:return f.mix=f.data.mix,void(f.bendDirection=f.data.bendDirection);case e.current:f.mix+=(f.data.mix-f.mix)*h,f.bendDirection=f.data.bendDirection}else if(a>=c[c.length-s.ENTRIES])l==e.setup?(f.mix=f.data.mix+(c[c.length+s.PREV_MIX]-f.data.mix)*h,f.bendDirection=u==n.out?f.data.bendDirection:c[c.length+s.PREV_BEND_DIRECTION]):(f.mix+=(c[c.length+s.PREV_MIX]-f.mix)*h,u==n.in&&(f.bendDirection=c[c.length+s.PREV_BEND_DIRECTION]));else{var p=i.binarySearch(c,a,s.ENTRIES),d=c[p+s.PREV_MIX],m=c[p],g=this.getCurvePercent(p/s.ENTRIES-1,1-(a-m)/(c[p+s.PREV_TIME]-m));l==e.setup?(f.mix=f.data.mix+(d+(c[p+s.MIX]-d)*g-f.data.mix)*h,f.bendDirection=u==n.out?f.data.bendDirection:c[p+s.PREV_BEND_DIRECTION]):(f.mix+=(d+(c[p+s.MIX]-d)*g-f.mix)*h,u==n.in&&(f.bendDirection=c[p+s.PREV_BEND_DIRECTION]))}},s}(o);y.ENTRIES=3,y.PREV_TIME=-3,y.PREV_MIX=-2,y.PREV_BEND_DIRECTION=-1,y.MIX=1,y.BEND_DIRECTION=2,t.IkConstraintTimeline=y;var w=function(n){function o(e){var r=n.call(this,e)||this;return r.frames=t.Utils.newFloatArray(e*o.ENTRIES),r}return r(o,n),o.prototype.getPropertyId=function(){return(a.transformConstraint<<24)+this.transformConstraintIndex},o.prototype.setFrame=function(t,e,n,r,a,i){t*=o.ENTRIES,this.frames[t]=e,this.frames[t+o.ROTATE]=n,this.frames[t+o.TRANSLATE]=r,this.frames[t+o.SCALE]=a,this.frames[t+o.SHEAR]=i},o.prototype.apply=function(t,n,r,a,s,h,l){var u=this.frames,c=t.transformConstraints[this.transformConstraintIndex];if(r<u[0]){var f=c.data;switch(h){case e.setup:return c.rotateMix=f.rotateMix,c.translateMix=f.translateMix,c.scaleMix=f.scaleMix,void(c.shearMix=f.shearMix);case e.current:c.rotateMix+=(f.rotateMix-c.rotateMix)*s,c.translateMix+=(f.translateMix-c.translateMix)*s,c.scaleMix+=(f.scaleMix-c.scaleMix)*s,c.shearMix+=(f.shearMix-c.shearMix)*s}}else{var p=0,d=0,m=0,g=0;if(r>=u[u.length-o.ENTRIES]){var v=u.length;p=u[v+o.PREV_ROTATE],d=u[v+o.PREV_TRANSLATE],m=u[v+o.PREV_SCALE],g=u[v+o.PREV_SHEAR]}else{var y=i.binarySearch(u,r,o.ENTRIES);p=u[y+o.PREV_ROTATE],d=u[y+o.PREV_TRANSLATE],m=u[y+o.PREV_SCALE],g=u[y+o.PREV_SHEAR];var w=u[y],x=this.getCurvePercent(y/o.ENTRIES-1,1-(r-w)/(u[y+o.PREV_TIME]-w));p+=(u[y+o.ROTATE]-p)*x,d+=(u[y+o.TRANSLATE]-d)*x,m+=(u[y+o.SCALE]-m)*x,g+=(u[y+o.SHEAR]-g)*x}if(h==e.setup){f=c.data;c.rotateMix=f.rotateMix+(p-f.rotateMix)*s,c.translateMix=f.translateMix+(d-f.translateMix)*s,c.scaleMix=f.scaleMix+(m-f.scaleMix)*s,c.shearMix=f.shearMix+(g-f.shearMix)*s}else c.rotateMix+=(p-c.rotateMix)*s,c.translateMix+=(d-c.translateMix)*s,c.scaleMix+=(m-c.scaleMix)*s,c.shearMix+=(g-c.shearMix)*s}},o}(o);w.ENTRIES=5,w.PREV_TIME=-5,w.PREV_ROTATE=-4,w.PREV_TRANSLATE=-3,w.PREV_SCALE=-2,w.PREV_SHEAR=-1,w.ROTATE=1,w.TRANSLATE=2,w.SCALE=3,w.SHEAR=4,t.TransformConstraintTimeline=w;var x=function(n){function o(e){var r=n.call(this,e)||this;return r.frames=t.Utils.newFloatArray(e*o.ENTRIES),r}return r(o,n),o.prototype.getPropertyId=function(){return(a.pathConstraintPosition<<24)+this.pathConstraintIndex},o.prototype.setFrame=function(t,e,n){t*=o.ENTRIES,this.frames[t]=e,this.frames[t+o.VALUE]=n},o.prototype.apply=function(t,n,r,a,s,h,l){var u=this.frames,c=t.pathConstraints[this.pathConstraintIndex];if(r<u[0])switch(h){case e.setup:return void(c.position=c.data.position);case e.current:c.position+=(c.data.position-c.position)*s}else{var f=0;if(r>=u[u.length-o.ENTRIES])f=u[u.length+o.PREV_VALUE];else{var p=i.binarySearch(u,r,o.ENTRIES);f=u[p+o.PREV_VALUE];var d=u[p],m=this.getCurvePercent(p/o.ENTRIES-1,1-(r-d)/(u[p+o.PREV_TIME]-d));f+=(u[p+o.VALUE]-f)*m}h==e.setup?c.position=c.data.position+(f-c.data.position)*s:c.position+=(f-c.position)*s}},o}(o);x.ENTRIES=2,x.PREV_TIME=-2,x.PREV_VALUE=-1,x.VALUE=1,t.PathConstraintPositionTimeline=x;var M=function(t){function n(e){return t.call(this,e)||this}return r(n,t),n.prototype.getPropertyId=function(){return(a.pathConstraintSpacing<<24)+this.pathConstraintIndex},n.prototype.apply=function(t,r,a,o,s,h,l){var u=this.frames,c=t.pathConstraints[this.pathConstraintIndex];if(a<u[0])switch(h){case e.setup:return void(c.spacing=c.data.spacing);case e.current:c.spacing+=(c.data.spacing-c.spacing)*s}else{var f=0;if(a>=u[u.length-n.ENTRIES])f=u[u.length+n.PREV_VALUE];else{var p=i.binarySearch(u,a,n.ENTRIES);f=u[p+n.PREV_VALUE];var d=u[p],m=this.getCurvePercent(p/n.ENTRIES-1,1-(a-d)/(u[p+n.PREV_TIME]-d));f+=(u[p+n.VALUE]-f)*m}h==e.setup?c.spacing=c.data.spacing+(f-c.data.spacing)*s:c.spacing+=(f-c.spacing)*s}},n}(x);t.PathConstraintSpacingTimeline=M;var E=function(n){function o(e){var r=n.call(this,e)||this;return r.frames=t.Utils.newFloatArray(e*o.ENTRIES),r}return r(o,n),o.prototype.getPropertyId=function(){return(a.pathConstraintMix<<24)+this.pathConstraintIndex},o.prototype.setFrame=function(t,e,n,r){t*=o.ENTRIES,this.frames[t]=e,this.frames[t+o.ROTATE]=n,this.frames[t+o.TRANSLATE]=r},o.prototype.apply=function(t,n,r,a,s,h,l){var u=this.frames,c=t.pathConstraints[this.pathConstraintIndex];if(r<u[0])switch(h){case e.setup:return c.rotateMix=c.data.rotateMix,void(c.translateMix=c.data.translateMix);case e.current:c.rotateMix+=(c.data.rotateMix-c.rotateMix)*s,c.translateMix+=(c.data.translateMix-c.translateMix)*s}else{var f=0,p=0;if(r>=u[u.length-o.ENTRIES])f=u[u.length+o.PREV_ROTATE],p=u[u.length+o.PREV_TRANSLATE];else{var d=i.binarySearch(u,r,o.ENTRIES);f=u[d+o.PREV_ROTATE],p=u[d+o.PREV_TRANSLATE];var m=u[d],g=this.getCurvePercent(d/o.ENTRIES-1,1-(r-m)/(u[d+o.PREV_TIME]-m));f+=(u[d+o.ROTATE]-f)*g,p+=(u[d+o.TRANSLATE]-p)*g}h==e.setup?(c.rotateMix=c.data.rotateMix+(f-c.data.rotateMix)*s,c.translateMix=c.data.translateMix+(p-c.data.translateMix)*s):(c.rotateMix+=(f-c.rotateMix)*s,c.translateMix+=(p-c.translateMix)*s)}},o}(o);E.ENTRIES=3,E.PREV_TIME=-3,E.PREV_ROTATE=-2,E.PREV_TRANSLATE=-1,E.ROTATE=1,E.TRANSLATE=2,t.PathConstraintMixTimeline=E}(n||(n={})),function(t){var e=function(){function e(e){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new a(this),this.propertyIDs=new t.IntSet,this.mixingTo=new Array,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new t.Pool(function(){return new n}),this.data=e}return e.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,n=0,r=e.length;n<r;n++){var a=e[n];if(null!=a){a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast;var i=t*a.timeScale;if(a.delay>0){if(a.delay-=i,a.delay>0)continue;i=-a.delay,a.delay=0}var o=a.next;if(null!=o){var s=a.trackLast-o.delay;if(s>=0){for(o.delay=0,o.trackTime=s+t*o.timeScale,a.trackTime+=i,this.setCurrent(n,o,!0);null!=o.mixingFrom;)o.mixTime+=i,o=o.mixingFrom;continue}}else if(a.trackLast>=a.trackEnd&&null==a.mixingFrom){e[n]=null,this.queue.end(a),this.disposeNext(a);continue}if(null!=a.mixingFrom&&this.updateMixingFrom(a,t)){var h=a.mixingFrom;for(a.mixingFrom=null;null!=h;)this.queue.end(h),h=h.mixingFrom}a.trackTime+=i}}this.queue.drain()},e.prototype.updateMixingFrom=function(t,e){var n=t.mixingFrom;if(null==n)return!0;var r=this.updateMixingFrom(n,e);return t.mixTime>0&&(t.mixTime>=t.mixDuration||0==t.timeScale)?(0!=n.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=n.mixingFrom,t.interruptAlpha=n.interruptAlpha,this.queue.end(n)),r):(n.animationLast=n.nextAnimationLast,n.trackLast=n.nextTrackLast,n.trackTime+=e*n.timeScale,t.mixTime+=e*t.timeScale,!1)},e.prototype.apply=function(n){if(null==n)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var r=this.events,a=this.tracks,i=!1,o=0,s=a.length;o<s;o++){var h=a[o];if(!(null==h||h.delay>0)){i=!0;var l=0==o?t.MixPose.current:t.MixPose.currentLayered,u=h.alpha;null!=h.mixingFrom?u*=this.applyMixingFrom(h,n,l):h.trackTime>=h.trackEnd&&null==h.next&&(u=0);var c=h.animationLast,f=h.getAnimationTime(),p=h.animation.timelines.length,d=h.animation.timelines;if(1==u)for(var m=0;m<p;m++)d[m].apply(n,c,f,r,1,t.MixPose.setup,t.MixDirection.in);else{var g=h.timelineData,v=0==h.timelinesRotation.length;v&&t.Utils.setArraySize(h.timelinesRotation,p<<1,null);var y=h.timelinesRotation;for(m=0;m<p;m++){var w=d[m],x=g[m]>=e.FIRST?t.MixPose.setup:l;w instanceof t.RotateTimeline?this.applyRotateTimeline(w,n,f,u,x,y,m<<1,v):w.apply(n,c,f,r,u,x,t.MixDirection.in)}}this.queueEvents(h,f),r.length=0,h.nextAnimationLast=f,h.nextTrackLast=h.trackTime}}return this.queue.drain(),i},e.prototype.applyMixingFrom=function(n,r,a){var i=n.mixingFrom;null!=i.mixingFrom&&this.applyMixingFrom(i,r,a);var o=0;0==n.mixDuration?(o=1,a=t.MixPose.setup):(o=n.mixTime/n.mixDuration)>1&&(o=1);var s=o<i.eventThreshold?this.events:null,h=o<i.attachmentThreshold,l=o<i.drawOrderThreshold,u=i.animationLast,c=i.getAnimationTime(),f=i.animation.timelines.length,p=i.animation.timelines,d=i.timelineData,m=i.timelineDipMix,g=0==i.timelinesRotation.length;g&&t.Utils.setArraySize(i.timelinesRotation,f<<1,null);var v,y=i.timelinesRotation,w=i.alpha*n.interruptAlpha,x=w*(1-o),M=0;i.totalAlpha=0;for(var E=0;E<f;E++){var T=p[E];switch(d[E]){case e.SUBSEQUENT:if(!h&&T instanceof t.AttachmentTimeline)continue;if(!l&&T instanceof t.DrawOrderTimeline)continue;v=a,M=x;break;case e.FIRST:v=t.MixPose.setup,M=x;break;case e.DIP:v=t.MixPose.setup,M=w;break;default:v=t.MixPose.setup,M=w;var A=m[E];M*=Math.max(0,1-A.mixTime/A.mixDuration)}i.totalAlpha+=M,T instanceof t.RotateTimeline?this.applyRotateTimeline(T,r,c,M,v,y,E<<1,g):T.apply(r,u,c,s,M,v,t.MixDirection.out)}return n.mixDuration>0&&this.queueEvents(i,c),this.events.length=0,i.nextAnimationLast=c,i.nextTrackLast=i.trackTime,o},e.prototype.applyRotateTimeline=function(e,n,r,a,i,o,s,h){if(h&&(o[s]=0),1!=a){var l=e,u=l.frames,c=n.bones[l.boneIndex];if(r<u[0])i==t.MixPose.setup&&(c.rotation=c.data.rotation);else{var f=0;if(r>=u[u.length-t.RotateTimeline.ENTRIES])f=c.data.rotation+u[u.length+t.RotateTimeline.PREV_ROTATION];else{var p=t.Animation.binarySearch(u,r,t.RotateTimeline.ENTRIES),d=u[p+t.RotateTimeline.PREV_ROTATION],m=u[p],g=l.getCurvePercent((p>>1)-1,1-(r-m)/(u[p+t.RotateTimeline.PREV_TIME]-m));f=u[p+t.RotateTimeline.ROTATION]-d,f=d+(f-=360*(16384-(16384.499999999996-f/360|0)))*g+c.data.rotation,f-=360*(16384-(16384.499999999996-f/360|0))}var v=i==t.MixPose.setup?c.data.rotation:c.rotation,y=0,w=f-v;if(0==w)y=o[s];else{w-=360*(16384-(16384.499999999996-w/360|0));var x=0,M=0;h?(x=0,M=w):(x=o[s],M=o[s+1]);var E=w>0,T=x>=0;t.MathUtils.signum(M)!=t.MathUtils.signum(w)&&Math.abs(M)<=90&&(Math.abs(x)>180&&(x+=360*t.MathUtils.signum(x)),T=E),y=w+x-x%360,T!=E&&(y+=360*t.MathUtils.signum(x)),o[s]=y}o[s+1]=w,v+=y*a,c.rotation=v-360*(16384-(16384.499999999996-v/360|0))}}else e.apply(n,0,r,null,1,i,t.MixDirection.in)},e.prototype.queueEvents=function(t,e){for(var n=t.animationStart,r=t.animationEnd,a=r-n,i=t.trackLast%a,o=this.events,s=0,h=o.length;s<h;s++){var l=o[s];if(l.time<i)break;l.time>r||this.queue.event(t,l)}for((t.loop?i>t.trackTime%a:e>=r&&t.animationLast<r)&&this.queue.complete(t);s<h;s++){o[s].time<n||this.queue.event(t,o[s])}},e.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,n=this.tracks.length;e<n;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},e.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(null!=e){this.queue.end(e),this.disposeNext(e);for(var n=e;;){var r=n.mixingFrom;if(null==r)break;this.queue.end(r),n.mixingFrom=null,n=r}this.tracks[e.trackIndex]=null,this.queue.drain()}}},e.prototype.setCurrent=function(t,e,n){var r=this.expandToIndex(t);this.tracks[t]=e,null!=r&&(n&&this.queue.interrupt(r),e.mixingFrom=r,e.mixTime=0,null!=r.mixingFrom&&r.mixDuration>0&&(e.interruptAlpha*=Math.min(1,r.mixTime/r.mixDuration)),r.timelinesRotation.length=0),this.queue.start(e)},e.prototype.setAnimation=function(t,e,n){var r=this.data.skeletonData.findAnimation(e);if(null==r)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,r,n)},e.prototype.setAnimationWith=function(t,e,n){if(null==e)throw new Error("animation cannot be null.");var r=!0,a=this.expandToIndex(t);null!=a&&(-1==a.nextTrackLast?(this.tracks[t]=a.mixingFrom,this.queue.interrupt(a),this.queue.end(a),this.disposeNext(a),a=a.mixingFrom,r=!1):this.disposeNext(a));var i=this.trackEntry(t,e,n,a);return this.setCurrent(t,i,r),this.queue.drain(),i},e.prototype.addAnimation=function(t,e,n,r){var a=this.data.skeletonData.findAnimation(e);if(null==a)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,a,n,r)},e.prototype.addAnimationWith=function(t,e,n,r){if(null==e)throw new Error("animation cannot be null.");var a=this.expandToIndex(t);if(null!=a)for(;null!=a.next;)a=a.next;var i=this.trackEntry(t,e,n,a);if(null==a)this.setCurrent(t,i,!0),this.queue.drain();else if(a.next=i,r<=0){var o=a.animationEnd-a.animationStart;0!=o?(a.loop?r+=o*(1+(a.trackTime/o|0)):r+=o,r-=this.data.getMix(a.animation,e)):r=0}return i.delay=r,i},e.prototype.setEmptyAnimation=function(t,n){var r=this.setAnimationWith(t,e.emptyAnimation,!1);return r.mixDuration=n,r.trackEnd=n,r},e.prototype.addEmptyAnimation=function(t,n,r){r<=0&&(r-=n);var a=this.addAnimationWith(t,e.emptyAnimation,!1,r);return a.mixDuration=n,a.trackEnd=n,a},e.prototype.setEmptyAnimations=function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var n=0,r=this.tracks.length;n<r;n++){var a=this.tracks[n];null!=a&&this.setEmptyAnimation(a.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},e.prototype.expandToIndex=function(e){return e<this.tracks.length?this.tracks[e]:(t.Utils.ensureArrayCapacity(this.tracks,e-this.tracks.length+1,null),this.tracks.length=e+1,null)},e.prototype.trackEntry=function(t,e,n,r){var a=this.trackEntryPool.obtain();return a.trackIndex=t,a.animation=e,a.loop=n,a.eventThreshold=0,a.attachmentThreshold=0,a.drawOrderThreshold=0,a.animationStart=0,a.animationEnd=e.duration,a.animationLast=-1,a.nextAnimationLast=-1,a.delay=0,a.trackTime=0,a.trackLast=-1,a.nextTrackLast=-1,a.trackEnd=Number.MAX_VALUE,a.timeScale=1,a.alpha=1,a.interruptAlpha=1,a.mixTime=0,a.mixDuration=null==r?0:this.data.getMix(r.animation,e),a},e.prototype.disposeNext=function(t){for(var e=t.next;null!=e;)this.queue.dispose(e),e=e.next;t.next=null},e.prototype._animationsChanged=function(){this.animationsChanged=!1;var t=this.propertyIDs;t.clear();for(var e=this.mixingTo,n=0,r=this.tracks.length;n<r;n++){var a=this.tracks[n];null!=a&&a.setTimelineData(null,e,t)}},e.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},e.prototype.addListener=function(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)},e.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},e.prototype.clearListeners=function(){this.listeners.length=0},e.prototype.clearListenerNotifications=function(){this.queue.clear()},e}();e.emptyAnimation=new t.Animation("<empty>",[],0),e.SUBSEQUENT=0,e.FIRST=1,e.DIP=2,e.DIP_MIX=3,t.AnimationState=e;var n=function(){function n(){this.timelineData=new Array,this.timelineDipMix=new Array,this.timelinesRotation=new Array}return n.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.animation=null,this.listener=null,this.timelineData.length=0,this.timelineDipMix.length=0,this.timelinesRotation.length=0},n.prototype.setTimelineData=function(n,r,a){null!=n&&r.push(n);var i=null!=this.mixingFrom?this.mixingFrom.setTimelineData(this,r,a):this;null!=n&&r.pop();var o=r,s=r.length-1,h=this.animation.timelines,l=this.animation.timelines.length,u=t.Utils.setArraySize(this.timelineData,l);this.timelineDipMix.length=0;var c=t.Utils.setArraySize(this.timelineDipMix,l);t:for(var f=0;f<l;f++){var p=h[f].getPropertyId();if(a.add(p))if(null!=n&&n.hasTimeline(p)){for(var d=s;d>=0;d--){var m=o[d];if(!m.hasTimeline(p)&&m.mixDuration>0){u[f]=e.DIP_MIX,c[f]=m;continue t}}u[f]=e.DIP}else u[f]=e.FIRST;else u[f]=e.SUBSEQUENT}return i},n.prototype.hasTimeline=function(t){for(var e=this.animation.timelines,n=0,r=e.length;n<r;n++)if(e[n].getPropertyId()==t)return!0;return!1},n.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},n.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},n.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},n.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},n}();t.TrackEntry=n;var r,a=function(){function t(t){this.objects=[],this.drainDisabled=!1,this.animState=t}return t.prototype.start=function(t){this.objects.push(r.start),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.interrupt=function(t){this.objects.push(r.interrupt),this.objects.push(t)},t.prototype.end=function(t){this.objects.push(r.end),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.dispose=function(t){this.objects.push(r.dispose),this.objects.push(t)},t.prototype.complete=function(t){this.objects.push(r.complete),this.objects.push(t)},t.prototype.event=function(t,e){this.objects.push(r.event),this.objects.push(t),this.objects.push(e)},t.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,n=0;n<t.length;n+=2){var a=t[n],i=t[n+1];switch(a){case r.start:null!=i.listener&&i.listener.start&&i.listener.start(i);for(var o=0;o<e.length;o++)e[o].start&&e[o].start(i);break;case r.interrupt:null!=i.listener&&i.listener.interrupt&&i.listener.interrupt(i);for(o=0;o<e.length;o++)e[o].interrupt&&e[o].interrupt(i);break;case r.end:null!=i.listener&&i.listener.end&&i.listener.end(i);for(o=0;o<e.length;o++)e[o].end&&e[o].end(i);case r.dispose:null!=i.listener&&i.listener.dispose&&i.listener.dispose(i);for(o=0;o<e.length;o++)e[o].dispose&&e[o].dispose(i);this.animState.trackEntryPool.free(i);break;case r.complete:null!=i.listener&&i.listener.complete&&i.listener.complete(i);for(o=0;o<e.length;o++)e[o].complete&&e[o].complete(i);break;case r.event:var s=t[2+n++];null!=i.listener&&i.listener.event&&i.listener.event(i,s);for(o=0;o<e.length;o++)e[o].event&&e[o].event(i,s)}}this.clear(),this.drainDisabled=!1}},t.prototype.clear=function(){this.objects.length=0},t}();t.EventQueue=a,function(t){t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event"}(r=t.EventType||(t.EventType={}));var i=function(){function t(){}return t.prototype.start=function(t){},t.prototype.interrupt=function(t){},t.prototype.end=function(t){},t.prototype.dispose=function(t){},t.prototype.complete=function(t){},t.prototype.event=function(t,e){},t}();t.AnimationStateAdapter2=i}(n||(n={})),function(t){var e=function(){function t(t){if(this.animationToMixTime={},this.defaultMix=0,null==t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}return t.prototype.setMix=function(t,e,n){var r=this.skeletonData.findAnimation(t);if(null==r)throw new Error("Animation not found: "+t);var a=this.skeletonData.findAnimation(e);if(null==a)throw new Error("Animation not found: "+e);this.setMixWith(r,a,n)},t.prototype.setMixWith=function(t,e,n){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");var r=t.name+"."+e.name;this.animationToMixTime[r]=n},t.prototype.getMix=function(t,e){var n=t.name+"."+e.name,r=this.animationToMixTime[n];return void 0===r?this.defaultMix:r},t}();t.AnimationStateData=e}(n||(n={})),function(t){var e=function(){function e(t,e){void 0===e&&(e=""),this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.textureLoader=t,this.pathPrefix=e}return e.downloadText=function(t,e,n){var r=new XMLHttpRequest;r.open("GET",t,!0),r.onload=function(){200==r.status?e(r.responseText):n(r.status,r.responseText)},r.onerror=function(){n(r.status,r.responseText)},r.send()},e.downloadBinary=function(t,e,n){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){200==r.status?e(new Uint8Array(r.response)):n(r.status,r.responseText)},r.onerror=function(){n(r.status,r.responseText)},r.send()},e.prototype.loadText=function(t,n,r){var a=this;void 0===n&&(n=null),void 0===r&&(r=null),t=this.pathPrefix+t,this.toLoad++,e.downloadText(t,function(e){a.assets[t]=e,n&&n(t,e),a.toLoad--,a.loaded++},function(e,n){a.errors[t]="Couldn't load text "+t+": status "+status+", "+n,r&&r(t,"Couldn't load text "+t+": status "+status+", "+n),a.toLoad--,a.loaded++})},e.prototype.loadTexture=function(t,e,n){var r=this;void 0===e&&(e=null),void 0===n&&(n=null),t=this.pathPrefix+t,this.toLoad++;var a=new Image;a.crossOrigin="anonymous",a.onload=function(n){var i=r.textureLoader(a);r.assets[t]=i,r.toLoad--,r.loaded++,e&&e(t,a)},a.onerror=function(e){r.errors[t]="Couldn't load image "+t,r.toLoad--,r.loaded++,n&&n(t,"Couldn't load image "+t)},a.src=t},e.prototype.loadTextureData=function(t,e,n,r){var a=this;void 0===n&&(n=null),void 0===r&&(r=null),t=this.pathPrefix+t,this.toLoad++;var i=new Image;i.onload=function(e){var r=a.textureLoader(i);a.assets[t]=r,a.toLoad--,a.loaded++,n&&n(t,i)},i.onerror=function(e){a.errors[t]="Couldn't load image "+t,a.toLoad--,a.loaded++,r&&r(t,"Couldn't load image "+t)},i.src=e},e.prototype.loadTextureAtlas=function(n,r,a){var i=this;void 0===r&&(r=null),void 0===a&&(a=null);var o=n.lastIndexOf("/")>=0?n.substring(0,n.lastIndexOf("/")):"";n=this.pathPrefix+n,this.toLoad++,e.downloadText(n,function(e){var s=new Array;try{new t.TextureAtlas(e,function(e){s.push(o+"/"+e);var n=document.createElement("img");return n.width=16,n.height=16,new t.FakeTexture(n)})}catch(t){var h=t;return i.errors[n]="Couldn't load texture atlas "+n+": "+h.message,a&&a(n,"Couldn't load texture atlas "+n+": "+h.message),i.toLoad--,void i.loaded++}for(var l=function(h){var l=0,u=!1;i.loadTexture(h,function(h,c){if(++l==s.length)if(u)i.errors[n]="Couldn't load texture atlas page "+h+"} of atlas "+n,a&&a(n,"Couldn't load texture atlas page "+h+" of atlas "+n),i.toLoad--,i.loaded++;else try{var f=new t.TextureAtlas(e,function(t){return i.get(o+"/"+t)});i.assets[n]=f,r&&r(n,f),i.toLoad--,i.loaded++}catch(t){var p=t;i.errors[n]="Couldn't load texture atlas "+n+": "+p.message,a&&a(n,"Couldn't load texture atlas "+n+": "+p.message),i.toLoad--,i.loaded++}},function(t,e){u=!0,++l==s.length&&(i.errors[n]="Couldn't load texture atlas page "+t+"} of atlas "+n,a&&a(n,"Couldn't load texture atlas page "+t+" of atlas "+n),i.toLoad--,i.loaded++)})},u=0,c=s;u<c.length;u++){l(c[u])}},function(t,e){i.errors[n]="Couldn't load texture atlas "+n+": status "+status+", "+e,a&&a(n,"Couldn't load texture atlas "+n+": status "+status+", "+e),i.toLoad--,i.loaded++})},e.prototype.get=function(t){return t=this.pathPrefix+t,this.assets[t]},e.prototype.remove=function(t){t=this.pathPrefix+t;var e=this.assets[t];e.dispose&&e.dispose(),this.assets[t]=null},e.prototype.removeAll=function(){for(var t in this.assets){var e=this.assets[t];e.dispose&&e.dispose()}this.assets={}},e.prototype.isLoadingComplete=function(){return 0==this.toLoad},e.prototype.getToLoad=function(){return this.toLoad},e.prototype.getLoaded=function(){return this.loaded},e.prototype.dispose=function(){this.removeAll()},e.prototype.hasErrors=function(){return Object.keys(this.errors).length>0},e.prototype.getErrors=function(){return this.errors},e}();t.AssetManager=e}(n||(n={})),function(t){var e=function(){function e(t){this.atlas=t}return e.prototype.newRegionAttachment=function(e,n,r){var a=this.atlas.findRegion(r);if(null==a)throw new Error("Region not found in atlas: "+r+" (region attachment: "+n+")");a.renderObject=a;var i=new t.RegionAttachment(n);return i.setRegion(a),i},e.prototype.newMeshAttachment=function(e,n,r){var a=this.atlas.findRegion(r);if(null==a)throw new Error("Region not found in atlas: "+r+" (mesh attachment: "+n+")");a.renderObject=a;var i=new t.MeshAttachment(n);return i.region=a,i},e.prototype.newBoundingBoxAttachment=function(e,n){return new t.BoundingBoxAttachment(n)},e.prototype.newPathAttachment=function(e,n){return new t.PathAttachment(n)},e.prototype.newPointAttachment=function(e,n){return new t.PointAttachment(n)},e.prototype.newClippingAttachment=function(e,n){return new t.ClippingAttachment(n)},e}();t.AtlasAttachmentLoader=e}(n||(n={})),function(t){!function(t){t[t.Normal=0]="Normal",t[t.Additive=1]="Additive",t[t.Multiply=2]="Multiply",t[t.Screen=3]="Screen"}(t.BlendMode||(t.BlendMode={}))}(n||(n={})),function(t){var e=function(){function e(t,e,n){if(this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.a=0,this.b=0,this.worldX=0,this.c=0,this.d=0,this.worldY=0,this.sorted=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()}return e.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransformWith=function(e,n,r,a,i,o,s){this.ax=e,this.ay=n,this.arotation=r,this.ascaleX=a,this.ascaleY=i,this.ashearX=o,this.ashearY=s,this.appliedValid=!0;var h=this.parent;if(null==h){var l=r+90+s,u=t.MathUtils.cosDeg(r+o)*a,c=t.MathUtils.cosDeg(l)*i,f=t.MathUtils.sinDeg(r+o)*a,p=t.MathUtils.sinDeg(l)*i,d=this.skeleton;return d.flipX&&(e=-e,u=-u,c=-c),d.flipY&&(n=-n,f=-f,p=-p),this.a=u,this.b=c,this.c=f,this.d=p,this.worldX=e+d.x,void(this.worldY=n+d.y)}var m=h.a,g=h.b,v=h.c,y=h.d;switch(this.worldX=m*e+g*n+h.worldX,this.worldY=v*e+y*n+h.worldY,this.data.transformMode){case t.TransformMode.Normal:l=r+90+s,u=t.MathUtils.cosDeg(r+o)*a,c=t.MathUtils.cosDeg(l)*i,f=t.MathUtils.sinDeg(r+o)*a,p=t.MathUtils.sinDeg(l)*i;return this.a=m*u+g*f,this.b=m*c+g*p,this.c=v*u+y*f,void(this.d=v*c+y*p);case t.TransformMode.OnlyTranslation:l=r+90+s;this.a=t.MathUtils.cosDeg(r+o)*a,this.b=t.MathUtils.cosDeg(l)*i,this.c=t.MathUtils.sinDeg(r+o)*a,this.d=t.MathUtils.sinDeg(l)*i;break;case t.TransformMode.NoRotationOrReflection:var w=0;(E=m*m+v*v)>1e-4?(g=v*(E=Math.abs(m*y-g*v)/E),y=m*E,w=Math.atan2(v,m)*t.MathUtils.radDeg):(m=0,v=0,w=90-Math.atan2(y,g)*t.MathUtils.radDeg);var x=r+o-w,M=r+s-w+90;u=t.MathUtils.cosDeg(x)*a,c=t.MathUtils.cosDeg(M)*i,f=t.MathUtils.sinDeg(x)*a,p=t.MathUtils.sinDeg(M)*i;this.a=m*u-g*f,this.b=m*c-g*p,this.c=v*u+y*f,this.d=v*c+y*p;break;case t.TransformMode.NoScale:case t.TransformMode.NoScaleOrReflection:var E,T=t.MathUtils.cosDeg(r),A=t.MathUtils.sinDeg(r),b=m*T+g*A,R=v*T+y*A;(E=Math.sqrt(b*b+R*R))>1e-5&&(E=1/E),b*=E,R*=E,E=Math.sqrt(b*b+R*R);var S=Math.PI/2+Math.atan2(R,b),I=Math.cos(S)*E,P=Math.sin(S)*E;u=t.MathUtils.cosDeg(o)*a,c=t.MathUtils.cosDeg(90+s)*i,f=t.MathUtils.sinDeg(o)*a,p=t.MathUtils.sinDeg(90+s)*i;return(this.data.transformMode!=t.TransformMode.NoScaleOrReflection?m*y-g*v<0:this.skeleton.flipX!=this.skeleton.flipY)&&(I=-I,P=-P),this.a=b*u+I*f,this.b=b*c+I*p,this.c=R*u+P*f,void(this.d=R*c+P*p)}this.skeleton.flipX&&(this.a=-this.a,this.b=-this.b),this.skeleton.flipY&&(this.c=-this.c,this.d=-this.d)},e.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},e.prototype.getWorldRotationX=function(){return Math.atan2(this.c,this.a)*t.MathUtils.radDeg},e.prototype.getWorldRotationY=function(){return Math.atan2(this.d,this.b)*t.MathUtils.radDeg},e.prototype.getWorldScaleX=function(){return Math.sqrt(this.a*this.a+this.c*this.c)},e.prototype.getWorldScaleY=function(){return Math.sqrt(this.b*this.b+this.d*this.d)},e.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var e=this.parent;if(null==e)return this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*t.MathUtils.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*t.MathUtils.radDeg);var n=e.a,r=e.b,a=e.c,i=e.d,o=1/(n*i-r*a),s=this.worldX-e.worldX,h=this.worldY-e.worldY;this.ax=s*i*o-h*r*o,this.ay=h*n*o-s*a*o;var l=o*i,u=o*n,c=o*r,f=o*a,p=l*this.a-c*this.c,d=l*this.b-c*this.d,m=u*this.c-f*this.a,g=u*this.d-f*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(p*p+m*m),this.ascaleX>1e-4){var v=p*g-d*m;this.ascaleY=v/this.ascaleX,this.ashearY=Math.atan2(p*d+m*g,v)*t.MathUtils.radDeg,this.arotation=Math.atan2(m,p)*t.MathUtils.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(d*d+g*g),this.ashearY=0,this.arotation=90-Math.atan2(g,d)*t.MathUtils.radDeg},e.prototype.worldToLocal=function(t){var e=this.a,n=this.b,r=this.c,a=this.d,i=1/(e*a-n*r),o=t.x-this.worldX,s=t.y-this.worldY;return t.x=o*a*i-s*n*i,t.y=s*e*i-o*r*i,t},e.prototype.localToWorld=function(t){var e=t.x,n=t.y;return t.x=e*this.a+n*this.b+this.worldX,t.y=e*this.c+n*this.d+this.worldY,t},e.prototype.worldToLocalRotation=function(e){var n=t.MathUtils.sinDeg(e),r=t.MathUtils.cosDeg(e);return Math.atan2(this.a*n-this.c*r,this.d*r-this.b*n)*t.MathUtils.radDeg},e.prototype.localToWorldRotation=function(e){var n=t.MathUtils.sinDeg(e),r=t.MathUtils.cosDeg(e);return Math.atan2(r*this.c+n*this.d,r*this.a+n*this.b)*t.MathUtils.radDeg},e.prototype.rotateWorld=function(e){var n=this.a,r=this.b,a=this.c,i=this.d,o=t.MathUtils.cosDeg(e),s=t.MathUtils.sinDeg(e);this.a=o*n-s*a,this.b=o*r-s*i,this.c=s*n+o*a,this.d=s*r+o*i,this.appliedValid=!1},e}();t.Bone=e}(n||(n={})),function(t){var e,n=function(){return function(t,n,r){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=e.Normal,t<0)throw new Error("index must be >= 0.");if(null==n)throw new Error("name cannot be null.");this.index=t,this.name=n,this.parent=r}}();t.BoneData=n,function(t){t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection"}(e=t.TransformMode||(t.TransformMode={}))}(n||(n={})),function(t){var e=function(){return function(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e}}();t.Event=e}(n||(n={})),function(t){var e=function(){return function(t){this.name=t}}();t.EventData=e}(n||(n={})),function(t){var e=function(){function e(t,e){if(this.mix=1,this.bendDirection=0,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.bones=new Array;for(var n=0;n<t.bones.length;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)}return e.prototype.getOrder=function(){return this.data.order},e.prototype.apply=function(){this.update()},e.prototype.update=function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.mix)}},e.prototype.apply1=function(e,n,r,a){e.appliedValid||e.updateAppliedTransform();var i=e.parent,o=1/(i.a*i.d-i.b*i.c),s=n-i.worldX,h=r-i.worldY,l=(s*i.d-h*i.b)*o-e.ax,u=(h*i.a-s*i.c)*o-e.ay,c=Math.atan2(u,l)*t.MathUtils.radDeg-e.ashearX-e.arotation;e.ascaleX<0&&(c+=180),c>180?c-=360:c<-180&&(c+=360),e.updateWorldTransformWith(e.ax,e.ay,e.arotation+c*a,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)},e.prototype.apply2=function(e,n,r,a,i,o){if(0!=o){e.appliedValid||e.updateAppliedTransform(),n.appliedValid||n.updateAppliedTransform();var s=e.ax,h=e.ay,l=e.ascaleX,u=e.ascaleY,c=n.ascaleX,f=0,p=0,d=0;l<0?(l=-l,f=180,d=-1):(f=0,d=1),u<0&&(u=-u,d=-d),c<0?(c=-c,p=180):p=0;var m=n.ax,g=0,v=0,y=0,w=e.a,x=e.b,M=e.c,E=e.d,T=Math.abs(l-u)<=1e-4;T?(v=w*m+x*(g=n.ay)+e.worldX,y=M*m+E*g+e.worldY):(g=0,v=w*m+e.worldX,y=M*m+e.worldY);var A=e.parent;w=A.a,x=A.b,M=A.c;var b=1/(w*(E=A.d)-x*M),R=r-A.worldX,S=a-A.worldY,I=(R*E-S*x)*b-s,P=(S*w-R*M)*b-h,C=((R=v-A.worldX)*E-(S=y-A.worldY)*x)*b-s,V=(S*w-R*M)*b-h,k=Math.sqrt(C*C+V*V),N=n.data.length*c,Y=0,_=0;t:if(T){var D=(I*I+P*P-k*k-(N*=l)*N)/(2*k*N);D<-1?D=-1:D>1&&(D=1),_=Math.acos(D)*i,w=k+N*D,x=N*Math.sin(_),Y=Math.atan2(P*w-I*x,I*w+P*x)}else{var X=(w=l*N)*w,U=(x=u*N)*x,F=I*I+P*P,L=Math.atan2(P,I),O=-2*U*k,B=U-X;if((E=O*O-4*B*(M=U*k*k+X*F-X*U))>=0){var W=Math.sqrt(E);O<0&&(W=-W);var q=(W=-(O+W)/2)/B,j=M/W,G=Math.abs(q)<Math.abs(j)?q:j;if(G*G<=F){S=Math.sqrt(F-G*G)*i,Y=L-Math.atan2(S,G),_=Math.atan2(S/u,(G-k)/l);break t}}var z=t.MathUtils.PI,Z=k-w,H=Z*Z,J=0,Q=0,K=k+w,$=K*K,tt=0;(M=-w*k/(X-U))>=-1&&M<=1&&(M=Math.acos(M),(E=(R=w*Math.cos(M)+k)*R+(S=x*Math.sin(M))*S)<H&&(z=M,H=E,Z=R,J=S),E>$&&(Q=M,$=E,K=R,tt=S)),F<=(H+$)/2?(Y=L-Math.atan2(J*i,Z),_=z*i):(Y=L-Math.atan2(tt*i,K),_=Q*i)}var et=Math.atan2(g,m)*d,nt=e.arotation;(Y=(Y-et)*t.MathUtils.radDeg+f-nt)>180?Y-=360:Y<-180&&(Y+=360),e.updateWorldTransformWith(s,h,nt+Y*o,e.ascaleX,e.ascaleY,0,0),nt=n.arotation,(_=((_+et)*t.MathUtils.radDeg-n.ashearX)*d+p-nt)>180?_-=360:_<-180&&(_+=360),n.updateWorldTransformWith(m,g,nt+_*o,n.ascaleX,n.ascaleY,n.ashearX,n.ashearY)}else n.updateWorldTransform()},e}();t.IkConstraint=e}(n||(n={})),function(t){var e=function(){return function(t){this.order=0,this.bones=new Array,this.bendDirection=1,this.mix=1,this.name=t}}();t.IkConstraintData=e}(n||(n={})),function(t){var e=function(){function e(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var n=0,r=t.bones.length;n<r;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}return e.prototype.apply=function(){this.update()},e.prototype.update=function(){var n=this.target.getAttachment();if(n instanceof t.PathAttachment){var r=this.rotateMix,a=this.translateMix,i=r>0;if(a>0||i){var o=this.data,s=o.spacingMode,h=s==t.SpacingMode.Length,l=o.rotateMode,u=l==t.RotateMode.Tangent,c=l==t.RotateMode.ChainScale,f=this.bones.length,p=u?f:f+1,d=this.bones,m=t.Utils.setArraySize(this.spaces,p),g=null,v=this.spacing;if(c||h){c&&(g=t.Utils.setArraySize(this.lengths,f));for(var y=0,w=p-1;y<w;){var x=(C=d[y]).data.length;if(x<e.epsilon)c&&(g[y]=0),m[++y]=0;else{var M=x*C.a,E=x*C.c,T=Math.sqrt(M*M+E*E);c&&(g[y]=T),m[++y]=(h?x+v:v)*T/x}}}else for(y=1;y<p;y++)m[y]=v;var A=this.computeWorldPositions(n,p,u,o.positionMode==t.PositionMode.Percent,s==t.SpacingMode.Percent),b=A[0],R=A[1],S=o.offsetRotation,I=!1;if(0==S)I=l==t.RotateMode.Chain;else I=!1,S*=(P=this.target.bone).a*P.d-P.b*P.c>0?t.MathUtils.degRad:-t.MathUtils.degRad;y=0;for(var P=3;y<f;y++,P+=3){var C;(C=d[y]).worldX+=(b-C.worldX)*a,C.worldY+=(R-C.worldY)*a;var V=(M=A[P])-b,k=(E=A[P+1])-R;if(c){var N=g[y];if(0!=N){var Y=(Math.sqrt(V*V+k*k)/N-1)*r+1;C.a*=Y,C.c*=Y}}if(b=M,R=E,i){var _=C.a,D=C.b,X=C.c,U=C.d,F=0,L=0,O=0;if(F=u?A[P-1]:0==m[y+1]?A[P+2]:Math.atan2(k,V),F-=Math.atan2(X,_),I){L=Math.cos(F),O=Math.sin(F);var B=C.data.length;b+=(B*(L*_-O*X)-V)*r,R+=(B*(O*_+L*X)-k)*r}else F+=S;F>t.MathUtils.PI?F-=t.MathUtils.PI2:F<-t.MathUtils.PI&&(F+=t.MathUtils.PI2),F*=r,L=Math.cos(F),O=Math.sin(F),C.a=L*_-O*X,C.b=L*D-O*U,C.c=O*_+L*X,C.d=O*D+L*U}C.appliedValid=!1}}}},e.prototype.computeWorldPositions=function(n,r,a,i,o){var s=this.target,h=this.position,l=this.spaces,u=t.Utils.setArraySize(this.positions,3*r+2),c=null,f=n.closed,p=n.worldVerticesLength,d=p/6,m=e.NONE;if(!n.constantSpeed){var g=n.lengths,v=g[d-=f?1:2];if(i&&(h*=v),o)for(var y=0;y<r;y++)l[y]*=v;c=t.Utils.setArraySize(this.world,8);y=0;for(var w=0,x=0;y<r;y++,w+=3){var M=h+=j=l[y];if(f)(M%=v)<0&&(M+=v),x=0;else{if(M<0){m!=e.BEFORE&&(m=e.BEFORE,n.computeWorldVertices(s,2,4,c,0,2)),this.addBeforePosition(M,c,0,u,w);continue}if(M>v){m!=e.AFTER&&(m=e.AFTER,n.computeWorldVertices(s,p-6,4,c,0,2)),this.addAfterPosition(M-v,c,0,u,w);continue}}for(;;x++){var E=g[x];if(!(M>E)){if(0==x)M/=E;else M=(M-(H=g[x-1]))/(E-H);break}}x!=m&&(m=x,f&&x==d?(n.computeWorldVertices(s,p-4,4,c,0,2),n.computeWorldVertices(s,0,4,c,4,2)):n.computeWorldVertices(s,6*x+2,8,c,0,2)),this.addCurvePosition(M,c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],u,w,a||y>0&&0==j)}return u}f?(p+=2,c=t.Utils.setArraySize(this.world,p),n.computeWorldVertices(s,2,p-4,c,0,2),n.computeWorldVertices(s,0,2,c,p-4,2),c[p-2]=c[0],c[p-1]=c[1]):(d--,p-=4,c=t.Utils.setArraySize(this.world,p),n.computeWorldVertices(s,2,p,c,0,2));for(var T=t.Utils.setArraySize(this.curves,d),A=0,b=c[0],R=c[1],S=0,I=0,P=0,C=0,V=0,k=0,N=0,Y=0,_=0,D=0,X=0,U=0,F=0,L=0,O=(y=0,2);y<d;y++,O+=6)S=c[O],I=c[O+1],P=c[O+2],C=c[O+3],X=2*(N=.1875*(b-2*S+P))+(_=.09375*(3*(S-P)-b+(V=c[O+4]))),U=2*(Y=.1875*(R-2*I+C))+(D=.09375*(3*(I-C)-R+(k=c[O+5]))),F=.75*(S-b)+N+.16666667*_,L=.75*(I-R)+Y+.16666667*D,A+=Math.sqrt(F*F+L*L),F+=X,L+=U,X+=_,U+=D,A+=Math.sqrt(F*F+L*L),F+=X,L+=U,A+=Math.sqrt(F*F+L*L),F+=X+_,L+=U+D,A+=Math.sqrt(F*F+L*L),T[y]=A,b=V,R=k;if(i&&(h*=A),o)for(y=0;y<r;y++)l[y]*=A;for(var B=this.segments,W=0,q=(y=0,w=0,x=0,0);y<r;y++,w+=3){var j;M=h+=j=l[y];if(f)(M%=A)<0&&(M+=A),x=0;else{if(M<0){this.addBeforePosition(M,c,0,u,w);continue}if(M>A){this.addAfterPosition(M-A,c,p-4,u,w);continue}}for(;;x++){var G=T[x];if(!(M>G)){if(0==x)M/=G;else M=(M-(H=T[x-1]))/(G-H);break}}if(x!=m){m=x;var z=6*x;for(b=c[z],R=c[z+1],S=c[z+2],I=c[z+3],P=c[z+4],C=c[z+5],X=2*(N=.03*(b-2*S+P))+(_=.006*(3*(S-P)-b+(V=c[z+6]))),U=2*(Y=.03*(R-2*I+C))+(D=.006*(3*(I-C)-R+(k=c[z+7]))),F=.3*(S-b)+N+.16666667*_,L=.3*(I-R)+Y+.16666667*D,W=Math.sqrt(F*F+L*L),B[0]=W,z=1;z<8;z++)F+=X,L+=U,X+=_,U+=D,W+=Math.sqrt(F*F+L*L),B[z]=W;F+=X,L+=U,W+=Math.sqrt(F*F+L*L),B[8]=W,F+=X+_,L+=U+D,W+=Math.sqrt(F*F+L*L),B[9]=W,q=0}for(M*=W;;q++){var Z=B[q];if(!(M>Z)){var H;if(0==q)M/=Z;else M=q+(M-(H=B[q-1]))/(Z-H);break}}this.addCurvePosition(.1*M,b,R,S,I,P,C,V,k,u,w,a||y>0&&0==j)}return u},e.prototype.addBeforePosition=function(t,e,n,r,a){var i=e[n],o=e[n+1],s=e[n+2]-i,h=e[n+3]-o,l=Math.atan2(h,s);r[a]=i+t*Math.cos(l),r[a+1]=o+t*Math.sin(l),r[a+2]=l},e.prototype.addAfterPosition=function(t,e,n,r,a){var i=e[n+2],o=e[n+3],s=i-e[n],h=o-e[n+1],l=Math.atan2(h,s);r[a]=i+t*Math.cos(l),r[a+1]=o+t*Math.sin(l),r[a+2]=l},e.prototype.addCurvePosition=function(t,e,n,r,a,i,o,s,h,l,u,c){(0==t||isNaN(t))&&(t=1e-4);var f=t*t,p=f*t,d=1-t,m=d*d,g=m*d,v=d*t,y=3*v,w=d*y,x=y*t,M=e*g+r*w+i*x+s*p,E=n*g+a*w+o*x+h*p;l[u]=M,l[u+1]=E,c&&(l[u+2]=Math.atan2(E-(n*m+a*v*2+o*f),M-(e*m+r*v*2+i*f)))},e.prototype.getOrder=function(){return this.data.order},e}();e.NONE=-1,e.BEFORE=-2,e.AFTER=-3,e.epsilon=1e-5,t.PathConstraint=e}(n||(n={})),function(t){var e=function(){return function(t){this.order=0,this.bones=new Array,this.name=t}}();t.PathConstraintData=e,function(t){t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent"}(t.PositionMode||(t.PositionMode={})),function(t){t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent"}(t.SpacingMode||(t.SpacingMode={})),function(t){t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale"}(t.RotateMode||(t.RotateMode={}))}(n||(n={})),Math.fround||(Math.fround=(e=new Float32Array(1),function(t){return e[0]=t,e[0]})),function(t){var e=function(){function t(t){this.toLoad=new Array,this.assets={},this.clientId=t}return t.prototype.loaded=function(){var t=0;for(var e in this.assets)t++;return t},t}(),n=function(){function t(t){void 0===t&&(t=""),this.clientAssets={},this.queuedAssets={},this.rawAssets={},this.errors={},this.pathPrefix=t}return t.prototype.queueAsset=function(t,n,r){var a=this.clientAssets[t];return null==a&&(a=new e(t),this.clientAssets[t]=a),null!==n&&(a.textureLoader=n),a.toLoad.push(r),this.queuedAssets[r]!==r&&(this.queuedAssets[r]=r,!0)},t.prototype.loadText=function(t,e){var n=this;if(e=this.pathPrefix+e,this.queueAsset(t,null,e)){var r=new XMLHttpRequest;r.onreadystatechange=function(){r.readyState==XMLHttpRequest.DONE&&(r.status>=200&&r.status<300?n.rawAssets[e]=r.responseText:n.errors[e]="Couldn't load text "+e+": status "+r.status+", "+r.responseText)},r.open("GET",e,!0),r.send()}},t.prototype.loadJson=function(t,e){var n=this;if(e=this.pathPrefix+e,this.queueAsset(t,null,e)){var r=new XMLHttpRequest;r.onreadystatechange=function(){r.readyState==XMLHttpRequest.DONE&&(r.status>=200&&r.status<300?n.rawAssets[e]=JSON.parse(r.responseText):n.errors[e]="Couldn't load text "+e+": status "+r.status+", "+r.responseText)},r.open("GET",e,!0),r.send()}},t.prototype.loadTexture=function(t,e,n){var r=this;if(n=this.pathPrefix+n,this.queueAsset(t,e,n)){var a=new Image;a.src=n,a.crossOrigin="anonymous",a.onload=function(t){r.rawAssets[n]=a},a.onerror=function(t){r.errors[n]="Couldn't load image "+n}}},t.prototype.get=function(t,e){e=this.pathPrefix+e;var n=this.clientAssets[t];return null==n||n.assets[e]},t.prototype.updateClientAssets=function(t){for(var e=0;e<t.toLoad.length;e++){var n=t.toLoad[e],r=t.assets[n];if(null==r){var a=this.rawAssets[n];if(null==a)continue;a instanceof HTMLImageElement?t.assets[n]=t.textureLoader(a):t.assets[n]=a}}},t.prototype.isLoadingComplete=function(t){var e=this.clientAssets[t];return null==e||(this.updateClientAssets(e),e.toLoad.length==e.loaded())},t.prototype.dispose=function(){},t.prototype.hasErrors=function(){return Object.keys(this.errors).length>0},t.prototype.getErrors=function(){return this.errors},t}();t.SharedAssetManager=n}(n||(n={})),function(t){var e=function(){function e(e){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.flipX=!1,this.flipY=!1,this.x=0,this.y=0,null==e)throw new Error("data cannot be null.");this.data=e,this.bones=new Array;for(var n=0;n<e.bones.length;n++){var r=e.bones[n],a=void 0;if(null==r.parent)a=new t.Bone(r,this,null);else{var i=this.bones[r.parent.index];a=new t.Bone(r,this,i),i.children.push(a)}this.bones.push(a)}this.slots=new Array,this.drawOrder=new Array;for(n=0;n<e.slots.length;n++){var o=e.slots[n],s=(a=this.bones[o.boneData.index],new t.Slot(o,a));this.slots.push(s),this.drawOrder.push(s)}this.ikConstraints=new Array;for(n=0;n<e.ikConstraints.length;n++){var h=e.ikConstraints[n];this.ikConstraints.push(new t.IkConstraint(h,this))}this.transformConstraints=new Array;for(n=0;n<e.transformConstraints.length;n++){var l=e.transformConstraints[n];this.transformConstraints.push(new t.TransformConstraint(l,this))}this.pathConstraints=new Array;for(n=0;n<e.pathConstraints.length;n++){var u=e.pathConstraints[n];this.pathConstraints.push(new t.PathConstraint(u,this))}this.color=new t.Color(1,1,1,1),this.updateCache()}return e.prototype.updateCache=function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var t=this.bones,e=0,n=t.length;e<n;e++)t[e].sorted=!1;var r=this.ikConstraints,a=this.transformConstraints,i=this.pathConstraints,o=r.length,s=a.length,h=i.length,l=o+s+h;t:for(e=0;e<l;e++){for(var u=0;u<o;u++){if((c=r[u]).data.order==e){this.sortIkConstraint(c);continue t}}for(u=0;u<s;u++){if((c=a[u]).data.order==e){this.sortTransformConstraint(c);continue t}}for(u=0;u<h;u++){var c;if((c=i[u]).data.order==e){this.sortPathConstraint(c);continue t}}}for(e=0,n=t.length;e<n;e++)this.sortBone(t[e])},e.prototype.sortIkConstraint=function(t){var e=t.target;this.sortBone(e);var n=t.bones,r=n[0];if(this.sortBone(r),n.length>1){var a=n[n.length-1];this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}this._updateCache.push(t),this.sortReset(r.children),n[n.length-1].sorted=!0},e.prototype.sortPathConstraint=function(e){var n=e.target,r=n.data.index,a=n.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,r,a),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,r,a);for(var i=0,o=this.data.skins.length;i<o;i++)this.sortPathConstraintAttachment(this.data.skins[i],r,a);var s=n.getAttachment();s instanceof t.PathAttachment&&this.sortPathConstraintAttachmentWith(s,a);var h=e.bones,l=h.length;for(i=0;i<l;i++)this.sortBone(h[i]);this._updateCache.push(e);for(i=0;i<l;i++)this.sortReset(h[i].children);for(i=0;i<l;i++)h[i].sorted=!0},e.prototype.sortTransformConstraint=function(t){this.sortBone(t.target);var e=t.bones,n=e.length;if(t.data.local)for(var r=0;r<n;r++){var a=e[r];this.sortBone(a.parent),this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}else for(r=0;r<n;r++)this.sortBone(e[r]);this._updateCache.push(t);for(var i=0;i<n;i++)this.sortReset(e[i].children);for(i=0;i<n;i++)e[i].sorted=!0},e.prototype.sortPathConstraintAttachment=function(t,e,n){var r=t.attachments[e];if(r)for(var a in r)this.sortPathConstraintAttachmentWith(r[a],n)},e.prototype.sortPathConstraintAttachmentWith=function(e,n){if(e instanceof t.PathAttachment){var r=e.bones;if(null==r)this.sortBone(n);else for(var a=this.bones,i=0;i<r.length;)for(var o=r[i++],s=i+o;i<s;i++){var h=r[i];this.sortBone(a[h])}}},e.prototype.sortBone=function(t){if(!t.sorted){var e=t.parent;null!=e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}},e.prototype.sortReset=function(t){for(var e=0,n=t.length;e<n;e++){var r=t[e];r.sorted&&this.sortReset(r.children),r.sorted=!1}},e.prototype.updateWorldTransform=function(){for(var t=this.updateCacheReset,e=0,n=t.length;e<n;e++){var r=t[e];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY,r.appliedValid=!0}var a=this._updateCache;for(e=0,n=a.length;e<n;e++)a[e].update()},e.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},e.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,n=t.length;e<n;e++)t[e].setToSetupPose();var r=this.ikConstraints;for(e=0,n=r.length;e<n;e++){(s=r[e]).bendDirection=s.data.bendDirection,s.mix=s.data.mix}var a=this.transformConstraints;for(e=0,n=a.length;e<n;e++){var i=(s=a[e]).data;s.rotateMix=i.rotateMix,s.translateMix=i.translateMix,s.scaleMix=i.scaleMix,s.shearMix=i.shearMix}var o=this.pathConstraints;for(e=0,n=o.length;e<n;e++){var s;i=(s=o[e]).data;s.position=i.position,s.spacing=i.spacing,s.rotateMix=i.rotateMix,s.translateMix=i.translateMix}},e.prototype.setSlotsToSetupPose=function(){var e=this.slots;t.Utils.arrayCopy(e,0,this.drawOrder,0,e.length);for(var n=0,r=e.length;n<r;n++)e[n].setToSetupPose()},e.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},e.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,r=e.length;n<r;n++){var a=e[n];if(a.data.name==t)return a}return null},e.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,r=e.length;n<r;n++)if(e[n].data.name==t)return n;return-1},e.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,r=e.length;n<r;n++){var a=e[n];if(a.data.name==t)return a}return null},e.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,r=e.length;n<r;n++)if(e[n].data.name==t)return n;return-1},e.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(null==e)throw new Error("Skin not found: "+t);this.setSkin(e)},e.prototype.setSkin=function(t){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,n=0,r=e.length;n<r;n++){var a=e[n],i=a.data.attachmentName;if(null!=i){var o=t.getAttachment(n,i);null!=o&&a.setAttachment(o)}}this.skin=t},e.prototype.getAttachmentByName=function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)},e.prototype.getAttachment=function(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){var n=this.skin.getAttachment(t,e);if(null!=n)return n}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},e.prototype.setAttachment=function(t,e){if(null==t)throw new Error("slotName cannot be null.");for(var n=this.slots,r=0,a=n.length;r<a;r++){var i=n[r];if(i.data.name==t){var o=null;if(null!=e&&null==(o=this.getAttachment(r,e)))throw new Error("Attachment not found: "+e+", for slot: "+t);return void i.setAttachment(o)}}throw new Error("Slot not found: "+t)},e.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,n=0,r=e.length;n<r;n++){var a=e[n];if(a.data.name==t)return a}return null},e.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,n=0,r=e.length;n<r;n++){var a=e[n];if(a.data.name==t)return a}return null},e.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,n=0,r=e.length;n<r;n++){var a=e[n];if(a.data.name==t)return a}return null},e.prototype.getBounds=function(e,n,r){if(null==e)throw new Error("offset cannot be null.");if(null==n)throw new Error("size cannot be null.");for(var a=this.drawOrder,i=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,l=0,u=a.length;l<u;l++){var c=a[l],f=0,p=null,d=c.getAttachment();if(d instanceof t.RegionAttachment)f=8,p=t.Utils.setArraySize(r,f,0),d.computeWorldVertices(c.bone,p,0,2);else if(d instanceof t.MeshAttachment){var m=d;f=m.worldVerticesLength,p=t.Utils.setArraySize(r,f,0),m.computeWorldVertices(c,0,f,p,0,2)}if(null!=p)for(var g=0,v=p.length;g<v;g+=2){var y=p[g],w=p[g+1];i=Math.min(i,y),o=Math.min(o,w),s=Math.max(s,y),h=Math.max(h,w)}}e.set(i,o),n.set(s-i,h-o)},e.prototype.update=function(t){this.time+=t},e}();t.Skeleton=e}(n||(n={})),function(t){var e=function(){function e(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new t.Pool(function(){return t.Utils.newFloatArray(16)})}return e.prototype.update=function(e,n){if(null==e)throw new Error("skeleton cannot be null.");var r=this.boundingBoxes,a=this.polygons,i=this.polygonPool,o=e.slots,s=o.length;r.length=0,i.freeAll(a),a.length=0;for(var h=0;h<s;h++){var l=o[h],u=l.getAttachment();if(u instanceof t.BoundingBoxAttachment){var c=u;r.push(c);var f=i.obtain();f.length!=c.worldVerticesLength&&(f=t.Utils.newFloatArray(c.worldVerticesLength)),a.push(f),c.computeWorldVertices(l,0,c.worldVerticesLength,f,0,2)}}n?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},e.prototype.aabbCompute=function(){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY,a=this.polygons,i=0,o=a.length;i<o;i++)for(var s=a[i],h=s,l=0,u=s.length;l<u;l+=2){var c=h[l],f=h[l+1];t=Math.min(t,c),e=Math.min(e,f),n=Math.max(n,c),r=Math.max(r,f)}this.minX=t,this.minY=e,this.maxX=n,this.maxY=r},e.prototype.aabbContainsPoint=function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},e.prototype.aabbIntersectsSegment=function(t,e,n,r){var a=this.minX,i=this.minY,o=this.maxX,s=this.maxY;if(t<=a&&n<=a||e<=i&&r<=i||t>=o&&n>=o||e>=s&&r>=s)return!1;var h=(r-e)/(n-t),l=h*(a-t)+e;if(l>i&&l<s)return!0;if((l=h*(o-t)+e)>i&&l<s)return!0;var u=(i-e)/h+t;return u>a&&u<o||(u=(s-e)/h+t)>a&&u<o},e.prototype.aabbIntersectsSkeleton=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},e.prototype.containsPoint=function(t,e){for(var n=this.polygons,r=0,a=n.length;r<a;r++)if(this.containsPointPolygon(n[r],t,e))return this.boundingBoxes[r];return null},e.prototype.containsPointPolygon=function(t,e,n){for(var r=t,a=t.length,i=a-2,o=!1,s=0;s<a;s+=2){var h=r[s+1],l=r[i+1];if(h<n&&l>=n||l<n&&h>=n){var u=r[s];u+(n-h)/(l-h)*(r[i]-u)<e&&(o=!o)}i=s}return o},e.prototype.intersectsSegment=function(t,e,n,r){for(var a=this.polygons,i=0,o=a.length;i<o;i++)if(this.intersectsSegmentPolygon(a[i],t,e,n,r))return this.boundingBoxes[i];return null},e.prototype.intersectsSegmentPolygon=function(t,e,n,r,a){for(var i=t,o=t.length,s=e-r,h=n-a,l=e*a-n*r,u=i[o-2],c=i[o-1],f=0;f<o;f+=2){var p=i[f],d=i[f+1],m=u*d-c*p,g=u-p,v=c-d,y=s*v-h*g,w=(l*g-s*m)/y;if((w>=u&&w<=p||w>=p&&w<=u)&&(w>=e&&w<=r||w>=r&&w<=e)){var x=(l*v-h*m)/y;if((x>=c&&x<=d||x>=d&&x<=c)&&(x>=n&&x<=a||x>=a&&x<=n))return!0}u=p,c=d}return!1},e.prototype.getPolygon=function(t){if(null==t)throw new Error("boundingBox cannot be null.");var e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]},e.prototype.getWidth=function(){return this.maxX-this.minX},e.prototype.getHeight=function(){return this.maxY-this.minY},e}();t.SkeletonBounds=e}(n||(n={})),function(t){var e=function(){function e(){this.triangulator=new t.Triangulator,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}return e.prototype.clipStart=function(n,r){if(null!=this.clipAttachment)return 0;this.clipAttachment=r;var a=r.worldVerticesLength,i=t.Utils.setArraySize(this.clippingPolygon,a);r.computeWorldVertices(n,0,a,i,0,2);var o=this.clippingPolygon;e.makeClockwise(o);for(var s=this.clippingPolygons=this.triangulator.decompose(o,this.triangulator.triangulate(o)),h=0,l=s.length;h<l;h++){var u=s[h];e.makeClockwise(u),u.push(u[0]),u.push(u[1])}return s.length},e.prototype.clipEndWithSlot=function(t){null!=this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()},e.prototype.clipEnd=function(){null!=this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},e.prototype.isClipping=function(){return null!=this.clipAttachment},e.prototype.clipTriangles=function(e,n,r,a,i,o,s,h){var l=this.clipOutput,u=this.clippedVertices,c=this.clippedTriangles,f=this.clippingPolygons,p=this.clippingPolygons.length,d=h?12:8,m=0;u.length=0,c.length=0;t:for(var g=0;g<a;g+=3)for(var v=r[g]<<1,y=e[v],w=e[v+1],x=i[v],M=i[v+1],E=e[v=r[g+1]<<1],T=e[v+1],A=i[v],b=i[v+1],R=e[v=r[g+2]<<1],S=e[v+1],I=i[v],P=i[v+1],C=0;C<p;C++){var V=u.length;if(!this.clip(y,w,E,T,R,S,f[C],l)){(L=t.Utils.setArraySize(u,V+3*d))[V]=y,L[V+1]=w,L[V+2]=o.r,L[V+3]=o.g,L[V+4]=o.b,L[V+5]=o.a,h?(L[V+6]=x,L[V+7]=M,L[V+8]=s.r,L[V+9]=s.g,L[V+10]=s.b,L[V+11]=s.a,L[V+12]=E,L[V+13]=T,L[V+14]=o.r,L[V+15]=o.g,L[V+16]=o.b,L[V+17]=o.a,L[V+18]=A,L[V+19]=b,L[V+20]=s.r,L[V+21]=s.g,L[V+22]=s.b,L[V+23]=s.a,L[V+24]=R,L[V+25]=S,L[V+26]=o.r,L[V+27]=o.g,L[V+28]=o.b,L[V+29]=o.a,L[V+30]=I,L[V+31]=P,L[V+32]=s.r,L[V+33]=s.g,L[V+34]=s.b,L[V+35]=s.a):(L[V+6]=x,L[V+7]=M,L[V+8]=E,L[V+9]=T,L[V+10]=o.r,L[V+11]=o.g,L[V+12]=o.b,L[V+13]=o.a,L[V+14]=A,L[V+15]=b,L[V+16]=R,L[V+17]=S,L[V+18]=o.r,L[V+19]=o.g,L[V+20]=o.b,L[V+21]=o.a,L[V+22]=I,L[V+23]=P),V=c.length,(H=t.Utils.setArraySize(c,V+3))[V]=m,H[V+1]=m+1,H[V+2]=m+2,m+=3;continue t}var k=l.length;if(0!=k){for(var N=T-S,Y=R-E,_=y-R,D=S-w,X=1/(N*_+Y*(w-S)),U=k>>1,F=this.clipOutput,L=t.Utils.setArraySize(u,V+U*d),O=0;O<k;O+=2){var B=F[O],W=F[O+1];L[V]=B,L[V+1]=W,L[V+2]=o.r,L[V+3]=o.g,L[V+4]=o.b,L[V+5]=o.a;var q=B-R,j=W-S,G=(N*q+Y*j)*X,z=(D*q+_*j)*X,Z=1-G-z;L[V+6]=x*G+A*z+I*Z,L[V+7]=M*G+b*z+P*Z,h&&(L[V+8]=s.r,L[V+9]=s.g,L[V+10]=s.b,L[V+11]=s.a),V+=d}V=c.length;var H=t.Utils.setArraySize(c,V+3*(U-2));U--;for(O=1;O<U;O++)H[V]=m,H[V+1]=m+O,H[V+2]=m+O+1,V+=3;m+=U+1}}},e.prototype.clip=function(t,e,n,r,a,i,o,s){var h=s,l=!1,u=null;o.length%4>=2?(u=s,s=this.scratch):u=this.scratch,u.length=0,u.push(t),u.push(e),u.push(n),u.push(r),u.push(a),u.push(i),u.push(t),u.push(e),s.length=0;for(var c=o,f=o.length-4,p=0;;p+=2){for(var d=c[p],m=c[p+1],g=c[p+2],v=c[p+3],y=d-g,w=m-v,x=u,M=u.length-2,E=s.length,T=0;T<M;T+=2){var A=x[T],b=x[T+1],R=x[T+2],S=x[T+3],I=y*(S-v)-w*(R-g)>0;if(y*(b-v)-w*(A-g)>0){if(I){s.push(R),s.push(S);continue}var P=((V=R-A)*(m-b)-(C=S-b)*(d-A))/(C*(g-d)-V*(v-m));s.push(d+(g-d)*P),s.push(m+(v-m)*P)}else if(I){var C,V;P=((V=R-A)*(m-b)-(C=S-b)*(d-A))/(C*(g-d)-V*(v-m));s.push(d+(g-d)*P),s.push(m+(v-m)*P),s.push(R),s.push(S)}l=!0}if(E==s.length)return h.length=0,!0;if(s.push(s[0]),s.push(s[1]),p==f)break;var k=s;(s=u).length=0,u=k}if(h!=s){h.length=0;p=0;for(var N=s.length-2;p<N;p++)h[p]=s[p]}else h.length=h.length-2;return l},e.makeClockwise=function(t){for(var e=t,n=t.length,r=e[n-2]*e[1]-e[0]*e[n-1],a=0,i=0,o=0,s=0,h=n-3;s<h;s+=2)a=e[s],i=e[s+1],o=e[s+2],r+=a*e[s+3]-o*i;if(!(r<0)){s=0;var l=n-2;for(h=n>>1;s<h;s+=2){var u=e[s],c=e[s+1],f=l-s;e[s]=e[f],e[s+1]=e[f+1],e[f]=u,e[f+1]=c}}},e}();t.SkeletonClipping=e}(n||(n={})),function(t){var e=function(){function t(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}return t.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,r=e.length;n<r;n++){var a=e[n];if(a.name==t)return a}return null},t.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,n=0,r=e.length;n<r;n++)if(e[n].name==t)return n;return-1},t.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,r=e.length;n<r;n++){var a=e[n];if(a.name==t)return a}return null},t.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,n=0,r=e.length;n<r;n++)if(e[n].name==t)return n;return-1},t.prototype.findSkin=function(t){if(null==t)throw new Error("skinName cannot be null.");for(var e=this.skins,n=0,r=e.length;n<r;n++){var a=e[n];if(a.name==t)return a}return null},t.prototype.findEvent=function(t){if(null==t)throw new Error("eventDataName cannot be null.");for(var e=this.events,n=0,r=e.length;n<r;n++){var a=e[n];if(a.name==t)return a}return null},t.prototype.findAnimation=function(t){if(null==t)throw new Error("animationName cannot be null.");for(var e=this.animations,n=0,r=e.length;n<r;n++){var a=e[n];if(a.name==t)return a}return null},t.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,n=0,r=e.length;n<r;n++){var a=e[n];if(a.name==t)return a}return null},t.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,n=0,r=e.length;n<r;n++){var a=e[n];if(a.name==t)return a}return null},t.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,n=0,r=e.length;n<r;n++){var a=e[n];if(a.name==t)return a}return null},t.prototype.findPathConstraintIndex=function(t){if(null==t)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,n=0,r=e.length;n<r;n++)if(e[n].name==t)return n;return-1},t}();t.SkeletonData=e}(n||(n={})),function(t){var e=function(){function e(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return e.prototype.readSkeletonData=function(n){var r=this.scale,a=new t.SkeletonData,i="string"==typeof n?JSON.parse(n):n,o=i.skeleton;if(null!=o&&(a.hash=o.hash,a.version=o.spine,a.width=o.width,a.height=o.height,a.fps=o.fps,a.imagesPath=o.images),i.bones)for(var s=0;s<i.bones.length;s++){var h=i.bones[s],l=null,u=this.getValue(h,"parent",null);if(null!=u&&null==(l=a.findBone(u)))throw new Error("Parent bone not found: "+u);(d=new t.BoneData(a.bones.length,h.name,l)).length=this.getValue(h,"length",0)*r,d.x=this.getValue(h,"x",0)*r,d.y=this.getValue(h,"y",0)*r,d.rotation=this.getValue(h,"rotation",0),d.scaleX=this.getValue(h,"scaleX",1),d.scaleY=this.getValue(h,"scaleY",1),d.shearX=this.getValue(h,"shearX",0),d.shearY=this.getValue(h,"shearY",0),d.transformMode=e.transformModeFromString(this.getValue(h,"transform","normal")),a.bones.push(d)}if(i.slots)for(s=0;s<i.slots.length;s++){var c=(b=i.slots[s]).name,f=b.bone,p=a.findBone(f);if(null==p)throw new Error("Slot bone not found: "+f);var d=new t.SlotData(a.slots.length,c,p),m=this.getValue(b,"color",null);null!=m&&d.color.setFromString(m);var g=this.getValue(b,"dark",null);null!=g&&(d.darkColor=new t.Color(1,1,1,1),d.darkColor.setFromString(g)),d.attachmentName=this.getValue(b,"attachment",null),d.blendMode=e.blendModeFromString(this.getValue(b,"blend","normal")),a.slots.push(d)}if(i.ik)for(s=0;s<i.ik.length;s++){var v=i.ik[s];(d=new t.IkConstraintData(v.name)).order=this.getValue(v,"order",0);for(var y=0;y<v.bones.length;y++){f=v.bones[y];if(null==(x=a.findBone(f)))throw new Error("IK bone not found: "+f);d.bones.push(x)}var w=v.target;if(d.target=a.findBone(w),null==d.target)throw new Error("IK target bone not found: "+w);d.bendDirection=this.getValue(v,"bendPositive",!0)?1:-1,d.mix=this.getValue(v,"mix",1),a.ikConstraints.push(d)}if(i.transform)for(s=0;s<i.transform.length;s++){v=i.transform[s];(d=new t.TransformConstraintData(v.name)).order=this.getValue(v,"order",0);for(y=0;y<v.bones.length;y++){f=v.bones[y];if(null==(x=a.findBone(f)))throw new Error("Transform constraint bone not found: "+f);d.bones.push(x)}w=v.target;if(d.target=a.findBone(w),null==d.target)throw new Error("Transform constraint target bone not found: "+w);d.local=this.getValue(v,"local",!1),d.relative=this.getValue(v,"relative",!1),d.offsetRotation=this.getValue(v,"rotation",0),d.offsetX=this.getValue(v,"x",0)*r,d.offsetY=this.getValue(v,"y",0)*r,d.offsetScaleX=this.getValue(v,"scaleX",0),d.offsetScaleY=this.getValue(v,"scaleY",0),d.offsetShearY=this.getValue(v,"shearY",0),d.rotateMix=this.getValue(v,"rotateMix",1),d.translateMix=this.getValue(v,"translateMix",1),d.scaleMix=this.getValue(v,"scaleMix",1),d.shearMix=this.getValue(v,"shearMix",1),a.transformConstraints.push(d)}if(i.path)for(s=0;s<i.path.length;s++){v=i.path[s];(d=new t.PathConstraintData(v.name)).order=this.getValue(v,"order",0);for(y=0;y<v.bones.length;y++){var x;f=v.bones[y];if(null==(x=a.findBone(f)))throw new Error("Transform constraint bone not found: "+f);d.bones.push(x)}w=v.target;if(d.target=a.findSlot(w),null==d.target)throw new Error("Path target slot not found: "+w);d.positionMode=e.positionModeFromString(this.getValue(v,"positionMode","percent")),d.spacingMode=e.spacingModeFromString(this.getValue(v,"spacingMode","length")),d.rotateMode=e.rotateModeFromString(this.getValue(v,"rotateMode","tangent")),d.offsetRotation=this.getValue(v,"rotation",0),d.position=this.getValue(v,"position",0),d.positionMode==t.PositionMode.Fixed&&(d.position*=r),d.spacing=this.getValue(v,"spacing",0),d.spacingMode!=t.SpacingMode.Length&&d.spacingMode!=t.SpacingMode.Fixed||(d.spacing*=r),d.rotateMix=this.getValue(v,"rotateMix",1),d.translateMix=this.getValue(v,"translateMix",1),a.pathConstraints.push(d)}if(i.skins)for(var M in i.skins){var E=i.skins[M],T=new t.Skin(M);for(var c in E){var A=a.findSlotIndex(c);if(-1==A)throw new Error("Slot not found: "+c);var b=E[c];for(var R in b){var S=this.readAttachment(b[R],T,A,R,a);null!=S&&T.addAttachment(A,R,S)}}a.skins.push(T),"default"==T.name&&(a.defaultSkin=T)}s=0;for(var I=this.linkedMeshes.length;s<I;s++){var P=this.linkedMeshes[s];if(null==(T=null==P.skin?a.defaultSkin:a.findSkin(P.skin)))throw new Error("Skin not found: "+P.skin);var C=T.getAttachment(P.slotIndex,P.parent);if(null==C)throw new Error("Parent mesh not found: "+P.parent);P.mesh.setParentMesh(C),P.mesh.updateUVs()}if(this.linkedMeshes.length=0,i.events)for(var V in i.events){var k=i.events[V];(d=new t.EventData(V)).intValue=this.getValue(k,"int",0),d.floatValue=this.getValue(k,"float",0),d.stringValue=this.getValue(k,"string",""),a.events.push(d)}if(i.animations)for(var N in i.animations){var Y=i.animations[N];this.readAnimation(Y,N,a)}return a},e.prototype.readAttachment=function(e,r,a,i,o){var s=this.scale;switch(i=this.getValue(e,"name",i),this.getValue(e,"type","region")){case"region":var h=this.getValue(e,"path",i),l=this.attachmentLoader.newRegionAttachment(r,i,h);return null==l?null:(l.path=h,l.x=this.getValue(e,"x",0)*s,l.y=this.getValue(e,"y",0)*s,l.scaleX=this.getValue(e,"scaleX",1),l.scaleY=this.getValue(e,"scaleY",1),l.rotation=this.getValue(e,"rotation",0),l.width=e.width*s,l.height=e.height*s,null!=(M=this.getValue(e,"color",null))&&l.color.setFromString(M),l.updateOffset(),l);case"boundingbox":var u=this.attachmentLoader.newBoundingBoxAttachment(r,i);return null==u?null:(this.readVertices(e,u,e.vertexCount<<1),null!=(M=this.getValue(e,"color",null))&&u.color.setFromString(M),u);case"mesh":case"linkedmesh":h=this.getValue(e,"path",i);var c=this.attachmentLoader.newMeshAttachment(r,i,h);if(null==c)return null;c.path=h,null!=(M=this.getValue(e,"color",null))&&c.color.setFromString(M);var f=this.getValue(e,"parent",null);if(null!=f)return c.inheritDeform=this.getValue(e,"deform",!0),this.linkedMeshes.push(new n(c,this.getValue(e,"skin",null),a,f)),c;var p=e.uvs;return this.readVertices(e,c,p.length),c.triangles=e.triangles,c.regionUVs=p,c.updateUVs(),c.hullLength=2*this.getValue(e,"hull",0),c;case"path":if(null==(h=this.attachmentLoader.newPathAttachment(r,i)))return null;h.closed=this.getValue(e,"closed",!1),h.constantSpeed=this.getValue(e,"constantSpeed",!0);var d=e.vertexCount;this.readVertices(e,h,d<<1);for(var m=t.Utils.newArray(d/3,0),g=0;g<e.lengths.length;g++)m[g]=e.lengths[g]*s;return h.lengths=m,null!=(M=this.getValue(e,"color",null))&&h.color.setFromString(M),h;case"point":var v=this.attachmentLoader.newPointAttachment(r,i);return null==v?null:(v.x=this.getValue(e,"x",0)*s,v.y=this.getValue(e,"y",0)*s,v.rotation=this.getValue(e,"rotation",0),null!=(M=this.getValue(e,"color",null))&&v.color.setFromString(M),v);case"clipping":var y=this.attachmentLoader.newClippingAttachment(r,i);if(null==y)return null;var w=this.getValue(e,"end",null);if(null!=w){var x=o.findSlot(w);if(null==x)throw new Error("Clipping end slot not found: "+w);y.endSlot=x}var M;d=e.vertexCount;return this.readVertices(e,y,d<<1),null!=(M=this.getValue(e,"color",null))&&y.color.setFromString(M),y}return null},e.prototype.readVertices=function(e,n,r){var a=this.scale;n.worldVerticesLength=r;var i=e.vertices;if(r!=i.length){var o=new Array,s=new Array;for(c=0,f=i.length;c<f;){var h=i[c++];s.push(h);for(var l=c+4*h;c<l;c+=4)s.push(i[c]),o.push(i[c+1]*a),o.push(i[c+2]*a),o.push(i[c+3])}n.bones=s,n.vertices=t.Utils.toFloatArray(o)}else{var u=t.Utils.toFloatArray(i);if(1!=a)for(var c=0,f=i.length;c<f;c++)u[c]*=a;n.vertices=u}},e.prototype.readAnimation=function(e,n,r){var a=this.scale,i=new Array,o=0;if(e.slots)for(var s in e.slots){var h=e.slots[s];if(-1==(H=r.findSlotIndex(s)))throw new Error("Slot not found: "+s);for(var l in h){var u=h[l];if("attachment"==l){(x=new t.AttachmentTimeline(u.length)).slotIndex=H;for(var c=0,f=0;f<u.length;f++){var p=u[f];x.setFrame(c++,p.time,p.name)}i.push(x),o=Math.max(o,x.frames[x.getFrameCount()-1])}else if("color"==l){(x=new t.ColorTimeline(u.length)).slotIndex=H;for(c=0,f=0;f<u.length;f++){p=u[f];var d=new t.Color;d.setFromString(p.color),x.setFrame(c,p.time,d.r,d.g,d.b,d.a),this.readCurve(p,x,c),c++}i.push(x),o=Math.max(o,x.frames[(x.getFrameCount()-1)*t.ColorTimeline.ENTRIES])}else{if("twoColor"!=l)throw new Error("Invalid timeline type for a slot: "+l+" ("+s+")");(x=new t.TwoColorTimeline(u.length)).slotIndex=H;for(c=0,f=0;f<u.length;f++){p=u[f];var m=new t.Color,g=new t.Color;m.setFromString(p.light),g.setFromString(p.dark),x.setFrame(c,p.time,m.r,m.g,m.b,m.a,g.r,g.g,g.b),this.readCurve(p,x,c),c++}i.push(x),o=Math.max(o,x.frames[(x.getFrameCount()-1)*t.TwoColorTimeline.ENTRIES])}}}if(e.bones)for(var v in e.bones){var y=e.bones[v],w=r.findBoneIndex(v);if(-1==w)throw new Error("Bone not found: "+v);for(var l in y){u=y[l];if("rotate"===l){(x=new t.RotateTimeline(u.length)).boneIndex=w;for(c=0,f=0;f<u.length;f++){p=u[f];x.setFrame(c,p.time,p.angle),this.readCurve(p,x,c),c++}i.push(x),o=Math.max(o,x.frames[(x.getFrameCount()-1)*t.RotateTimeline.ENTRIES])}else{if("translate"!==l&&"scale"!==l&&"shear"!==l)throw new Error("Invalid timeline type for a bone: "+l+" ("+v+")");var x=null,M=1;"scale"===l?x=new t.ScaleTimeline(u.length):"shear"===l?x=new t.ShearTimeline(u.length):(x=new t.TranslateTimeline(u.length),M=a),x.boneIndex=w;for(c=0,f=0;f<u.length;f++){p=u[f];var E=this.getValue(p,"x",0),T=this.getValue(p,"y",0);x.setFrame(c,p.time,E*M,T*M),this.readCurve(p,x,c),c++}i.push(x),o=Math.max(o,x.frames[(x.getFrameCount()-1)*t.TranslateTimeline.ENTRIES])}}}if(e.ik)for(var A in e.ik){var b=e.ik[A],R=r.findIkConstraint(A);(x=new t.IkConstraintTimeline(b.length)).ikConstraintIndex=r.ikConstraints.indexOf(R);for(c=0,f=0;f<b.length;f++){p=b[f];x.setFrame(c,p.time,this.getValue(p,"mix",1),this.getValue(p,"bendPositive",!0)?1:-1),this.readCurve(p,x,c),c++}i.push(x),o=Math.max(o,x.frames[(x.getFrameCount()-1)*t.IkConstraintTimeline.ENTRIES])}if(e.transform)for(var A in e.transform){b=e.transform[A],R=r.findTransformConstraint(A);(x=new t.TransformConstraintTimeline(b.length)).transformConstraintIndex=r.transformConstraints.indexOf(R);for(c=0,f=0;f<b.length;f++){p=b[f];x.setFrame(c,p.time,this.getValue(p,"rotateMix",1),this.getValue(p,"translateMix",1),this.getValue(p,"scaleMix",1),this.getValue(p,"shearMix",1)),this.readCurve(p,x,c),c++}i.push(x),o=Math.max(o,x.frames[(x.getFrameCount()-1)*t.TransformConstraintTimeline.ENTRIES])}if(e.paths)for(var A in e.paths){b=e.paths[A];var S=r.findPathConstraintIndex(A);if(-1==S)throw new Error("Path constraint not found: "+A);var I=r.pathConstraints[S];for(var l in b){u=b[l];if("position"===l||"spacing"===l){x=null,M=1;"spacing"===l?(x=new t.PathConstraintSpacingTimeline(u.length),I.spacingMode!=t.SpacingMode.Length&&I.spacingMode!=t.SpacingMode.Fixed||(M=a)):(x=new t.PathConstraintPositionTimeline(u.length),I.positionMode==t.PositionMode.Fixed&&(M=a)),x.pathConstraintIndex=S;for(c=0,f=0;f<u.length;f++){p=u[f];x.setFrame(c,p.time,this.getValue(p,l,0)*M),this.readCurve(p,x,c),c++}i.push(x),o=Math.max(o,x.frames[(x.getFrameCount()-1)*t.PathConstraintPositionTimeline.ENTRIES])}else if("mix"===l){(x=new t.PathConstraintMixTimeline(u.length)).pathConstraintIndex=S;for(c=0,f=0;f<u.length;f++){p=u[f];x.setFrame(c,p.time,this.getValue(p,"rotateMix",1),this.getValue(p,"translateMix",1)),this.readCurve(p,x,c),c++}i.push(x),o=Math.max(o,x.frames[(x.getFrameCount()-1)*t.PathConstraintMixTimeline.ENTRIES])}}}if(e.deform)for(var P in e.deform){var C=e.deform[P],V=r.findSkin(P);if(null==V)throw new Error("Skin not found: "+P);for(var s in C){h=C[s];if(-1==(H=r.findSlotIndex(s)))throw new Error("Slot not found: "+h.name);for(var l in h){u=h[l];var k=V.getAttachment(H,l);if(null==k)throw new Error("Deform attachment not found: "+u.name);var N=null!=k.bones,Y=k.vertices,_=N?Y.length/3*2:Y.length;(x=new t.DeformTimeline(u.length)).slotIndex=H,x.attachment=k;c=0;for(var D=0;D<u.length;D++){p=u[D];var X=void 0,U=this.getValue(p,"vertices",null);if(null==U)X=N?t.Utils.newFloatArray(_):Y;else{X=t.Utils.newFloatArray(_);var F=this.getValue(p,"offset",0);if(t.Utils.arrayCopy(U,0,X,F,U.length),1!=a)for(var L=(f=F)+U.length;f<L;f++)X[f]*=a;if(!N)for(f=0;f<_;f++)X[f]+=Y[f]}x.setFrame(c,p.time,X),this.readCurve(p,x,c),c++}i.push(x),o=Math.max(o,x.frames[x.getFrameCount()-1])}}}var O=e.drawOrder;if(null==O&&(O=e.draworder),null!=O){x=new t.DrawOrderTimeline(O.length);var B=r.slots.length;for(c=0,D=0;D<O.length;D++){var W=O[D],q=null,j=this.getValue(W,"offsets",null);if(null!=j){q=t.Utils.newArray(B,-1);var G=t.Utils.newArray(B-j.length,0),z=0,Z=0;for(f=0;f<j.length;f++){var H,J=j[f];if(-1==(H=r.findSlotIndex(J.slot)))throw new Error("Slot not found: "+J.slot);for(;z!=H;)G[Z++]=z++;q[z+J.offset]=z++}for(;z<B;)G[Z++]=z++;for(f=B-1;f>=0;f--)-1==q[f]&&(q[f]=G[--Z])}x.setFrame(c++,W.time,q)}i.push(x),o=Math.max(o,x.frames[x.getFrameCount()-1])}if(e.events){for(x=new t.EventTimeline(e.events.length),c=0,f=0;f<e.events.length;f++){var Q=e.events[f],K=r.findEvent(Q.name);if(null==K)throw new Error("Event not found: "+Q.name);var $=new t.Event(t.Utils.toSinglePrecision(Q.time),K);$.intValue=this.getValue(Q,"int",K.intValue),$.floatValue=this.getValue(Q,"float",K.floatValue),$.stringValue=this.getValue(Q,"string",K.stringValue),x.setFrame(c++,$)}i.push(x),o=Math.max(o,x.frames[x.getFrameCount()-1])}if(isNaN(o))throw new Error("Error while parsing animation, duration is NaN");r.animations.push(new t.Animation(n,i,o))},e.prototype.readCurve=function(t,e,n){if(t.curve)if("stepped"===t.curve)e.setStepped(n);else if("[object Array]"===Object.prototype.toString.call(t.curve)){var r=t.curve;e.setCurve(n,r[0],r[1],r[2],r[3])}},e.prototype.getValue=function(t,e,n){return void 0!==t[e]?t[e]:n},e.blendModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.BlendMode.Normal;if("additive"==e)return t.BlendMode.Additive;if("multiply"==e)return t.BlendMode.Multiply;if("screen"==e)return t.BlendMode.Screen;throw new Error("Unknown blend mode: "+e)},e.positionModeFromString=function(e){if("fixed"==(e=e.toLowerCase()))return t.PositionMode.Fixed;if("percent"==e)return t.PositionMode.Percent;throw new Error("Unknown position mode: "+e)},e.spacingModeFromString=function(e){if("length"==(e=e.toLowerCase()))return t.SpacingMode.Length;if("fixed"==e)return t.SpacingMode.Fixed;if("percent"==e)return t.SpacingMode.Percent;throw new Error("Unknown position mode: "+e)},e.rotateModeFromString=function(e){if("tangent"==(e=e.toLowerCase()))return t.RotateMode.Tangent;if("chain"==e)return t.RotateMode.Chain;if("chainscale"==e)return t.RotateMode.ChainScale;throw new Error("Unknown rotate mode: "+e)},e.transformModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.TransformMode.Normal;if("onlytranslation"==e)return t.TransformMode.OnlyTranslation;if("norotationorreflection"==e)return t.TransformMode.NoRotationOrReflection;if("noscale"==e)return t.TransformMode.NoScale;if("noscaleorreflection"==e)return t.TransformMode.NoScaleOrReflection;throw new Error("Unknown transform mode: "+e)},e}();t.SkeletonJson=e;var n=function(){return function(t,e,n,r){this.mesh=t,this.skin=e,this.slotIndex=n,this.parent=r}}()}(n||(n={})),function(t){var e=function(){function t(t){if(this.attachments=new Array,null==t)throw new Error("name cannot be null.");this.name=t}return t.prototype.addAttachment=function(t,e,n){if(null==n)throw new Error("attachment cannot be null.");var r=this.attachments;t>=r.length&&(r.length=t+1),r[t]||(r[t]={}),r[t][e]=n},t.prototype.getAttachment=function(t,e){var n=this.attachments[t];return n?n[e]:null},t.prototype.attachAll=function(t,e){for(var n=0,r=0;r<t.slots.length;r++){var a=t.slots[r],i=a.getAttachment();if(i&&n<e.attachments.length){var o=e.attachments[n];for(var s in o){if(i==o[s]){var h=this.getAttachment(n,s);null!=h&&a.setAttachment(h);break}}}n++}},t}();t.Skin=e}(n||(n={})),function(t){var e=function(){function e(e,n){if(this.attachmentVertices=new Array,null==e)throw new Error("data cannot be null.");if(null==n)throw new Error("bone cannot be null.");this.data=e,this.bone=n,this.color=new t.Color,this.darkColor=null==e.darkColor?null:new t.Color,this.setToSetupPose()}return e.prototype.getAttachment=function(){return this.attachment},e.prototype.setAttachment=function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)},e.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},e.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},e.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},e}();t.Slot=e}(n||(n={})),function(t){var e=function(){return function(e,n,r){if(this.color=new t.Color(1,1,1,1),e<0)throw new Error("index must be >= 0.");if(null==n)throw new Error("name cannot be null.");if(null==r)throw new Error("boneData cannot be null.");this.index=e,this.name=n,this.boneData=r}}();t.SlotData=e}(n||(n={})),function(t){var e,n,a=function(){function t(t){this._image=t}return t.prototype.getImage=function(){return this._image},t.filterFromString=function(t){switch(t.toLowerCase()){case"nearest":return e.Nearest;case"linear":return e.Linear;case"mipmap":return e.MipMap;case"mipmapnearestnearest":return e.MipMapNearestNearest;case"mipmaplinearnearest":return e.MipMapLinearNearest;case"mipmapnearestlinear":return e.MipMapNearestLinear;case"mipmaplinearlinear":return e.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+t)}},t.wrapFromString=function(t){switch(t.toLowerCase()){case"mirroredtepeat":return n.MirroredRepeat;case"clamptoedge":return n.ClampToEdge;case"repeat":return n.Repeat;default:throw new Error("Unknown texture wrap "+t)}},t}();t.Texture=a,function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"}(e=t.TextureFilter||(t.TextureFilter={})),function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"}(n=t.TextureWrap||(t.TextureWrap={}));var i=function(){return function(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.rotate=!1,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0}}();t.TextureRegion=i;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setFilters=function(t,e){},e.prototype.setWraps=function(t,e){},e.prototype.dispose=function(){},e}(t.Texture);t.FakeTexture=o}(n||(n={})),function(t){var e=function(){function e(t,e){this.pages=new Array,this.regions=new Array,this.load(t,e)}return e.prototype.load=function(e,r){if(null==r)throw new Error("textureLoader cannot be null.");for(var o=new n(e),s=new Array(4),h=null;;){var l=o.readLine();if(null==l)break;if(0==(l=l.trim()).length)h=null;else if(h){var u=new i;u.name=l,u.page=h,u.rotate="true"==o.readValue(),o.readTuple(s);var c=parseInt(s[0]),f=parseInt(s[1]);o.readTuple(s);var p=parseInt(s[0]),d=parseInt(s[1]);u.u=c/h.width,u.v=f/h.height,u.rotate?(u.u2=(c+d)/h.width,u.v2=(f+p)/h.height):(u.u2=(c+p)/h.width,u.v2=(f+d)/h.height),u.x=c,u.y=f,u.width=Math.abs(p),u.height=Math.abs(d),4==o.readTuple(s)&&4==o.readTuple(s)&&o.readTuple(s),u.originalWidth=parseInt(s[0]),u.originalHeight=parseInt(s[1]),o.readTuple(s),u.offsetX=parseInt(s[0]),u.offsetY=parseInt(s[1]),u.index=parseInt(o.readValue()),u.texture=h.texture,this.regions.push(u)}else{(h=new a).name=l,2==o.readTuple(s)&&(h.width=parseInt(s[0]),h.height=parseInt(s[1]),o.readTuple(s)),o.readTuple(s),h.minFilter=t.Texture.filterFromString(s[0]),h.magFilter=t.Texture.filterFromString(s[1]);var m=o.readValue();h.uWrap=t.TextureWrap.ClampToEdge,h.vWrap=t.TextureWrap.ClampToEdge,"x"==m?h.uWrap=t.TextureWrap.Repeat:"y"==m?h.vWrap=t.TextureWrap.Repeat:"xy"==m&&(h.uWrap=h.vWrap=t.TextureWrap.Repeat),h.texture=r(l),h.texture.setFilters(h.minFilter,h.magFilter),h.texture.setWraps(h.uWrap,h.vWrap),h.width=h.texture.getImage().width,h.height=h.texture.getImage().height,this.pages.push(h)}}},e.prototype.findRegion=function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null},e.prototype.dispose=function(){for(var t=0;t<this.pages.length;t++)this.pages[t].texture.dispose()},e}();t.TextureAtlas=e;var n=function(){function t(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}return t.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},t.prototype.readValue=function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw new Error("Invalid line: "+t);return t.substring(e+1).trim()},t.prototype.readTuple=function(t){var e=this.readLine(),n=e.indexOf(":");if(-1==n)throw new Error("Invalid line: "+e);for(var r=0,a=n+1;r<3;r++){var i=e.indexOf(",",a);if(-1==i)break;t[r]=e.substr(a,i-a).trim(),a=i+1}return t[r]=e.substring(a).trim(),r+1},t}(),a=function(){return function(){}}();t.TextureAtlasPage=a;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(t.TextureRegion);t.TextureAtlasRegion=i}(n||(n={})),function(t){var e=function(){function e(e,n){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new t.Vector2,null==e)throw new Error("data cannot be null.");if(null==n)throw new Error("skeleton cannot be null.");this.data=e,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.scaleMix=e.scaleMix,this.shearMix=e.shearMix,this.bones=new Array;for(var r=0;r<e.bones.length;r++)this.bones.push(n.findBone(e.bones[r].name));this.target=n.findBone(e.target.name)}return e.prototype.apply=function(){this.update()},e.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},e.prototype.applyAbsoluteWorld=function(){for(var e=this.rotateMix,n=this.translateMix,r=this.scaleMix,a=this.shearMix,i=this.target,o=i.a,s=i.b,h=i.c,l=i.d,u=o*l-s*h>0?t.MathUtils.degRad:-t.MathUtils.degRad,c=this.data.offsetRotation*u,f=this.data.offsetShearY*u,p=this.bones,d=0,m=p.length;d<m;d++){var g=p[d],v=!1;if(0!=e){var y=g.a,w=g.b,x=g.c,M=g.d;(S=Math.atan2(h,o)-Math.atan2(x,y)+c)>t.MathUtils.PI?S-=t.MathUtils.PI2:S<-t.MathUtils.PI&&(S+=t.MathUtils.PI2),S*=e;var E=Math.cos(S),T=Math.sin(S);g.a=E*y-T*x,g.b=E*w-T*M,g.c=T*y+E*x,g.d=T*w+E*M,v=!0}if(0!=n){var A=this.temp;i.localToWorld(A.set(this.data.offsetX,this.data.offsetY)),g.worldX+=(A.x-g.worldX)*n,g.worldY+=(A.y-g.worldY)*n,v=!0}if(r>0){var b=Math.sqrt(g.a*g.a+g.c*g.c),R=Math.sqrt(o*o+h*h);b>1e-5&&(b=(b+(R-b+this.data.offsetScaleX)*r)/b),g.a*=b,g.c*=b,b=Math.sqrt(g.b*g.b+g.d*g.d),R=Math.sqrt(s*s+l*l),b>1e-5&&(b=(b+(R-b+this.data.offsetScaleY)*r)/b),g.b*=b,g.d*=b,v=!0}if(a>0){w=g.b,M=g.d;var S,I=Math.atan2(M,w);(S=Math.atan2(l,s)-Math.atan2(h,o)-(I-Math.atan2(g.c,g.a)))>t.MathUtils.PI?S-=t.MathUtils.PI2:S<-t.MathUtils.PI&&(S+=t.MathUtils.PI2),S=I+(S+f)*a;b=Math.sqrt(w*w+M*M);g.b=Math.cos(S)*b,g.d=Math.sin(S)*b,v=!0}v&&(g.appliedValid=!1)}},e.prototype.applyRelativeWorld=function(){for(var e=this.rotateMix,n=this.translateMix,r=this.scaleMix,a=this.shearMix,i=this.target,o=i.a,s=i.b,h=i.c,l=i.d,u=o*l-s*h>0?t.MathUtils.degRad:-t.MathUtils.degRad,c=this.data.offsetRotation*u,f=this.data.offsetShearY*u,p=this.bones,d=0,m=p.length;d<m;d++){var g=p[d],v=!1;if(0!=e){var y=g.a,w=g.b,x=g.c,M=g.d;(R=Math.atan2(h,o)+c)>t.MathUtils.PI?R-=t.MathUtils.PI2:R<-t.MathUtils.PI&&(R+=t.MathUtils.PI2),R*=e;var E=Math.cos(R),T=Math.sin(R);g.a=E*y-T*x,g.b=E*w-T*M,g.c=T*y+E*x,g.d=T*w+E*M,v=!0}if(0!=n){var A=this.temp;i.localToWorld(A.set(this.data.offsetX,this.data.offsetY)),g.worldX+=A.x*n,g.worldY+=A.y*n,v=!0}if(r>0){var b=(Math.sqrt(o*o+h*h)-1+this.data.offsetScaleX)*r+1;g.a*=b,g.c*=b,b=(Math.sqrt(s*s+l*l)-1+this.data.offsetScaleY)*r+1,g.b*=b,g.d*=b,v=!0}if(a>0){var R;(R=Math.atan2(l,s)-Math.atan2(h,o))>t.MathUtils.PI?R-=t.MathUtils.PI2:R<-t.MathUtils.PI&&(R+=t.MathUtils.PI2);w=g.b,M=g.d;R=Math.atan2(M,w)+(R-t.MathUtils.PI/2+f)*a;b=Math.sqrt(w*w+M*M);g.b=Math.cos(R)*b,g.d=Math.sin(R)*b,v=!0}v&&(g.appliedValid=!1)}},e.prototype.applyAbsoluteLocal=function(){var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,r=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var i=this.bones,o=0,s=i.length;o<s;o++){var h=i[o];h.appliedValid||h.updateAppliedTransform();var l=h.arotation;if(0!=t){var u=a.arotation-l+this.data.offsetRotation;l+=(u-=360*(16384-(16384.499999999996-u/360|0)))*t}var c=h.ax,f=h.ay;0!=e&&(c+=(a.ax-c+this.data.offsetX)*e,f+=(a.ay-f+this.data.offsetY)*e);var p=h.ascaleX,d=h.ascaleY;n>0&&(p>1e-5&&(p=(p+(a.ascaleX-p+this.data.offsetScaleX)*n)/p),d>1e-5&&(d=(d+(a.ascaleY-d+this.data.offsetScaleY)*n)/d));var m=h.ashearY;if(r>0){u=a.ashearY-m+this.data.offsetShearY;u-=360*(16384-(16384.499999999996-u/360|0)),h.shearY+=u*r}h.updateWorldTransformWith(c,f,l,p,d,h.ashearX,m)}},e.prototype.applyRelativeLocal=function(){var t=this.rotateMix,e=this.translateMix,n=this.scaleMix,r=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var i=this.bones,o=0,s=i.length;o<s;o++){var h=i[o];h.appliedValid||h.updateAppliedTransform();var l=h.arotation;0!=t&&(l+=(a.arotation+this.data.offsetRotation)*t);var u=h.ax,c=h.ay;0!=e&&(u+=(a.ax+this.data.offsetX)*e,c+=(a.ay+this.data.offsetY)*e);var f=h.ascaleX,p=h.ascaleY;n>0&&(f>1e-5&&(f*=(a.ascaleX-1+this.data.offsetScaleX)*n+1),p>1e-5&&(p*=(a.ascaleY-1+this.data.offsetScaleY)*n+1));var d=h.ashearY;r>0&&(d+=(a.ashearY+this.data.offsetShearY)*r),h.updateWorldTransformWith(u,c,l,f,p,h.ashearX,d)}},e.prototype.getOrder=function(){return this.data.order},e}();t.TransformConstraint=e}(n||(n={})),function(t){var e=function(){return function(t){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,null==t)throw new Error("name cannot be null.");this.name=t}}();t.TransformConstraintData=e}(n||(n={})),function(t){var e=function(){function t(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new core.Pool(function(){return new Array}),this.polygonIndicesPool=new core.Pool(function(){return new Array})}return t.prototype.triangulate=function(e){var n=e,r=e.length>>1,a=this.indicesArray;a.length=0;for(var i=0;i<r;i++)a[i]=i;var o=this.isConcaveArray;o.length=0;i=0;for(var s=r;i<s;++i)o[i]=t.isConcave(i,r,n,a);var h=this.triangles;for(h.length=0;r>3;){for(var l=r-1,u=(i=0,1);;){t:if(!o[i]){for(var c=a[l]<<1,f=a[i]<<1,p=a[u]<<1,d=n[c],m=n[c+1],g=n[f],v=n[f+1],y=n[p],w=n[p+1],x=(u+1)%r;x!=l;x=(x+1)%r)if(o[x]){var M=a[x]<<1,E=n[M],T=n[M+1];if(t.positiveArea(y,w,d,m,E,T)&&t.positiveArea(d,m,g,v,E,T)&&t.positiveArea(g,v,y,w,E,T))break t}break}if(0==u){do{if(!o[i])break;i--}while(i>0);break}l=i,i=u,u=(u+1)%r}h.push(a[(r+i-1)%r]),h.push(a[i]),h.push(a[(i+1)%r]),a.splice(i,1),o.splice(i,1);var A=(--r+i-1)%r,b=i==r?0:i;o[A]=t.isConcave(A,r,n,a),o[b]=t.isConcave(b,r,n,a)}return 3==r&&(h.push(a[2]),h.push(a[0]),h.push(a[1])),h},t.prototype.decompose=function(e,n){var r=e,a=this.convexPolygons;this.polygonPool.freeAll(a),a.length=0;var i=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(i),i.length=0;var o=this.polygonIndicesPool.obtain();o.length=0;var s=this.polygonPool.obtain();s.length=0;for(var h=-1,l=0,u=0,c=n.length;u<c;u+=3){var f=n[u]<<1,p=n[u+1]<<1,d=n[u+2]<<1,m=r[f],g=r[f+1],v=r[p],y=r[p+1],w=r[d],x=r[d+1],M=!1;if(h==f){var E=s.length-4,T=t.winding(s[E],s[E+1],s[E+2],s[E+3],w,x),A=t.winding(w,x,s[0],s[1],s[2],s[3]);T==l&&A==l&&(s.push(w),s.push(x),o.push(d),M=!0)}M||(s.length>0?(a.push(s),i.push(o)):(this.polygonPool.free(s),this.polygonIndicesPool.free(o)),(s=this.polygonPool.obtain()).length=0,s.push(m),s.push(g),s.push(v),s.push(y),s.push(w),s.push(x),(o=this.polygonIndicesPool.obtain()).length=0,o.push(f),o.push(p),o.push(d),l=t.winding(m,g,v,y,w,x),h=f)}s.length>0&&(a.push(s),i.push(o));for(u=0,c=a.length;u<c;u++)if(0!=(o=i[u]).length)for(var b=o[0],R=o[o.length-1],S=(s=a[u])[E=s.length-4],I=s[E+1],P=s[E+2],C=s[E+3],V=s[0],k=s[1],N=s[2],Y=s[3],_=t.winding(S,I,P,C,V,k),D=0;D<c;D++)if(D!=u){var X=i[D];if(3==X.length){var U=X[0],F=X[1],L=X[2],O=a[D];w=O[O.length-2],x=O[O.length-1];if(U==b&&F==R){T=t.winding(S,I,P,C,w,x),A=t.winding(w,x,V,k,N,Y);T==_&&A==_&&(O.length=0,X.length=0,s.push(w),s.push(x),o.push(L),S=P,I=C,P=w,C=x,D=0)}}}for(u=a.length-1;u>=0;u--)0==(s=a[u]).length&&(a.splice(u,1),this.polygonPool.free(s),o=i[u],i.splice(u,1),this.polygonIndicesPool.free(o));return a},t.isConcave=function(t,e,n,r){var a=r[(e+t-1)%e]<<1,i=r[t]<<1,o=r[(t+1)%e]<<1;return!this.positiveArea(n[a],n[a+1],n[i],n[i+1],n[o],n[o+1])},t.positiveArea=function(t,e,n,r,a,i){return t*(i-r)+n*(e-i)+a*(r-e)>=0},t.winding=function(t,e,n,r,a,i){var o=n-t,s=r-e;return a*s-i*o+o*e-t*s>=0?1:-1},t}();t.Triangulator=e}(n||(n={})),function(t){var e=function(){function t(){this.array=new Array}return t.prototype.add=function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e},t.prototype.contains=function(t){return null!=this.array[0|t]},t.prototype.remove=function(t){this.array[0|t]=void 0},t.prototype.clear=function(){this.array.length=0},t}();t.IntSet=e;var n=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.r=t,this.g=e,this.b=n,this.a=r}return t.prototype.set=function(t,e,n,r){return this.r=t,this.g=e,this.b=n,this.a=r,this.clamp(),this},t.prototype.setFromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},t.prototype.setFromString=function(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=(8!=t.length?255:parseInt(t.substr(6,2),16))/255,this},t.prototype.add=function(t,e,n,r){return this.r+=t,this.g+=e,this.b+=n,this.a+=r,this.clamp(),this},t.prototype.clamp=function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this},t}();n.WHITE=new n(1,1,1,1),n.RED=new n(1,0,0,1),n.GREEN=new n(0,1,0,1),n.BLUE=new n(0,0,1,1),n.MAGENTA=new n(1,0,1,1),t.Color=n;var a=function(){function t(){}return t.clamp=function(t,e,n){return t<e?e:t>n?n:t},t.cosDeg=function(e){return Math.cos(e*t.degRad)},t.sinDeg=function(e){return Math.sin(e*t.degRad)},t.signum=function(t){return t>0?1:t<0?-1:0},t.toInt=function(t){return t>0?Math.floor(t):Math.ceil(t)},t.cbrt=function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e},t.randomTriangular=function(e,n){return t.randomTriangularWith(e,n,.5*(e+n))},t.randomTriangularWith=function(t,e,n){var r=Math.random(),a=e-t;return r<=(n-t)/a?t+Math.sqrt(r*a*(n-t)):e-Math.sqrt((1-r)*a*(e-n))},t}();a.PI=3.1415927,a.PI2=2*a.PI,a.radiansToDegrees=180/a.PI,a.radDeg=a.radiansToDegrees,a.degreesToRadians=a.PI/180,a.degRad=a.degreesToRadians,t.MathUtils=a;var i=function(){function t(){}return t.prototype.apply=function(t,e,n){return t+(e-t)*this.applyInternal(n)},t}();t.Interpolation=i;var o=function(t){function e(e){var n=t.call(this)||this;return n.power=2,n.power=e,n}return r(e,t),e.prototype.applyInternal=function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2==0?-2:2)+1},e}(i);t.Pow=o;var s=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.applyInternal=function(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1},e}(o);t.PowOut=s;var h=function(){function t(){}return t.arrayCopy=function(t,e,n,r,a){for(var i=e,o=r;i<e+a;i++,o++)n[o]=t[i]},t.setArraySize=function(t,e,n){void 0===n&&(n=0);var r=t.length;if(r==e)return t;if(t.length=e,r<e)for(var a=r;a<e;a++)t[a]=n;return t},t.ensureArrayCapacity=function(e,n,r){return void 0===r&&(r=0),e.length>=n?e:t.setArraySize(e,n,r)},t.newArray=function(t,e){for(var n=new Array(t),r=0;r<t;r++)n[r]=e;return n},t.newFloatArray=function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);for(var n=new Array(e),r=0;r<n.length;r++)n[r]=0;return n},t.newShortArray=function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);for(var n=new Array(e),r=0;r<n.length;r++)n[r]=0;return n},t.toFloatArray=function(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e},t.toSinglePrecision=function(e){return t.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e},t}();h.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array,t.Utils=h;var l=function(){function t(){}return t.logBones=function(t){for(var e=0;e<t.bones.length;e++){var n=t.bones[e];console.log(n.data.name+", "+n.a+", "+n.b+", "+n.c+", "+n.d+", "+n.worldX+", "+n.worldY)}},t}();t.DebugUtils=l;var u=function(){function t(t){this.items=new Array,this.instantiator=t}return t.prototype.obtain=function(){return this.items.length>0?this.items.pop():this.instantiator()},t.prototype.free=function(t){t.reset&&t.reset(),this.items.push(t)},t.prototype.freeAll=function(t){for(var e=0;e<t.length;e++)t[e].reset&&t[e].reset(),this.items[e]=t[e]},t.prototype.clear=function(){this.items.length=0},t}();t.Pool=u;var c=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},t.prototype.normalize=function(){var t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this},t}();t.Vector2=c;var f=function(){function t(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return t.prototype.update=function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},t}();t.TimeKeeper=f;var p=function(){function t(t){void 0===t&&(t=32),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(t)}return t.prototype.hasEnoughData=function(){return this.addedValues>=this.values.length},t.prototype.addValue=function(t){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=t,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0},t.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<this.values.length;e++)t+=this.values[e];this.mean=t/this.values.length,this.dirty=!1}return this.mean}return 0},t}();t.WindowedMean=p}(n||(n={})),function(t){var e=function(){return function(t){if(null==t)throw new Error("name cannot be null.");this.name=t}}();t.Attachment=e;var n=function(t){function e(n){var r=t.call(this,n)||this;return r.id=(65535&e.nextID++)<<11,r.worldVerticesLength=0,r}return r(e,t),e.prototype.computeWorldVerticesOld=function(t,e){this.computeWorldVertices(t,0,this.worldVerticesLength,e,0,2)},e.prototype.computeWorldVertices=function(t,e,n,r,a,i){n=a+(n>>1)*i;var o=t.bone.skeleton,s=t.attachmentVertices,h=this.vertices,l=this.bones;if(null!=l){for(var u=0,c=0,f=0;f<e;f+=2){u+=(g=l[u])+1,c+=g}var p=o.bones;if(0==s.length)for(I=a,A=3*c;I<n;I+=i){var d=0,m=0,g=l[u++];for(g+=u;u<g;u++,A+=3){x=p[l[u]],P=h[A],C=h[A+1];var v=h[A+2];d+=(P*x.a+C*x.b+x.worldX)*v,m+=(P*x.c+C*x.d+x.worldY)*v}r[I]=d,r[I+1]=m}else for(var y=s,w=(I=a,A=3*c,c<<1);I<n;I+=i){d=0,m=0,g=l[u++];for(g+=u;u<g;u++,A+=3,w+=2){x=p[l[u]],P=h[A]+y[w],C=h[A+1]+y[w+1],v=h[A+2];d+=(P*x.a+C*x.b+x.worldX)*v,m+=(P*x.c+C*x.d+x.worldY)*v}r[I]=d,r[I+1]=m}}else{s.length>0&&(h=s);for(var x,M=(x=t.bone).worldX,E=x.worldY,T=x.a,A=x.b,b=x.c,R=x.d,S=e,I=a;I<n;S+=2,I+=i){var P=h[S],C=h[S+1];r[I]=P*T+C*A+M,r[I+1]=P*b+C*R+E}}},e.prototype.applyDeform=function(t){return this==t},e}(e);n.nextID=0,t.VertexAttachment=n}(n||(n={})),function(t){!function(t){t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point"}(t.AttachmentType||(t.AttachmentType={}))}(n||(n={})),function(t){var e=function(e){function n(n){var r=e.call(this,n)||this;return r.color=new t.Color(1,1,1,1),r}return r(n,e),n}(t.VertexAttachment);t.BoundingBoxAttachment=e}(n||(n={})),function(t){var e=function(e){function n(n){var r=e.call(this,n)||this;return r.color=new t.Color(.2275,.2275,.8078,1),r}return r(n,e),n}(t.VertexAttachment);t.ClippingAttachment=e}(n||(n={})),function(t){var e=function(e){function n(n){var r=e.call(this,n)||this;return r.color=new t.Color(1,1,1,1),r.inheritDeform=!1,r.tempColor=new t.Color(0,0,0,0),r}return r(n,e),n.prototype.updateUVs=function(e,n){var r=this.regionUVs.length;if(n&&n.length==r||(n=t.Utils.newFloatArray(r)),null!=e){for(var a=e._texture._uvs,i=e.width,o=e.height,s=e.originalWidth,h=e.originalHeight,l=e.offsetX,u=e.offsetY,c=0;c<r;c+=2){var f=this.regionUVs[c],p=this.regionUVs[c+1];f=(f*s-l)/i,p=(p*h-u)/o,n[c]=(a.x0*(1-f)+a.x1*f)*(1-p)+(a.x3*(1-f)+a.x2*f)*p,n[c+1]=(a.y0*(1-f)+a.y1*f)*(1-p)+(a.y3*(1-f)+a.y2*f)*p}return n}},n.prototype.applyDeform=function(t){return this==t||this.inheritDeform&&this.parentMesh==t},n.prototype.getParentMesh=function(){return this.parentMesh},n.prototype.setParentMesh=function(t){this.parentMesh=t,null!=t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)},n}(t.VertexAttachment);t.MeshAttachment=e}(n||(n={})),function(t){var e=function(e){function n(n){var r=e.call(this,n)||this;return r.closed=!1,r.constantSpeed=!1,r.color=new t.Color(1,1,1,1),r}return r(n,e),n}(t.VertexAttachment);t.PathAttachment=e}(n||(n={})),function(t){var e=function(e){function n(n){var r=e.call(this,n)||this;return r.color=new t.Color(.38,.94,0,1),r}return r(n,e),n.prototype.computeWorldPosition=function(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e},n.prototype.computeWorldRotation=function(e){var n=t.MathUtils.cosDeg(this.rotation),r=t.MathUtils.sinDeg(this.rotation),a=n*e.a+r*e.b,i=n*e.c+r*e.d;return Math.atan2(i,a)*t.MathUtils.radDeg},n}(t.VertexAttachment);t.PointAttachment=e}(n||(n={})),function(t){var e=function(e){function n(n){var r=e.call(this,n)||this;return r.x=0,r.y=0,r.scaleX=1,r.scaleY=1,r.rotation=0,r.width=0,r.height=0,r.color=new t.Color(1,1,1,1),r.offset=t.Utils.newFloatArray(8),r.uvs=t.Utils.newFloatArray(8),r.tempColor=new t.Color(1,1,1,1),r}return r(n,e),n.prototype.updateOffset=function(){var t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,r=-this.width/2*this.scaleX+this.region.offsetX*t,a=-this.height/2*this.scaleY+this.region.offsetY*e,i=r+this.region.width*t,o=a+this.region.height*e,s=this.rotation*Math.PI/180,h=Math.cos(s),l=Math.sin(s),u=r*h+this.x,c=r*l,f=a*h+this.y,p=a*l,d=i*h+this.x,m=i*l,g=o*h+this.y,v=o*l,y=this.offset;y[n.OX1]=u-p,y[n.OY1]=f+c,y[n.OX2]=u-v,y[n.OY2]=g+c,y[n.OX3]=d-v,y[n.OY3]=g+m,y[n.OX4]=d-p,y[n.OY4]=f+m},n.prototype.setRegion=function(t){this.region=t;var e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)},n.prototype.computeWorldVertices=function(t,e,r,a){var i=this.offset,o=t.worldX,s=t.worldY,h=t.a,l=t.b,u=t.c,c=t.d,f=0,p=0;f=i[n.OX1],p=i[n.OY1],e[r]=f*h+p*l+o,e[r+1]=f*u+p*c+s,r+=a,f=i[n.OX2],p=i[n.OY2],e[r]=f*h+p*l+o,e[r+1]=f*u+p*c+s,r+=a,f=i[n.OX3],p=i[n.OY3],e[r]=f*h+p*l+o,e[r+1]=f*u+p*c+s,r+=a,f=i[n.OX4],p=i[n.OY4],e[r]=f*h+p*l+o,e[r+1]=f*u+p*c+s},n}(t.Attachment);e.OX1=0,e.OY1=1,e.OX2=2,e.OY2=3,e.OX3=4,e.OY3=5,e.OX4=6,e.OY4=7,e.X1=0,e.Y1=1,e.C1R=2,e.C1G=3,e.C1B=4,e.C1A=5,e.U1=6,e.V1=7,e.X2=8,e.Y2=9,e.C2R=10,e.C2G=11,e.C2B=12,e.C2A=13,e.U2=14,e.V2=15,e.X3=16,e.Y3=17,e.C3R=18,e.C3G=19,e.C3B=20,e.C3A=21,e.U3=22,e.V3=23,e.X4=24,e.Y4=25,e.C4R=26,e.C4G=27,e.C4B=28,e.C4A=29,e.U4=30,e.V4=31,t.RegionAttachment=e}(n||(n={})),function(t){var e=function(){function e(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}return e.prototype.begin=function(t){},e.prototype.transform=function(e,n,r,a){e.x+=t.MathUtils.randomTriangular(-this.jitterX,this.jitterY),e.y+=t.MathUtils.randomTriangular(-this.jitterX,this.jitterY)},e.prototype.end=function(){},e}();t.JitterEffect=e}(n||(n={})),function(t){var e=function(){function e(t){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t}return e.prototype.begin=function(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY},e.prototype.transform=function(n,r,a,i){var o=this.angle*t.MathUtils.degreesToRadians,s=n.x-this.worldX,h=n.y-this.worldY,l=Math.sqrt(s*s+h*h);if(l<this.radius){var u=e.interpolation.apply(0,o,(this.radius-l)/this.radius),c=Math.cos(u),f=Math.sin(u);n.x=c*s-f*h+this.worldX,n.y=f*s+c*h+this.worldY}},e.prototype.end=function(){},e}();e.interpolation=new t.PowOut(2),t.SwirlEffect=e}(n||(n={})),game.spine=n,game.spine.AtlasCache={},game.Loader.inject({loadAtlas:function(t,e){this.loadFile(t,this.parseAtlas.bind(this,t,e))},parseAtlas:function(t,e,n){n.responseText&&404!==n.status||e("Error loading Atlas "+t);try{JSON.parse(n.responseText)}catch(i){var r=0,a=new game.spine.TextureAtlas(n.responseText,function(t){return r++,new game.spine.FakeTexture(game.BaseTexture.fromImage(game._getFilePath(t),function(){r--,game.paths[t]=game._getFilePath(t),0===r&&e()}))});return void(game.spine.AtlasCache[t]=a)}this.parseJSON(t,e,n)}}),game.createClass("Spine","Container",{skeleton:null,spineData:null,state:null,stateData:null,_slotContainers:[],staticInit:function(t,e,n){this.super(n),e||(e=t.replace("json","atlas"));var r=game._getFilePath(e);game.scale>1&&(r=r.replace(/\.(?=[^.]*$)/,"@"+game.scale+"x."));var a=game.spine.AtlasCache[r];if(!a)throw"Spine Atlas "+e+" not found";var i=game.getJSON(t);if(!i)throw"Spine JSON "+t+" not found";var o=new game.spine.AtlasAttachmentLoader(a),s=new game.spine.SkeletonJson(o);this.spineData=s.readSkeletonData(i),this.skeleton=new game.spine.Skeleton(this.spineData),this.skeleton.flipY=!0,this.skeleton.updateWorldTransform(),this.stateData=new game.spine.AnimationStateData(this.skeleton.data),this.state=new game.spine.AnimationState(this.stateData);for(var h=0,l=this.skeleton.slots.length;h<l;h++){var u=this.skeleton.slots[h],c=u.attachment,f=new game.Container;if(this._slotContainers.push(f),this.addChild(f),c instanceof game.spine.RegionAttachment){var p=this._createSprite(u,c);u.currentSprite=p,u.currentSpriteName=c.region.name,f.addChild(p)}else if(c instanceof game.spine.MeshAttachment&&game.webgl){var d=this._createMesh(u,c);u.currentMesh=d,u.currentMeshName=c.region.name,f.addChild(d)}}},createSkin:function(t,e){for(var r=new n.Skin(t),a=0;a<e.length;a++){var i=e[a],o=this.skeleton.data.findSkin(i);if(o){for(var s in o.attachments)if(s=parseInt(s)){var h=o.attachments[s],l=Object.keys(h)[0],u=o.attachments[s][l];if(s&&l)r.getAttachment(s,l)||r.addAttachment(s,l,u)}}else console.log("Skin not found: "+i)}this.skeleton.data.skins.push(r)},play:function(t,e,n,r,a){if(t){var i=n?"addAnimation":"setAnimation";this.state[i](a||0,t,!!e,r||0)}},setSkin:function(t){this.skeleton.setSkinByName(t)},updateTransform:function(){this.state.update(game.delta),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var t=this.skeleton.slots,e=0,n=t.length;e<n;e++){var r=t[e],a=r.attachment,i=this._slotContainers[e],o=r.bone;if(a){if(a instanceof game.spine.RegionAttachment){if(l=a.region){var s=l.name;if(!r.currentSpriteName||r.currentSpriteName!==s){if(r.currentSprite&&(r.currentSprite.visible=!1),r.sprites=r.sprites||{},void 0!==r.sprites[s])r.sprites[s].visible=!0;else{var h=this._createSprite(r,a);r.sprites[s]=h,i.addChild(h)}r.currentSprite=r.sprites[s],r.currentSpriteName=s}}i._localTransform.a=o.a,i._localTransform.b=o.b,i._localTransform.c=o.c,i._localTransform.d=o.d,i._localTransform.tx=o.worldX,i._localTransform.ty=o.worldY,i.updateTransform=this._slotUpdateTransform}else{if(!(a instanceof game.spine.MeshAttachment&&game.webgl)){i.visible=!1;continue}var l;if(l=a.region){var u=l.name;if(!r.currentMeshName||r.currentMeshName!==u){u=a.name;if(r.currentMesh&&(r.currentMesh.visible=!1),r.meshes=r.meshes||{},void 0!==r.meshes[u])r.meshes[u].visible=!0;else{var c=this._createMesh(r,a);i.addChild(c)}r.currentMesh=r.meshes[u],r.currentMeshName=u}}a.computeWorldVerticesOld(r,r.currentMesh.vertices)}i.visible=!0,i.alpha=r.color.a}else i.visible=!1}var f=this.skeleton.drawOrder;for(e=0,n=f.length;e<n;e++){i=this._slotContainers[f[e].data.index];this.children[e]=i}this.super()},_createMesh:function(t,e){var n=e.region;t.tempAttachment===e&&(n=t.tempRegion,t.tempAttachment=null,t.tempRegion=null);var r=n.texture,a=n.rotate?n.height:n.width,i=n.rotate?n.width:n.height,o=n.rotate?6:0,s=(r=new game.Texture(r._image,n.x/game.scale,n.y/game.scale,a/game.scale,i/game.scale,o),new Float32Array(e.regionUVs.length)),h=new Float32Array(e.regionUVs.length),l=new Uint16Array(e.triangles),u=new game.mesh.Mesh(r,s,h,l,game.mesh.Mesh.DRAW_MODES.TRIANGLES);return u.alpha=e.color.a,u.region=n,n._texture=r,r._updateUvs(),e.updateUVs(n,u.uvs),u.dirty++,t.meshes=t.meshes||{},t.meshes[e.name]=u,u},_createSprite:function(t,e){var n=e.region,r=n.texture,a=n.rotate?n.height:n.width,i=n.rotate?n.width:n.height,o=(r=new game.Texture(r._image,n.x/game.scale,n.y/game.scale,a/game.scale,i/game.scale),new game.Sprite(r));return o.rotation=e.rotation*game.spine.MathUtils.degRad,n.rotate&&(o.rotation-=Math.PI/2),o.anchorCenter(),o.position.x=e.x,o.position.y=e.y,n.size?(o.scale.x=n.size.width/n.originalWidth,o.scale.y=-n.size.height/n.originalHeight):(o.scale.x=e.scaleX*e.width/n.originalWidth,o.scale.y=-e.scaleY*e.height/n.originalHeight),o.scale.x*=game.scale,o.scale.y*=game.scale,o},_slotUpdateTransform:function(){if(!this.parent)return this._updateChildTransform();var t=this.parent._worldTransform,e=this._localTransform,n=this._worldTransform;n.a=e.a*t.a+e.b*t.c,n.b=e.a*t.b+e.b*t.d,n.c=e.c*t.a+e.d*t.c,n.d=e.c*t.b+e.d*t.d,n.tx=e.tx*t.a+e.ty*t.c+t.tx,n.ty=e.tx*t.b+e.ty*t.d+t.ty,this._worldAlpha=this.parent._worldAlpha*this.alpha,this._lastTransformUpdate=game.Timer.time,this._updateChildTransform()}})}});function LogGamma(Z){with(Math)var S=1+76.18009173/Z-86.50532033/(Z+1)+24.01409822/(Z+2)-1.231739516/(Z+3)+.00120858003/(Z+4)-536382e-11/(Z+5),LG=(Z-.5)*log(Z+4.5)-(Z+4.5)+log(2.50662827465*S);return LG}function Gcf(X,A){with(Math){for(var A0=0,B0=1,A1=1,B1=X,AOLD=0,N=0;abs((A1-AOLD)/A1)>1e-5;)AOLD=A1,N+=1,A0=A1+(N-A)*A0,B0=B1+(N-A)*B0,A1=X*A0+N*A1,B1=X*B0+N*B1,A0/=B1,B0/=B1,A1/=B1,B1=1;var Prob=exp(A*log(X)-X-LogGamma(A))*A1}return 1-Prob}function Gser(X,A){with(Math){for(var T9=1/A,G=T9,I=1;T9>1e-5*G;)T9=T9*X/(A+I),G+=T9,I+=1;G*=exp(A*log(X)-X-LogGamma(A))}return G}function Gammacdf(r,o){return r<=0?0:r<o+1?Gser(r,o):Gcf(r,o)}function Compute(r,o){return Z=r,Lam=o,Lam<=0?Poiscdf=0:Z<0?Poiscdf=0:(Z=Math.floor(Z),Poiscdf=1-Gammacdf(Lam,Z+1)),Poiscdf=Math.round(1e5*Poiscdf)/1e5,Poiscdf}function PRnd(r){for(var o=Math.random(),a=0,n=!1;!n;){var t=Compute(a,r);if(o<t)return v1=Compute(a+1,r),a;1-t<.01&&(n=!0),++a}return a}function PRndContinuos(r){var o=Math.random(),a=0;pred=0;for(var n=!1;!n;){var t=Compute(a,r),e=t-pred;if(o<t){var A=t-o;return a+(1-(A/=e))}1-t<.01&&(n=!0),pred=t,++a}return a}game.module("game.poisson").body(function(){});var FR_ALLOW_UNKNOW=!0,FR_PASSTROUGH=!1,FR_DEBUG=!1,FR_TIMEMALUS=30,FR_TIMEBONUS=3,FR_VALIDATION_TOKEN=[],FR_TIMESFALLEN=0,FR_TIMESSTARS=0,FR_SCORE=0,FR_PLAYERMAXSCORE=0,FR_TOPPLAYERSCORE=0,FR_PLAYERID="",FR_PLAYERNAME="",FR_SESSIONID="",FR_SPEED=500,FR_DIELEVEL=2e3;function CreateDefaultButton(e,t,a,n,s){var i=new game.ForgeButton(BUTTON_ACTIVE,BUTTON_PRESSED,BUTTON_DISABLED,e,t,a,{},n,COLOR_BLACK,COLOR_YELLOW,COLOR_DARKDARKGRAY,s);return SetDefaultButtonBehavior(i,100),i.addTo(game.scene.stage),i}function CreateDefault1Button(e,t,a,n,s){var i=new game.ForgeButton(BUTTON1_ACTIVE,BUTTON1_PRESSED,BUTTON1_DISABLED,e,t,a,{},n,COLOR_BLACK,COLOR_BLACK,COLOR_DARKDARKGRAY,s);return SetDefaultButtonBehavior(i,100),i.addTo(game.scene.stage),i}function SetDefaultButtonBehavior(e,t){e.scaleSpeed=500,e.scaleAmount=0,e.clickSound=SOUND_PRESSED,e.clickSound1=SOUND_RELEASED}function CreateText(e,t,a,n,s,i){i||(i={});var o=new game.Text(e,i),r=o.width/o.scale.x;o.anchor.set(r/2,0),o.mySize=s;var m=o.height/o.fontClass.lineHeight;return o.myFactorX=o.height/(m*s),o.height=m*s,o.width=o.width/o.myFactorX,o.x=t,o.y=a,o}function CreateText1(e,t,a,n,s,i){i||(i={});var o=new game.Text(e,i);o.width,o.scale.x;o.anchor.set(0,0),o.mySize=s;var r=o.height/o.fontClass.lineHeight;return o.myFactorX=o.height/(r*s),o.height=r*s,o.width=o.width/o.myFactorX,o.x=t,o.y=a,o}function SetColor(e,t){e.cache=!0,e._cachedSprite.tint=t,e._cachedSprite.tintAlpha=1}function AddForegroundUI(){if(FR_DEBUG){var e=CreateText("0",HALF_WIDTH+330,.9825*game.height,0,20,0);e.addTo(game.scene.stage),game.scene.fps=e}AddButtons()}function AddButtons(){var e="UI_Sound.png";game.mute&&(e="UI_SoundOFF.png"),game.scene.soundButton=new game.Button(e,.07*game.width,.95*game.height,function(){0==game.mute?(game.mute=!0,this.sprite.setTexture("UI_SoundOFF.png"),game.introMusic.volume=0,game.intro2Music.volume=0,game.mainMusic.volume=0,game.outroMusic.volume=0,null!=game.scoreSound&&(game.scoreSound.volume=0)):(game.introMusic.volume=MUSIC_VOLUME,game.intro2Music.volume=MUSIC_VOLUME,game.mainMusic.volume=MUSIC_VOLUME,game.outroMusic.volume=MUSIC_VOLUME,game.audio.playSound(SOUND_PRESSED),game.mute=!1,this.sprite.setTexture("UI_Sound.png"),null!=game.scoreSound&&(game.scoreSound.volume=1)),SaveMute()}),SetDefaultButtonBehavior(game.scene.soundButton,100),game.scene.soundButton.addTo(game.scene.stage)}function SaveMute(){try{localStorage.setItem("stores/mute",JSON.stringify(game.mute))}catch(e){}}function LoadMute(){try{var e=localStorage.getItem("stores/mute");if(null==e||""==e||"undefined"==e){game.mute=!1,SaveMute(game.mute)}else game.mute=JSON.parse(e)}catch(e){}}function GoToScene(e){game.currentScene=e,game.system.setScene(e)}function PlaySound(e,t,a){null==t&&(t=1),null==a&&(a=1),game.mute||(game.loadingSound=game.audio.playSound(e,t,a))}function IsWalkable(e){return!(e<16)&&(--e,7==(e%=16)||(6==e||(3==e||(1==e||0==e))))}function IsCloud(e){return--e,2==(e%=16)}function CommonUpdate(){game.scene.fps&&FR_DEBUG&&game.scene.fps.setText((1/game.delta).toFixed(1)),"Tutorial"==game.currentScene&&ServerUpdateStart(),"Main"==game.currentScene&&ServerUpdateEnd()}function GetLanguageName(){return GetLanguageFromIndex(GetLanguageIndex())}function GetLanguageIndex(){return game.locale.includes("it_")?2:1}function GetLanguageFromIndex(e){switch(e){case 1:return"ENG";case 2:return"ITA";default:return"ENG"}}function GetAnimationLanguageFromIndex(e){switch(e){case 1:return"_Eng";case 2:return"_Ita";default:return"_Eng"}}function GetLocalizedString(e){return game.localizedTexts[e][GetLanguageName()]}function GetLocalizedAnimation(e){return e+GetAnimationLanguageFromIndex(GetLanguageIndex())}function GetLocalizedPath(e,t){return t?(e="Text/"+GetLanguageFromIndex(t)+"/"+e,e+="_"+GetLanguageFromIndex(t)):(e="Text/"+GetLanguageName()+"/"+e,e+="_"+GetLanguageName())}function GetTimestamp(){return~~(Date.now()/1e3)}function StartGame(){SendStartGame()}function SendStartGame(){LOCAL_MODE||(game.startRequestNumber=0,DoStartRequest()),LOCAL_MODE&&(game.startReceived=!0),game.scene.button.setEnable(!1)}function SendEndGame(){LOCAL_MODE||(game.endRequestNumber=0,DoEndRequest()),LOCAL_MODE&&(console.log("SendEndGame"),game.endReceived=!0)}function ServerUpdateStart(){(1==game.startReceived&&(game.startSent=!1,game.startReceived=!1,game.startSendTimer=0,GoToScene("Main")),0!=game.startSendTimer&&game.startSent&&0==game.startReceived)&&(Date.now()-game.startSendTimer>1e4&&ErrorStartTimeout())}function ServerUpdateEnd(){(1==game.endReceived&&(console.log("received"),game.endSent=!1,game.endReceived=!1,game.endSendTimer=0,GoToScene("Outro")),0!=game.endSendTimer&&game.endSent&&0==game.endReceived)&&(Date.now()-game.endSendTimer>1e4&&ErrorEndTimeout())}function DoStartRequest(){game.startSent=!0,game.startRequestNumber++;var e=new XMLHttpRequest,t=ENDPOINT_PROD;PROD||(t=ENDPOINT_PRE),t+=ENDPOINT1,game.startSendTimer=Date.now();var a={};a.Timestamp=GetTimestamp(),a.PlayerId=FR_PLAYERID,e.open("POST",t,!0),e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.onreadystatechange=function(t){if(4==e.readyState)if(200==e.status){var a=JSON.parse(e.responseText);console.log(JSON.stringify(a)),game.startReceived=!0,a&&(a.PlayerMaxScore&&(FR_PLAYERMAXSCORE=a.PlayerMaxScore),FR_TOPPLAYERSCORE=a.TopPlayerScore,FR_SESSIONID=a.SessionID)}else 1==game.startRequestNumber?DoStartRequest():Handle2ErrorStart(e.status)},e.send(JSON.stringify(a))}function DoEndRequest(){game.endSent=!0,game.endRequestNumber++;var e=new XMLHttpRequest,t=ENDPOINT_PROD;PROD||(t=ENDPOINT_PRE),t+=ENDPOINT2,game.endSendTimer=Date.now();var a={};a.Timestamp=GetTimestamp(),a.PlayerId=FR_PLAYERID,a.Nickname=game.name,a.SessionID=FR_SESSIONID,a.Score=FR_SCORE,a.NumStars=FR_TIMESSTARS,a.NumFalls=FR_TIMESFALLEN,a.ValidationToken=FR_VALIDATION_TOKEN,a.PlayerSelectedID=game.selectIdx,a.PlayerSelectedName=game.gname,e.open("POST",t,!0),e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.onreadystatechange=function(t){if(4==e.readyState)if(200==e.status){var a=JSON.parse(e.responseText);console.log(JSON.stringify(a)),game.endReceived=!0}else 1==game.endRequestNumber?DoEndRequest():Handle2ErrorEnd(e.status)},e.send(JSON.stringify(a))}function Handle2ErrorStart(e){game.errorType=0,GoToScene("Error")}function Handle2ErrorEnd(e){game.errorType=1,GoToScene("Error")}function ErrorStartTimeout(){game.errorType=0,GoToScene("Error")}function ErrorEndTimeout(){game.errorType=1,GoToScene("Error")}function Alert(e,t){console.log(e),t()}function EmergencyRestart(){game.loadDone=!0,GoToScene("Preloading")}function Loader(e,t,a,n,s){if(0==game.loadDone)throw new Error("Loader invoked while is in working");game.loadingAssets=e,game.loadDone=!1,game.loadStart=Date.now(),e.forEach(function(e){var t=Contains(s,e);if(t>=0){var a=s[t].value;game.addAsset(e,a)}else game.addAsset(e)}),game.mainLoader=new game.Loader,game.mainLoaderonError=function(a){Alert(JSON.stringify(a),()=>{JSON.stringify(a);e.forEach(function(e){if(e.includes("atlas")){console.log("removing "+e),name=e.replace(".atlas","");var t=0,a=-1,n=Object.keys(game.spine.AtlasCache);for(t=0;t<n.length;++t)console.log(game.spine.AtlasCache[n[t]]),n[t].includes(name)&&(a=t);if(a>0)game.spine.AtlasCache[n[a]].pages.forEach(function(e){game.removeAsset(e.name)}),delete game.spine.AtlasCache[n[a]];game.removeAsset(e)}e.includes("json")&&(console.log("removing "+e),game.removeAsset(e))}),t(a)})},game.mainLoaderonProgress=function(){CommonOnProgress(this.percent),a(this.percent)},game.mainLoaderonComplete=function(){game.loadDone=!0,n()},game.mainLoader.onError=game.mainLoaderonError,game.mainLoader.onProgress=game.mainLoaderonProgress,game.mainLoader.onComplete=game.mainLoaderonComplete,game.mainLoader.start()}function PlayCinematic(e,t,a,n){game.cinematicIndex=0,game.cinematicSequenceIndex=0,game.cinematic=new game.Spine(INTRO_OUTRO_JSON),game.cinematicSequence=t;var s=GetLocalizedAnimation(t[game.cinematicIndex][game.cinematicSequenceIndex]);game.cinematic.position.x=a,game.cinematic.position.y=n;var i=!1;s.includes("Loop")&&(i=!0),game.cinematic.play(s,i),game.cinematic.state.addListener({complete:ProceedCinematic.bind(this),event:CinematicEvent.bind(this)}),game.cinematic.addTo(game.scene.stage)}function ProceedCinematic(){if(game.cinematicSequenceIndex+=1,game.cinematicSequenceIndex>=game.cinematicSequence[game.cinematicIndex].length);else{var e=GetLocalizedAnimation(game.cinematicSequence[game.cinematicIndex][game.cinematicSequenceIndex]),t=!1;e.includes("Loop")&&(t=!0),game.cinematic.play(e,t)}}function NextCinematic(){if(game.cinematicSequenceIndex=0,game.cinematicIndex+=1,game.cinematicIndex>=game.cinematicSequence.length);else{var e=GetLocalizedAnimation(game.cinematicSequence[game.cinematicIndex][game.cinematicSequenceIndex]),t=!1;e.includes("Loop")&&(t=!0),game.cinematic.play(e,t)}}function CinematicEvent(e,t){switch(t.data.name){case"TocToc":PlaySound(SOUND_TOCTOC);break;case"Balloon":PlaySound(SOUND_BALLOON);break;case"SantaComeIn":1==game.playingIntro1&&(game.introMusic.stop(),game.playingIntro1=!1),0==game.playingIntro2&&(PlaySound(SOUND_SANTA),game.intro2Music.play(),game.playingIntro2=!0);break;case"StartScore":game.playingScoreSound=!1,game.scoreSound=new game.Sound(SOUND_SCORE),game.scoreSound.loop=!0,game.mute||(game.playingScoreSound=!0,game.scoreSound.play()),game.scene.displayScore();break;case"VictoryFX":var a=new game.SpriteSheet(VFX7,192,160);this.vfx=new game.Animation(a.textures),this.vfx.addAnim("fx",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,0],{speed:17.5,loop:!1}),this.vfx.anchorCenter(),this.vfx.x=HALF_WIDTH,this.vfx.y=.5*game.height,this.vfx.addTo(game.scene.stage),this.vfx.play("fx");break;case"VictoryPlayer":game.scene.player.won=!0}}game.module("game.common").require("game.poisson","plugin.spine","plugin.essentials","plugin.tiled").body(function(){LEVEL_DESIGN="",LEVEL_DESIGN_SEQUENTIAL=!1,MUSIC_VOLUME=.2,LOCAL_MODE=!0,TestLevel=!1,MaxLevel=47,MaxLambda=35,LowLimit=800,Lambda=1,XSpeed=3,XScale=1,Fake3d=!1,layerFg="main",layerSx="sx",layerDx="dx",layerBg="bg",PointSize=8,COLOR_BLACK="#000000",COLOR_WHITE="#FFFFFF",COLOR_DARKGRAY="#686868",COLOR_DOVEGRAY="#AD986E",COLOR_GREEN="#285D4F",COLOR_DARKGREEN="#14322B",COLOR_LIGHTBLUE="#A4D2D5",BACKGROUND_COLOR="#14322B",COLOR_DARKDARKGRAY="#323232",COLOR_YELLOW="#fcc630",PORTRAIT="portrait",WINDOW_ERROR="Juv_Xmas_UI_window.png",BUTTON_ACTIVE="Juv_Xmas_UI_Button_Active.png",BUTTON_DISABLED="Juv_Xmas_UI_Button_Disabled.png",BUTTON_PRESSED="Juv_Xmas_UI_Button_Pressed.png",BUTTON1_ACTIVE="Juv_Xmas_UI_Forward_Active.png",BUTTON1_DISABLED="Juv_Xmas_UI_Forward_Disabled.png",BUTTON1_PRESSED="Juv_Xmas_UI_Forward_Pressed.png",TEXTBOX="Juv_Xmas_UI_Tutorial_TextBox.png",GREEK_UP="Juv_Xmas_UI_Selection_Greek_UP.png",GREEK_DOWN="Juv_Xmas_UI_Selection_Greek_DOWN.png",LOADING_STAR="Juv_Xmas_UI_Loading_Star.png",SOUND_PRESSED="click1.m4a",SOUND_RELEASED="click2.m4a",SOUND_SELECT="sfx_select.m4a",SOUND_TIME="stx_time_running.m4a",SOUND_STAR="sfx_collect_star.m4a",SOUND_PACK="sfx_collect_gift.m4a",MUSIC_MAIN="mus_main.m4a",MUSIC_INTRO="mus_intro.m4a",MUSIC_INTRO2="mus_santa_loop.m4a",MUSIC_OUTRO="mus_outro.m4a",SOUND_STEP1="sfx_step_terrain_01.m4a",SOUND_STEP2="sfx_step_terrain_02.m4a",SOUND_JUMP1="sfx_player_jump.m4a",SOUND_JUMP2="sfx_player_double_jump.m4a",SOUND_TOCTOC="sfx_knock_door.m4a",SOUND_BALLOON="sfx_balloon_in.m4a",SOUND_SCORE="sfx_points_up.m4a",SOUND_SANTA="sfx_santa_come_in.m4a",BORDER="border.png",TUTORIAL1="Juv_Xmas_UI_Tutorial_01Jump",TUTORIAL2="Juv_Xmas_UI_Tutorial_02Time",TUTORIAL3="Juv_Xmas_UI_Tutorial_03Presents",TUTORIAL1_ITA="Text/ITA/Juv_Xmas_UI_Tutorial_01Jump_ITA.png",TUTORIAL2_ITA="Text/ITA/Juv_Xmas_UI_Tutorial_02Time_ITA.png",TUTORIAL3_ITA="Text/ITA/Juv_Xmas_UI_Tutorial_03Presents_ITA.png",TUTORIAL1_ENG="Text/ENG/Juv_Xmas_UI_Tutorial_01Jump_ENG.png",TUTORIAL2_ENG="Text/ENG/Juv_Xmas_UI_Tutorial_02Time_ENG.png",TUTORIAL3_ENG="Text/ENG/Juv_Xmas_UI_Tutorial_03Presents_ENG.png",PROD=!1,ENDPOINT_PROD="https://xmas.juventus.com/",ENDPOINT_PRE="https://levelupyourxmas.staging.weareserver.it/",ENDPOINT1="api/startGame",ENDPOINT2="api/endGame",VFX="Vfx_Jump_4x.png",VFX2="Vfx_Run_4x.png",VFX3="Vfx_Gift_4x.png",VFX4="Vfx_Star_4x.png",VFX5="Vfx_DoubleJump.png",VFX6="Vfx_Numbers.png",VFX7="Vfx_Victory.png",INTRO_OUTRO_ATLAS="Animations.atlas",INTRO_OUTRO_JSON="Animations.json",INTRO_01=["Intro_01_Part1_Once","Intro_01_Part2_Loop"],INTRO_02=["Intro_02_Part1_Once","Intro_02_Part2_Once"],INTRO_03=["Intro_03_Part1_Once"],INTRO_04=["Intro_03_Part2_Once","Intro_03_Part3_Loop"],INTRO_05=["Intro_04_Once"],INTRO=[INTRO_01,INTRO_02,INTRO_03,INTRO_04],GAMEPLAY=[INTRO_05],OUTRO_01=["Ending_Part1_Once","Ending_Part2_Loop"],OUTRO_02=["Ending_Part3_Once","Ending_Part4_Loop"],OUTRO=[OUTRO_01,OUTRO_02],game.addAsset(MUSIC_MAIN),game.addAsset(MUSIC_INTRO),game.addAsset(MUSIC_INTRO2),game.addAsset(MUSIC_OUTRO),game.addAsset(VFX),game.addAsset(VFX2),game.addAsset(VFX3),game.addAsset(VFX4),game.addAsset(VFX5),game.addAsset(VFX6),game.addAsset(VFX7),game.addAsset("localization.json"),game.addAsset(LOADING_STAR),game.addAsset(TEXTBOX),game.addAsset(GREEK_UP),game.addAsset(GREEK_DOWN),game.addAsset(WINDOW_ERROR),game.addAsset(BUTTON_ACTIVE),game.addAsset(BUTTON_DISABLED),game.addAsset(BUTTON_PRESSED),game.addAsset(BUTTON1_ACTIVE),game.addAsset(BUTTON1_DISABLED),game.addAsset(BUTTON1_PRESSED),game.addAsset(SOUND_SELECT),game.addAsset(SOUND_TIME),game.addAsset(SOUND_PRESSED),game.addAsset(SOUND_RELEASED),game.addAsset(SOUND_STAR),game.addAsset(SOUND_PACK),game.addAsset(SOUND_STEP1),game.addAsset(SOUND_STEP2),game.addAsset(SOUND_JUMP1),game.addAsset(SOUND_JUMP2),game.addAsset(SOUND_TOCTOC),game.addAsset(SOUND_BALLOON),game.addAsset(SOUND_SCORE),game.addAsset(SOUND_SANTA),game.addAsset(BORDER),game.addAsset("L1_House_01.png"),game.addAsset("L1_House_02.png"),game.addAsset("L1_House_03.png"),game.addAsset("L1_House_04.png"),game.addAsset("L1_Reindeer.png"),game.addAsset("L1_Snowman_01.png"),game.addAsset("L1_Snowman_02.png"),game.addAsset("L1_Snow_01.png"),game.addAsset("L1_Snow_02.png"),game.addAsset("L1_Snow_03.png"),game.addAsset("L1_Snow_04.png"),game.addAsset("L1_Tree_01.png"),game.addAsset("L1_Tree_02.png"),game.addAsset("L1_Tree_03.png"),game.addAsset("L2_House_01.png"),game.addAsset("L2_House_02.png"),game.addAsset("L2_House_03.png"),game.addAsset("L2_House_04.png"),game.addAsset("L2_tree_02.png"),game.addAsset("Stadium.png"),game.addAsset("Stadium_quinta.png"),game.addAsset("UI_Sound.png"),game.addAsset("UI_SoundOFF.png"),game.addAsset("layer_04.png"),game.addAsset("layer_05.png"),game.addAsset("layer_06.png"),game.addAsset("layer_08.png"),game.addAsset(TUTORIAL1_ITA),game.addAsset(TUTORIAL2_ITA),game.addAsset(TUTORIAL3_ITA),game.addAsset(TUTORIAL1_ENG),game.addAsset(TUTORIAL2_ENG),game.addAsset(TUTORIAL3_ENG),game.addAsset("minecraft.fnt"),game.addAsset("level.json");var e=0;for(e=0;e<MaxLevel+1;++e)game.addAsset("level"+e+".json");MaxPlayer=25;e=0;for(e=1;e<MaxPlayer;++e)game.addAsset("player"+e+".png");game.addAsset("portrait0.png"),game.addAsset("portrait0b.png");e=0;for(e=1;e<MaxPlayer;++e)game.addAsset("portrait"+e+".png");game.addAsset("tileset.png"),game.addAsset("t1.png"),game.addAsset("block.png"),game.addAsset("portraitBg2.png"),game.addAsset("portraitBg1.png"),game.addAsset("portraitFg.png"),game.addAsset("portraitBg.png"),game.addAsset("portraitLock.png"),game.addAsset(INTRO_OUTRO_ATLAS),game.addAsset(INTRO_OUTRO_JSON),game.createClass("ForgeButton","Button",{staticInit:function(e,t,a,n,s,i,o,r,m,d,g,_){this.super(t,n,s,_),this.myEnabled=!0,this.callback=_,this.sprite2=new game.Sprite(e),this.sprite2.anchorCenter(),this.sprite2.alpha=1,this.sprite2.buttonMode=!0,this.sprite2.position.x=n,this.sprite2.position.y=s,this.sprite2.interactive=!0,this.sprite2.mousedown=this.mousedown.bind(this),this.sprite2.mouseup=this.mouseup.bind(this),this.sprite2.mouseupoutside=this.mouseup.bind(this),this.sprite3=new game.Sprite(a),this.sprite3.anchorCenter(),this.sprite3.alpha=0,this.sprite3.position.x=n,this.sprite3.position.y=s;var c=i.search("\n"),u="";c>0&&(u=i.substring(c+1,i.length),i=i.substring(0,c));c>0?(this.innerCreateText(i,this.sprite,r,d,-.02*game.height),this.innerCreateText(u,this.sprite,r,d,.02*game.height),this.innerCreateText(i,this.sprite2,r,m,-3-.02*game.height),this.innerCreateText(u,this.sprite2,r,m,.02*game.height-3),this.innerCreateText(i,this.sprite3,r,g,-.02*game.height),this.innerCreateText(u,this.sprite3,r,g,.02*game.height)):(this.innerCreateText(i,this.sprite,r,d,0),this.innerCreateText(i,this.sprite2,r,m,-3),this.innerCreateText(i,this.sprite3,r,g,-2)),this.sprite2.click=this.click.bind(this)},innerCreateText:function(e,t,a,n,s){t.width;var i=CreateText(e,0,0,10,a);SetColor(i,n);var o=i.height/i.fontClass.lineHeight;i.y=+s+1/o*(-i.height*i.scale.y/2),i.addTo(t)},setEnable:function(e){this.sprite3.alpha=e?0:1,this.myEnabled=e,this.sprite.interactive=e,this.sprite2.interactive=e},addTo:function(e){this.super(e),e.addChild(this.sprite2),e.addChild(this.sprite3)},scaleIn:function(e){e=e||0,this.sprite2.scale.set(0),game.Tween.add(this.sprite2.scale,{x:1,y:1},this.scaleSpeed,{easing:this.scaleEasing,delay:e,onStart:this._onScaleInStart.bind(this),onComplete:this._scaleInEnd.bind(this)}).start()},rotate:function(e){this.super(e),this.sprite2.rotation=-this.rotateAmount,this.rotateTween=game.Tween.add(this.sprite2,{rotation:this.rotateAmount},this.rotateSpeed,{repeat:1/0,yoyo:!0,easing:this.rotateEasing}).start(),e&&(this.rotateTween.currentTime=this.rotateTween.duration.random())},setPosition:function(e,t){this.sprite.position.x=e,this.sprite.position.y=t,this.sprite2.position.x=e,this.sprite2.position.y=t,this.sprite3.position.x=e,this.sprite3.position.y=t},setScale:function(e,t){this.sprite.scale.x=e,this.sprite.scale.y=t,this.sprite2.scale.x=e,this.sprite2.scale.y=t,this.sprite3.scale.x=e,this.sprite3.scale.y=t},mousedown:function(){this.myEnabled&&(this.clickSound&&PlaySound(this.clickSound),this.sprite2.alpha=.01,this.sprite.alpha=1,this.sprite.mousedown())},mouseup:function(){this.myEnabled&&(this.clickSound1&&PlaySound(this.clickSound1),this.sprite2.alpha=1,this.sprite.alpha=.01,this.sprite.mouseup())},activate:function(){this.myEnabled&&(this.sprite2.alpha=0,this.sprite.alpha=1)},deactivate:function(){this.myEnabled&&(this.sprite2.alpha=1,this.sprite.alpha=0)},click:function(){this.myEnabled&&"function"==typeof this.callback&&this.callback()}})});